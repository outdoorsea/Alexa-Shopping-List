‚îú‚îÄ‚îÄ .devcontainer.json
‚îú‚îÄ‚îÄ .eslintrc.json
‚îú‚îÄ‚îÄ .gitignore
‚îú‚îÄ‚îÄ .vscode
    ‚îú‚îÄ‚îÄ settings.json
    ‚îî‚îÄ‚îÄ tasks.json
‚îú‚îÄ‚îÄ .windsurfrules
‚îú‚îÄ‚îÄ __mocks__
    ‚îú‚îÄ‚îÄ fileMock.js
    ‚îî‚îÄ‚îÄ styleMock.js
‚îú‚îÄ‚îÄ babel.config.ts
‚îú‚îÄ‚îÄ build.ts
‚îú‚îÄ‚îÄ coverage
    ‚îú‚îÄ‚îÄ clover.xml
    ‚îú‚îÄ‚îÄ coverage-final.json
    ‚îú‚îÄ‚îÄ lcov-report
    ‚îÇ   ‚îú‚îÄ‚îÄ base.css
    ‚îÇ   ‚îú‚îÄ‚îÄ block-navigation.js
    ‚îÇ   ‚îú‚îÄ‚îÄ favicon.png
    ‚îÇ   ‚îú‚îÄ‚îÄ feedback.ts.html
    ‚îÇ   ‚îú‚îÄ‚îÄ index.html
    ‚îÇ   ‚îú‚îÄ‚îÄ prettify.css
    ‚îÇ   ‚îú‚îÄ‚îÄ prettify.js
    ‚îÇ   ‚îú‚îÄ‚îÄ sanitizer.ts.html
    ‚îÇ   ‚îú‚îÄ‚îÄ sort-arrow-sprite.png
    ‚îÇ   ‚îî‚îÄ‚îÄ sorter.js
    ‚îî‚îÄ‚îÄ lcov.info
‚îú‚îÄ‚îÄ documentation
    ‚îú‚îÄ‚îÄ PRD.md
    ‚îú‚îÄ‚îÄ README.md
    ‚îú‚îÄ‚îÄ ROADMAP.md
    ‚îú‚îÄ‚îÄ SRS.md
    ‚îî‚îÄ‚îÄ TECHNICAL-DETAILS.md
‚îú‚îÄ‚îÄ global.d.ts
‚îú‚îÄ‚îÄ jest.config.ts
‚îú‚îÄ‚îÄ jest.setup.ts
‚îú‚îÄ‚îÄ output.txt
‚îú‚îÄ‚îÄ package-lock.json
‚îú‚îÄ‚îÄ package.json
‚îú‚îÄ‚îÄ postcss.config.ts
‚îú‚îÄ‚îÄ prettier.config.ts
‚îú‚îÄ‚îÄ scripts
    ‚îú‚îÄ‚îÄ generate-icons.ts
    ‚îú‚îÄ‚îÄ generate-tree.js
    ‚îî‚îÄ‚îÄ generate-tree.ts
‚îú‚îÄ‚îÄ src
    ‚îú‚îÄ‚îÄ __tests__
    ‚îÇ   ‚îî‚îÄ‚îÄ popup.test.tsx
    ‚îú‚îÄ‚îÄ manifest.json
    ‚îú‚îÄ‚îÄ options.html
    ‚îú‚îÄ‚îÄ options.tsx
    ‚îú‚îÄ‚îÄ popup.html
    ‚îú‚îÄ‚îÄ popup.tsx
    ‚îú‚îÄ‚îÄ public
    ‚îÇ   ‚îî‚îÄ‚îÄ images
    ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ icon-128.png
    ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ icon-16.png
    ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ icon-32.png
    ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ icon-48.png
    ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ icon.svg
    ‚îú‚îÄ‚îÄ styles
    ‚îÇ   ‚îú‚îÄ‚îÄ global.css
    ‚îÇ   ‚îú‚îÄ‚îÄ options.css
    ‚îÇ   ‚îî‚îÄ‚îÄ output.css
    ‚îú‚îÄ‚îÄ types
    ‚îÇ   ‚îú‚îÄ‚îÄ global.d.ts
    ‚îÇ   ‚îî‚îÄ‚îÄ index.ts
    ‚îî‚îÄ‚îÄ utils
    ‚îÇ   ‚îú‚îÄ‚îÄ feedback.ts
    ‚îÇ   ‚îú‚îÄ‚îÄ index.ts
    ‚îÇ   ‚îî‚îÄ‚îÄ sanitizer.ts
‚îú‚îÄ‚îÄ tailwind.config.ts
‚îú‚îÄ‚îÄ tsconfig.build.json
‚îú‚îÄ‚îÄ tsconfig.json
‚îú‚îÄ‚îÄ tsconfig.test.json
‚îî‚îÄ‚îÄ webpack
    ‚îú‚îÄ‚îÄ webpack.common.ts
    ‚îú‚îÄ‚îÄ webpack.dev.ts
    ‚îî‚îÄ‚îÄ webpack.prod.ts


/.devcontainer.json:
--------------------------------------------------------------------------------
1 | {"image":"mcr.microsoft.com/devcontainers/javascript-node"}


--------------------------------------------------------------------------------
/.eslintrc.json:
--------------------------------------------------------------------------------
 1 | {
 2 |   "env": {
 3 |     "browser": true,
 4 |     "es2021": true,
 5 |     "node": true,
 6 |     "jest": true
 7 |   },
 8 |   "extends": [
 9 |     "eslint:recommended",
10 |     "plugin:react/recommended",
11 |     "plugin:@typescript-eslint/recommended",
12 |     "plugin:react-hooks/recommended",
13 |     "prettier"
14 |   ],
15 |   "parser": "@typescript-eslint/parser",
16 |   "parserOptions": {
17 |     "ecmaFeatures": {
18 |       "jsx": true
19 |     },
20 |     "ecmaVersion": "latest",
21 |     "sourceType": "module"
22 |   },
23 |   "plugins": [
24 |     "react",
25 |     "@typescript-eslint",
26 |     "react-hooks"
27 |   ],
28 |   "settings": {
29 |     "react": {
30 |       "version": "detect"
31 |     }
32 |   },
33 |   "rules": {
34 |     "react/react-in-jsx-scope": "off",
35 |     "@typescript-eslint/no-explicit-any": "warn",
36 |     "@typescript-eslint/explicit-module-boundary-types": "off",
37 |     "@typescript-eslint/no-unused-vars": ["warn", {
38 |       "argsIgnorePattern": "^_",
39 |       "varsIgnorePattern": "^_"
40 |     }],
41 |     "no-console": ["warn", { "allow": ["warn", "error"] }],
42 |     "react-hooks/rules-of-hooks": "error",
43 |     "react-hooks/exhaustive-deps": "warn"
44 |   }
45 | }
46 | 


--------------------------------------------------------------------------------
/.gitignore:
--------------------------------------------------------------------------------
1 | npm-debug.log
2 | node_modules/
3 | dist/
4 | tmp/
5 | .git/
6 | package-lock.json
7 | 


--------------------------------------------------------------------------------
/.vscode/settings.json:
--------------------------------------------------------------------------------
 1 | {
 2 |     "typescript.tsdk": "./node_modules/typescript/lib",
 3 |     "files.eol": "\n",
 4 |     "json.schemas": [
 5 |         {
 6 |             "fileMatch": [
 7 |                 "/manifest.json"
 8 |             ],
 9 |             "url": "http://json.schemastore.org/chrome-manifest"
10 |         }
11 |     ]
12 | }


--------------------------------------------------------------------------------
/.vscode/tasks.json:
--------------------------------------------------------------------------------
 1 | {
 2 |     // See https://go.microsoft.com/fwlink/?LinkId=733558
 3 |     // for the documentation about the tasks.json format
 4 |     "version": "2.0.0",
 5 |     "command": "npm",
 6 |     "tasks": [
 7 |         {
 8 |             "label": "install",
 9 |             "type": "shell",
10 |             "command": "npm",
11 |             "args": ["install"]
12 |         },
13 |         {
14 |             "label": "update",
15 |             "type": "shell",
16 |             "command": "npm",
17 |             "args": ["update"]
18 |         },
19 |         {
20 |             "label": "test",
21 |             "type": "shell",
22 |             "command": "npm",
23 |             "args": ["run", "test"]
24 |         },
25 |         {
26 |             "label": "build",
27 |             "type": "shell",
28 |             "group": "build",
29 |             "command": "npm",
30 |             "args": ["run", "watch"]
31 |         }
32 |     ]
33 | }


--------------------------------------------------------------------------------
/.windsurfrules:
--------------------------------------------------------------------------------
 1 | - Maintain the Manifest V3 structure and Chrome API integrations.
 2 | - Implement a strict Content Security Policy (CSP) as defined in the manifest.
 3 | - Sanitize all DOM interactions to prevent security vulnerabilities.
 4 | - Request only the minimal permissions necessary for functionality.
 5 | - Protect user privacy by disclosing data collection practices and obtaining user consent.
 6 | - Store sensitive data using `chrome.storage.sync`.
 7 | - Employ Webpack as the build system; avoid other bundlers.
 8 | - Utilize Jest with jsdom for testing.
 9 | - Ensure all new features have corresponding Jest test cases.
10 | - Keep `popup.js` under 500 lines of code.
11 | - Limit popup launch time to under 500ms.
12 | - Ensure First Contentful Paint (FCP) is under 1 second.
13 | - Limit to a maximum of 5 concurrent API calls.
14 | - Debounce API calls during rapid interactions.
15 | - Virtualize long lists to enhance performance.
16 | - Keep the options page size under 100KB.
17 | - Modularize common utilities to avoid code duplication.
18 | - Implement robust error handling in all asynchronous operations.
19 | - Validate all stored values before use.
20 | - Use JavaScript and TypeScript for all extension development.
21 | - Use Immediately Invoked Function Expressions (IIFE) for extension scripts.
22 | - Avoid inline event handlers in HTML.
23 | - Apply ESLint with Chrome extension rules.
24 | - Use Prettier for code formatting.
25 | - Do not modify Webpack entry points.
26 | - Propose Chrome API alternatives before using non-standard APIs.
27 | - Exclude unnecessary files from deployment artifacts (see `.gitignore`).
28 | - Follow accessibility best practices (e.g., ARIA roles, keyboard navigation).
29 | - Provide a clear and concise description in the Chrome Web Store listing.
30 | - Ensure all icons are square and meet size requirements.
31 | - Write descriptive commit messages.
32 | - Document all code changes in the relevant files (e.g., `/workspaces/llama-vision/documentation/README.md`).
33 | - Refactor code in small, well-documented increments.
34 | - Regularly review and comply with Chrome Web Store program policies.
35 | - If unsure, refer to the Chrome Web Store Best Practices - https://developer.chrome.com/docs/webstore/best-practices
36 | 


--------------------------------------------------------------------------------
/__mocks__/fileMock.js:
--------------------------------------------------------------------------------
1 | module.exports = 'test-file-stub';
2 | 


--------------------------------------------------------------------------------
/__mocks__/styleMock.js:
--------------------------------------------------------------------------------
1 | module.exports = {};
2 | 


--------------------------------------------------------------------------------
/babel.config.ts:
--------------------------------------------------------------------------------
 1 | // babel.config.ts
 2 | import type { TransformOptions } from '@babel/core';
 3 | 
 4 | const config: TransformOptions = {
 5 |   presets: [
 6 |     ['@babel/preset-env', { targets: { node: 'current' } }],
 7 |     '@babel/preset-typescript'
 8 |   ]
 9 | };
10 | 
11 | export default config;
12 | 


--------------------------------------------------------------------------------
/build.ts:
--------------------------------------------------------------------------------
  1 | // build.ts
  2 | import fs from 'fs-extra';
  3 | import path from 'path';
  4 | import { fileURLToPath } from 'url';
  5 | import webpack from 'webpack';
  6 | import { exec } from 'child_process';
  7 | import { promisify } from 'util';
  8 | 
  9 | const execAsync = promisify(exec);
 10 | const __filename = fileURLToPath(import.meta.url);
 11 | const __dirname = path.dirname(__filename);
 12 | const BUILD_DIR = path.join(__dirname, 'dist');
 13 | 
 14 | // ANSI color codes for terminal output
 15 | const colors = {
 16 |   red: (text: string) => `\x1b[31m${text}\x1b[0m`,
 17 |   green: (text: string) => `\x1b[32m${text}\x1b[0m`,
 18 |   yellow: (text: string) => `\x1b[33m${text}\x1b[0m`,
 19 |   blue: (text: string) => `\x1b[34m${text}\x1b[0m`,
 20 |   gray: (text: string) => `\x1b[90m${text}\x1b[0m`
 21 | };
 22 | 
 23 | interface BuildStep {
 24 |   name: string;
 25 |   emoji: string;
 26 |   action: () => Promise<void>;
 27 | }
 28 | 
 29 | interface BuildSummary {
 30 |   step: string;
 31 |   status: 'success' | 'error' | 'skipped';
 32 |   duration: number;
 33 |   error?: Error;
 34 | }
 35 | 
 36 | async function clean(): Promise<void> {
 37 |   try {
 38 |     await fs.remove(BUILD_DIR);
 39 |     await fs.ensureDir(BUILD_DIR);
 40 |   } catch (error) {
 41 |     throw new Error(`Failed to clean build directory: ${error}`);
 42 |   }
 43 | }
 44 | 
 45 | async function format(): Promise<void> {
 46 |   try {
 47 |     await execAsync('prettier --write "src/**/*.{ts,tsx}"');
 48 |   } catch (error) {
 49 |     throw new Error(`Failed to format code: ${error}`);
 50 |   }
 51 | }
 52 | 
 53 | async function lint(): Promise<void> {
 54 |   try {
 55 |     await execAsync('eslint "src/**/*.{ts,tsx}" --fix');
 56 |   } catch (error) {
 57 |     throw new Error(`Failed to lint code: ${error}`);
 58 |   }
 59 | }
 60 | 
 61 | async function typeCheck(): Promise<void> {
 62 |   try {
 63 |     await execAsync('tsc --noEmit');
 64 |   } catch (error) {
 65 |     throw new Error(`Type check failed: ${error}`);
 66 |   }
 67 | }
 68 | 
 69 | async function test(): Promise<void> {
 70 |   try {
 71 |     await execAsync('jest --config jest.config.ts --silent');
 72 |   } catch (error) {
 73 |     throw new Error(`Tests failed: ${error}`);
 74 |   }
 75 | }
 76 | 
 77 | async function generateTree(): Promise<void> {
 78 |   try {
 79 |     await execAsync('node --loader ts-node/esm scripts/generate-tree.ts');
 80 |   } catch (error) {
 81 |     throw new Error(`Failed to generate tree: ${error}`);
 82 |   }
 83 | }
 84 | 
 85 | async function compileTypeScript(): Promise<void> {
 86 |   try {
 87 |     await execAsync('tsc -p tsconfig.build.json');
 88 |   } catch (error) {
 89 |     throw new Error(`TypeScript compilation failed: ${error}`);
 90 |   }
 91 | }
 92 | 
 93 | async function buildWithWebpack(mode: 'development' | 'production', watch = false): Promise<void> {
 94 |   try {
 95 |     const configModule = mode === 'production'
 96 |       ? await import('./webpack/webpack.prod.ts')
 97 |       : await import('./webpack/webpack.dev.ts');
 98 |     
 99 |     const config = configModule.default;
100 | 
101 |     await new Promise<void>((resolve, reject) => {
102 |       const compiler = webpack(config);
103 |       const callback = (err: Error | null | undefined, stats: webpack.Stats | undefined) => {
104 |         if (err) {
105 |           reject(new Error(`Webpack compilation error: ${err.message}`));
106 |           return;
107 |         }
108 | 
109 |         if (stats?.hasErrors()) {
110 |           const info = stats.toJson();
111 |           const errors = info.errors?.map(e => e.message || 'Unknown error') || ['Unknown webpack error'];
112 |           reject(new Error(`Webpack compilation failed:\n${errors.join('\n')}`));
113 |           return;
114 |         }
115 | 
116 |         console.log(stats?.toString({
117 |           colors: true,
118 |           chunks: false,
119 |           modules: false,
120 |         }));
121 | 
122 |         if (!watch) resolve();
123 |       };
124 | 
125 |       if (watch) {
126 |         compiler.watch({}, callback);
127 |       } else {
128 |         compiler.run((err, stats) => {
129 |           callback(err, stats);
130 |           compiler.close(err => {
131 |             if (err) console.error(colors.red('Failed to close compiler:'), err);
132 |           });
133 |         });
134 |       }
135 |     });
136 |   } catch (error) {
137 |     throw new Error(`Failed to build with webpack: ${error}`);
138 |   }
139 | }
140 | 
141 | async function runBuildStep(step: BuildStep): Promise<BuildSummary> {
142 |   console.log(`${step.emoji} ${colors.blue(step.name)}`);
143 |   const startTime = Date.now();
144 |   try {
145 |     await step.action();
146 |     const duration = Date.now() - startTime;
147 |     return {
148 |       step: step.name,
149 |       status: 'success',
150 |       duration
151 |     };
152 |   } catch (error) {
153 |     const duration = Date.now() - startTime;
154 |     return {
155 |       step: step.name,
156 |       status: 'error',
157 |       duration,
158 |       error: error as Error
159 |     };
160 |   }
161 | }
162 | 
163 | function printSummary(summaries: BuildSummary[]): void {
164 |   console.log('\nBuild Summary:');
165 |   const totalTime = summaries.reduce((acc, curr) => acc + curr.duration, 0);
166 |   
167 |   summaries.forEach(summary => {
168 |     const icon = summary.status === 'success' ? '‚úÖ' : summary.status === 'error' ? '‚ùå' : '‚ö†Ô∏è';
169 |     const duration = (summary.duration / 1000).toFixed(2);
170 |     const status = summary.status === 'success'
171 |       ? colors.green(summary.status)
172 |       : colors.red(summary.status);
173 |     
174 |     console.log(`${icon} ${summary.step}: ${status} (${duration}s)`);
175 |     if (summary.error) {
176 |       console.error(`   ${colors.red(summary.error.message)}`);
177 |     }
178 |   });
179 |   
180 |   console.log(`\nTotal time: ${(totalTime / 1000).toFixed(2)}s`);
181 | }
182 | 
183 | async function main(): Promise<void> {
184 |   const args = process.argv.slice(2);
185 |   const isDev = args.includes('dev');
186 |   const shouldWatch = args.includes('watch');
187 |   const shouldClean = !args.includes('no-clean');
188 |   
189 |   const steps: BuildStep[] = [
190 |     {
191 |       name: 'Clean',
192 |       emoji: 'üßπ',
193 |       action: clean
194 |     },
195 |     {
196 |       name: 'Generate Tree',
197 |       emoji: 'üå≥',
198 |       action: generateTree
199 |     },
200 |     {
201 |       name: 'Format',
202 |       emoji: '‚ú®',
203 |       action: format
204 |     },
205 |     {
206 |       name: 'Lint',
207 |       emoji: 'üîç',
208 |       action: lint
209 |     },
210 |     {
211 |       name: 'Type Check',
212 |       emoji: 'üìù',
213 |       action: typeCheck
214 |     },
215 |     {
216 |       name: 'Test',
217 |       emoji: 'üß™',
218 |       action: test
219 |     },
220 |     {
221 |       name: 'Build',
222 |       emoji: 'üèóÔ∏è',
223 |       action: () => buildWithWebpack(isDev ? 'development' : 'production', shouldWatch)
224 |     }
225 |   ];
226 | 
227 |   const summaries: BuildSummary[] = [];
228 |   let hasError = false;
229 | 
230 |   for (const step of steps) {
231 |     // Skip clean step if not needed
232 |     if (step.name === 'Clean' && !shouldClean) {
233 |       summaries.push({ step: step.name, status: 'skipped', duration: 0 });
234 |       continue;
235 |     }
236 | 
237 |     const summary = await runBuildStep(step);
238 |     summaries.push(summary);
239 | 
240 |     if (summary.status === 'error') {
241 |       hasError = true;
242 |       break;
243 |     }
244 |   }
245 | 
246 |   printSummary(summaries);
247 | 
248 |   if (hasError) {
249 |     process.exit(1);
250 |   }
251 | }
252 | 
253 | main().catch(error => {
254 |   console.error(colors.red('\nBuild failed:'), error);
255 |   process.exit(1);
256 | });
257 | 


--------------------------------------------------------------------------------
/coverage/clover.xml:
--------------------------------------------------------------------------------
 1 | <?xml version="1.0" encoding="UTF-8"?>
 2 | <coverage generated="1738558257333" clover="3.2.0">
 3 |   <project timestamp="1738558257333" name="All files">
 4 |     <metrics statements="31" coveredstatements="0" conditionals="8" coveredconditionals="0" methods="5" coveredmethods="0" elements="44" coveredelements="0" complexity="0" loc="31" ncloc="31" packages="1" files="2" classes="2"/>
 5 |     <file name="feedback.ts" path="/workspaces/list-bridge/src/utils/feedback.ts">
 6 |       <metrics statements="27" coveredstatements="0" conditionals="8" coveredconditionals="0" methods="4" coveredmethods="0"/>
 7 |       <line num="2" count="0" type="stmt"/>
 8 |       <line num="7" count="0" type="stmt"/>
 9 |       <line num="8" count="0" type="stmt"/>
10 |       <line num="9" count="0" type="stmt"/>
11 |       <line num="10" count="0" type="stmt"/>
12 |       <line num="11" count="0" type="cond" truecount="0" falsecount="2"/>
13 |       <line num="12" count="0" type="stmt"/>
14 |       <line num="14" count="0" type="stmt"/>
15 |       <line num="18" count="0" type="cond" truecount="0" falsecount="2"/>
16 |       <line num="19" count="0" type="cond" truecount="0" falsecount="2"/>
17 |       <line num="20" count="0" type="stmt"/>
18 |       <line num="21" count="0" type="stmt"/>
19 |       <line num="22" count="0" type="stmt"/>
20 |       <line num="23" count="0" type="stmt"/>
21 |       <line num="24" count="0" type="stmt"/>
22 |       <line num="25" count="0" type="stmt"/>
23 |       <line num="26" count="0" type="cond" truecount="0" falsecount="1"/>
24 |       <line num="27" count="0" type="stmt"/>
25 |       <line num="28" count="0" type="stmt"/>
26 |       <line num="29" count="0" type="stmt"/>
27 |       <line num="32" count="0" type="stmt"/>
28 |       <line num="33" count="0" type="stmt"/>
29 |       <line num="36" count="0" type="stmt"/>
30 |       <line num="37" count="0" type="stmt"/>
31 |       <line num="40" count="0" type="stmt"/>
32 |       <line num="41" count="0" type="stmt"/>
33 |       <line num="42" count="0" type="stmt"/>
34 |     </file>
35 |     <file name="sanitizer.ts" path="/workspaces/list-bridge/src/utils/sanitizer.ts">
36 |       <metrics statements="4" coveredstatements="0" conditionals="0" coveredconditionals="0" methods="1" coveredmethods="0"/>
37 |       <line num="8" count="0" type="stmt"/>
38 |       <line num="9" count="0" type="stmt"/>
39 |       <line num="10" count="0" type="stmt"/>
40 |       <line num="11" count="0" type="stmt"/>
41 |     </file>
42 |   </project>
43 | </coverage>
44 | 


--------------------------------------------------------------------------------
/coverage/coverage-final.json:
--------------------------------------------------------------------------------
1 | {"/workspaces/list-bridge/src/utils/feedback.ts": {"path":"/workspaces/list-bridge/src/utils/feedback.ts","statementMap":{"0":{"start":{"line":2,"column":28},"end":{"line":44,"column":1}},"1":{"start":{"line":7,"column":19},"end":{"line":7,"column":48}},"2":{"start":{"line":8,"column":2},"end":{"line":8,"column":34}},"3":{"start":{"line":9,"column":2},"end":{"line":9,"column":33}},"4":{"start":{"line":10,"column":20},"end":{"line":10,"column":65}},"5":{"start":{"line":11,"column":2},"end":{"line":15,"column":3}},"6":{"start":{"line":12,"column":4},"end":{"line":12,"column":36}},"7":{"start":{"line":14,"column":4},"end":{"line":14,"column":40}},"8":{"start":{"line":18,"column":2},"end":{"line":34,"column":3}},"9":{"start":{"line":19,"column":4},"end":{"line":30,"column":5}},"10":{"start":{"line":20,"column":21},"end":{"line":20,"column":23}},"11":{"start":{"line":21,"column":22},"end":{"line":21,"column":24}},"12":{"start":{"line":22,"column":17},"end":{"line":22,"column":89}},"13":{"start":{"line":23,"column":16},"end":{"line":23,"column":98}},"14":{"start":{"line":24,"column":6},"end":{"line":24,"column":40}},"15":{"start":{"line":25,"column":6},"end":{"line":25,"column":38}},"16":{"start":{"line":26,"column":11},"end":{"line":30,"column":5}},"17":{"start":{"line":27,"column":19},"end":{"line":27,"column":49}},"18":{"start":{"line":28,"column":6},"end":{"line":28,"column":62}},"19":{"start":{"line":29,"column":6},"end":{"line":29,"column":48}},"20":{"start":{"line":32,"column":4},"end":{"line":32,"column":32}},"21":{"start":{"line":33,"column":4},"end":{"line":33,"column":31}},"22":{"start":{"line":36,"column":2},"end":{"line":38,"column":5}},"23":{"start":{"line":37,"column":4},"end":{"line":37,"column":35}},"24":{"start":{"line":40,"column":2},"end":{"line":43,"column":15}},"25":{"start":{"line":41,"column":4},"end":{"line":41,"column":38}},"26":{"start":{"line":42,"column":4},"end":{"line":42,"column":45}},"27":{"start":{"line":42,"column":21},"end":{"line":42,"column":38}},"28":{"start":{"line":2,"column":13},"end":{"line":2,"column":28}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":28},"end":{"line":2,"column":null}},"loc":{"start":{"line":6,"column":10},"end":{"line":44,"column":1}}},"1":{"name":"(anonymous_1)","decl":{"start":{"line":36,"column":24},"end":{"line":36,"column":27}},"loc":{"start":{"line":36,"column":29},"end":{"line":38,"column":3}}},"2":{"name":"(anonymous_2)","decl":{"start":{"line":40,"column":13},"end":{"line":40,"column":16}},"loc":{"start":{"line":40,"column":18},"end":{"line":43,"column":3}}},"3":{"name":"(anonymous_3)","decl":{"start":{"line":42,"column":15},"end":{"line":42,"column":18}},"loc":{"start":{"line":42,"column":21},"end":{"line":42,"column":38}}}},"branchMap":{"0":{"loc":{"start":{"line":4,"column":2},"end":{"line":4,"column":17}},"type":"default-arg","locations":[{"start":{"line":4,"column":13},"end":{"line":4,"column":17}}]},"1":{"loc":{"start":{"line":11,"column":2},"end":{"line":15,"column":3}},"type":"if","locations":[{"start":{"line":11,"column":2},"end":{"line":15,"column":3}},{"start":{"line":13,"column":9},"end":{"line":15,"column":3}}]},"2":{"loc":{"start":{"line":18,"column":2},"end":{"line":34,"column":3}},"type":"if","locations":[{"start":{"line":18,"column":2},"end":{"line":34,"column":3}},{"start":{"line":31,"column":9},"end":{"line":34,"column":3}}]},"3":{"loc":{"start":{"line":19,"column":4},"end":{"line":30,"column":5}},"type":"if","locations":[{"start":{"line":19,"column":4},"end":{"line":30,"column":5}},{"start":{"line":26,"column":11},"end":{"line":30,"column":5}}]},"4":{"loc":{"start":{"line":26,"column":11},"end":{"line":30,"column":5}},"type":"if","locations":[{"start":{"line":26,"column":11},"end":{"line":30,"column":5}}]}},"s":{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0},"f":{"0":0,"1":0,"2":0,"3":0},"b":{"0":[0],"1":[0,0],"2":[0,0],"3":[0,0],"4":[0]}}
2 | ,"/workspaces/list-bridge/src/utils/sanitizer.ts": {"path":"/workspaces/list-bridge/src/utils/sanitizer.ts","statementMap":{"0":{"start":{"line":8,"column":0},"end":{"line":8,"column":16}},"1":{"start":{"line":9,"column":18},"end":{"line":9,"column":47}},"2":{"start":{"line":10,"column":2},"end":{"line":10,"column":28}},"3":{"start":{"line":11,"column":2},"end":{"line":11,"column":27}}},"fnMap":{"0":{"name":"sanitize","decl":{"start":{"line":8,"column":16},"end":{"line":8,"column":24}},"loc":{"start":{"line":8,"column":38},"end":{"line":12,"column":1}}}},"branchMap":{},"s":{"0":0,"1":0,"2":0,"3":0},"f":{"0":0},"b":{}}
3 | }
4 | 


--------------------------------------------------------------------------------
/coverage/lcov-report/base.css:
--------------------------------------------------------------------------------
  1 | body, html {
  2 |   margin:0; padding: 0;
  3 |   height: 100%;
  4 | }
  5 | body {
  6 |     font-family: Helvetica Neue, Helvetica, Arial;
  7 |     font-size: 14px;
  8 |     color:#333;
  9 | }
 10 | .small { font-size: 12px; }
 11 | *, *:after, *:before {
 12 |   -webkit-box-sizing:border-box;
 13 |      -moz-box-sizing:border-box;
 14 |           box-sizing:border-box;
 15 |   }
 16 | h1 { font-size: 20px; margin: 0;}
 17 | h2 { font-size: 14px; }
 18 | pre {
 19 |     font: 12px/1.4 Consolas, "Liberation Mono", Menlo, Courier, monospace;
 20 |     margin: 0;
 21 |     padding: 0;
 22 |     -moz-tab-size: 2;
 23 |     -o-tab-size:  2;
 24 |     tab-size: 2;
 25 | }
 26 | a { color:#0074D9; text-decoration:none; }
 27 | a:hover { text-decoration:underline; }
 28 | .strong { font-weight: bold; }
 29 | .space-top1 { padding: 10px 0 0 0; }
 30 | .pad2y { padding: 20px 0; }
 31 | .pad1y { padding: 10px 0; }
 32 | .pad2x { padding: 0 20px; }
 33 | .pad2 { padding: 20px; }
 34 | .pad1 { padding: 10px; }
 35 | .space-left2 { padding-left:55px; }
 36 | .space-right2 { padding-right:20px; }
 37 | .center { text-align:center; }
 38 | .clearfix { display:block; }
 39 | .clearfix:after {
 40 |   content:'';
 41 |   display:block;
 42 |   height:0;
 43 |   clear:both;
 44 |   visibility:hidden;
 45 |   }
 46 | .fl { float: left; }
 47 | @media only screen and (max-width:640px) {
 48 |   .col3 { width:100%; max-width:100%; }
 49 |   .hide-mobile { display:none!important; }
 50 | }
 51 | 
 52 | .quiet {
 53 |   color: #7f7f7f;
 54 |   color: rgba(0,0,0,0.5);
 55 | }
 56 | .quiet a { opacity: 0.7; }
 57 | 
 58 | .fraction {
 59 |   font-family: Consolas, 'Liberation Mono', Menlo, Courier, monospace;
 60 |   font-size: 10px;
 61 |   color: #555;
 62 |   background: #E8E8E8;
 63 |   padding: 4px 5px;
 64 |   border-radius: 3px;
 65 |   vertical-align: middle;
 66 | }
 67 | 
 68 | div.path a:link, div.path a:visited { color: #333; }
 69 | table.coverage {
 70 |   border-collapse: collapse;
 71 |   margin: 10px 0 0 0;
 72 |   padding: 0;
 73 | }
 74 | 
 75 | table.coverage td {
 76 |   margin: 0;
 77 |   padding: 0;
 78 |   vertical-align: top;
 79 | }
 80 | table.coverage td.line-count {
 81 |     text-align: right;
 82 |     padding: 0 5px 0 20px;
 83 | }
 84 | table.coverage td.line-coverage {
 85 |     text-align: right;
 86 |     padding-right: 10px;
 87 |     min-width:20px;
 88 | }
 89 | 
 90 | table.coverage td span.cline-any {
 91 |     display: inline-block;
 92 |     padding: 0 5px;
 93 |     width: 100%;
 94 | }
 95 | .missing-if-branch {
 96 |     display: inline-block;
 97 |     margin-right: 5px;
 98 |     border-radius: 3px;
 99 |     position: relative;
100 |     padding: 0 4px;
101 |     background: #333;
102 |     color: yellow;
103 | }
104 | 
105 | .skip-if-branch {
106 |     display: none;
107 |     margin-right: 10px;
108 |     position: relative;
109 |     padding: 0 4px;
110 |     background: #ccc;
111 |     color: white;
112 | }
113 | .missing-if-branch .typ, .skip-if-branch .typ {
114 |     color: inherit !important;
115 | }
116 | .coverage-summary {
117 |   border-collapse: collapse;
118 |   width: 100%;
119 | }
120 | .coverage-summary tr { border-bottom: 1px solid #bbb; }
121 | .keyline-all { border: 1px solid #ddd; }
122 | .coverage-summary td, .coverage-summary th { padding: 10px; }
123 | .coverage-summary tbody { border: 1px solid #bbb; }
124 | .coverage-summary td { border-right: 1px solid #bbb; }
125 | .coverage-summary td:last-child { border-right: none; }
126 | .coverage-summary th {
127 |   text-align: left;
128 |   font-weight: normal;
129 |   white-space: nowrap;
130 | }
131 | .coverage-summary th.file { border-right: none !important; }
132 | .coverage-summary th.pct { }
133 | .coverage-summary th.pic,
134 | .coverage-summary th.abs,
135 | .coverage-summary td.pct,
136 | .coverage-summary td.abs { text-align: right; }
137 | .coverage-summary td.file { white-space: nowrap;  }
138 | .coverage-summary td.pic { min-width: 120px !important;  }
139 | .coverage-summary tfoot td { }
140 | 
141 | .coverage-summary .sorter {
142 |     height: 10px;
143 |     width: 7px;
144 |     display: inline-block;
145 |     margin-left: 0.5em;
146 |     background: url(sort-arrow-sprite.png) no-repeat scroll 0 0 transparent;
147 | }
148 | .coverage-summary .sorted .sorter {
149 |     background-position: 0 -20px;
150 | }
151 | .coverage-summary .sorted-desc .sorter {
152 |     background-position: 0 -10px;
153 | }
154 | .status-line {  height: 10px; }
155 | /* yellow */
156 | .cbranch-no { background: yellow !important; color: #111; }
157 | /* dark red */
158 | .red.solid, .status-line.low, .low .cover-fill { background:#C21F39 }
159 | .low .chart { border:1px solid #C21F39 }
160 | .highlighted,
161 | .highlighted .cstat-no, .highlighted .fstat-no, .highlighted .cbranch-no{
162 |   background: #C21F39 !important;
163 | }
164 | /* medium red */
165 | .cstat-no, .fstat-no, .cbranch-no, .cbranch-no { background:#F6C6CE }
166 | /* light red */
167 | .low, .cline-no { background:#FCE1E5 }
168 | /* light green */
169 | .high, .cline-yes { background:rgb(230,245,208) }
170 | /* medium green */
171 | .cstat-yes { background:rgb(161,215,106) }
172 | /* dark green */
173 | .status-line.high, .high .cover-fill { background:rgb(77,146,33) }
174 | .high .chart { border:1px solid rgb(77,146,33) }
175 | /* dark yellow (gold) */
176 | .status-line.medium, .medium .cover-fill { background: #f9cd0b; }
177 | .medium .chart { border:1px solid #f9cd0b; }
178 | /* light yellow */
179 | .medium { background: #fff4c2; }
180 | 
181 | .cstat-skip { background: #ddd; color: #111; }
182 | .fstat-skip { background: #ddd; color: #111 !important; }
183 | .cbranch-skip { background: #ddd !important; color: #111; }
184 | 
185 | span.cline-neutral { background: #eaeaea; }
186 | 
187 | .coverage-summary td.empty {
188 |     opacity: .5;
189 |     padding-top: 4px;
190 |     padding-bottom: 4px;
191 |     line-height: 1;
192 |     color: #888;
193 | }
194 | 
195 | .cover-fill, .cover-empty {
196 |   display:inline-block;
197 |   height: 12px;
198 | }
199 | .chart {
200 |   line-height: 0;
201 | }
202 | .cover-empty {
203 |     background: white;
204 | }
205 | .cover-full {
206 |     border-right: none !important;
207 | }
208 | pre.prettyprint {
209 |     border: none !important;
210 |     padding: 0 !important;
211 |     margin: 0 !important;
212 | }
213 | .com { color: #999 !important; }
214 | .ignore-none { color: #999; font-weight: normal; }
215 | 
216 | .wrapper {
217 |   min-height: 100%;
218 |   height: auto !important;
219 |   height: 100%;
220 |   margin: 0 auto -48px;
221 | }
222 | .footer, .push {
223 |   height: 48px;
224 | }
225 | 


--------------------------------------------------------------------------------
/coverage/lcov-report/block-navigation.js:
--------------------------------------------------------------------------------
 1 | /* eslint-disable */
 2 | var jumpToCode = (function init() {
 3 |     // Classes of code we would like to highlight in the file view
 4 |     var missingCoverageClasses = ['.cbranch-no', '.cstat-no', '.fstat-no'];
 5 | 
 6 |     // Elements to highlight in the file listing view
 7 |     var fileListingElements = ['td.pct.low'];
 8 | 
 9 |     // We don't want to select elements that are direct descendants of another match
10 |     var notSelector = ':not(' + missingCoverageClasses.join('):not(') + ') > '; // becomes `:not(a):not(b) > `
11 | 
12 |     // Selecter that finds elements on the page to which we can jump
13 |     var selector =
14 |         fileListingElements.join(', ') +
15 |         ', ' +
16 |         notSelector +
17 |         missingCoverageClasses.join(', ' + notSelector); // becomes `:not(a):not(b) > a, :not(a):not(b) > b`
18 | 
19 |     // The NodeList of matching elements
20 |     var missingCoverageElements = document.querySelectorAll(selector);
21 | 
22 |     var currentIndex;
23 | 
24 |     function toggleClass(index) {
25 |         missingCoverageElements
26 |             .item(currentIndex)
27 |             .classList.remove('highlighted');
28 |         missingCoverageElements.item(index).classList.add('highlighted');
29 |     }
30 | 
31 |     function makeCurrent(index) {
32 |         toggleClass(index);
33 |         currentIndex = index;
34 |         missingCoverageElements.item(index).scrollIntoView({
35 |             behavior: 'smooth',
36 |             block: 'center',
37 |             inline: 'center'
38 |         });
39 |     }
40 | 
41 |     function goToPrevious() {
42 |         var nextIndex = 0;
43 |         if (typeof currentIndex !== 'number' || currentIndex === 0) {
44 |             nextIndex = missingCoverageElements.length - 1;
45 |         } else if (missingCoverageElements.length > 1) {
46 |             nextIndex = currentIndex - 1;
47 |         }
48 | 
49 |         makeCurrent(nextIndex);
50 |     }
51 | 
52 |     function goToNext() {
53 |         var nextIndex = 0;
54 | 
55 |         if (
56 |             typeof currentIndex === 'number' &&
57 |             currentIndex < missingCoverageElements.length - 1
58 |         ) {
59 |             nextIndex = currentIndex + 1;
60 |         }
61 | 
62 |         makeCurrent(nextIndex);
63 |     }
64 | 
65 |     return function jump(event) {
66 |         if (
67 |             document.getElementById('fileSearch') === document.activeElement &&
68 |             document.activeElement != null
69 |         ) {
70 |             // if we're currently focused on the search input, we don't want to navigate
71 |             return;
72 |         }
73 | 
74 |         switch (event.which) {
75 |             case 78: // n
76 |             case 74: // j
77 |                 goToNext();
78 |                 break;
79 |             case 66: // b
80 |             case 75: // k
81 |             case 80: // p
82 |                 goToPrevious();
83 |                 break;
84 |         }
85 |     };
86 | })();
87 | window.addEventListener('keydown', jumpToCode);
88 | 


--------------------------------------------------------------------------------
/coverage/lcov-report/favicon.png:
--------------------------------------------------------------------------------
https://raw.githubusercontent.com/TheSethRose/list-bridge/main/coverage/lcov-report/favicon.png


--------------------------------------------------------------------------------
/coverage/lcov-report/feedback.ts.html:
--------------------------------------------------------------------------------
  1 | 
  2 | <!doctype html>
  3 | <html lang="en">
  4 | 
  5 | <head>
  6 |     <title>Code coverage report for feedback.ts</title>
  7 |     <meta charset="utf-8" />
  8 |     <link rel="stylesheet" href="prettify.css" />
  9 |     <link rel="stylesheet" href="base.css" />
 10 |     <link rel="shortcut icon" type="image/x-icon" href="favicon.png" />
 11 |     <meta name="viewport" content="width=device-width, initial-scale=1" />
 12 |     <style type='text/css'>
 13 |         .coverage-summary .sorter {
 14 |             background-image: url(sort-arrow-sprite.png);
 15 |         }
 16 |     </style>
 17 | </head>
 18 |     
 19 | <body>
 20 | <div class='wrapper'>
 21 |     <div class='pad1'>
 22 |         <h1><a href="index.html">All files</a> feedback.ts</h1>
 23 |         <div class='clearfix'>
 24 |             
 25 |             <div class='fl pad1y space-right2'>
 26 |                 <span class="strong">0% </span>
 27 |                 <span class="quiet">Statements</span>
 28 |                 <span class='fraction'>0/29</span>
 29 |             </div>
 30 |         
 31 |             
 32 |             <div class='fl pad1y space-right2'>
 33 |                 <span class="strong">0% </span>
 34 |                 <span class="quiet">Branches</span>
 35 |                 <span class='fraction'>0/8</span>
 36 |             </div>
 37 |         
 38 |             
 39 |             <div class='fl pad1y space-right2'>
 40 |                 <span class="strong">0% </span>
 41 |                 <span class="quiet">Functions</span>
 42 |                 <span class='fraction'>0/4</span>
 43 |             </div>
 44 |         
 45 |             
 46 |             <div class='fl pad1y space-right2'>
 47 |                 <span class="strong">0% </span>
 48 |                 <span class="quiet">Lines</span>
 49 |                 <span class='fraction'>0/27</span>
 50 |             </div>
 51 |         
 52 |             
 53 |         </div>
 54 |         <p class="quiet">
 55 |             Press <em>n</em> or <em>j</em> to go to the next uncovered block, <em>b</em>, <em>p</em> or <em>k</em> for the previous block.
 56 |         </p>
 57 |         <template id="filterTemplate">
 58 |             <div class="quiet">
 59 |                 Filter:
 60 |                 <input type="search" id="fileSearch">
 61 |             </div>
 62 |         </template>
 63 |     </div>
 64 |     <div class='status-line low'></div>
 65 |     <pre><table class="coverage">
 66 | <tr><td class="line-count quiet"><a name='L1'></a><a href='#L1'>1</a>
 67 | <a name='L2'></a><a href='#L2'>2</a>
 68 | <a name='L3'></a><a href='#L3'>3</a>
 69 | <a name='L4'></a><a href='#L4'>4</a>
 70 | <a name='L5'></a><a href='#L5'>5</a>
 71 | <a name='L6'></a><a href='#L6'>6</a>
 72 | <a name='L7'></a><a href='#L7'>7</a>
 73 | <a name='L8'></a><a href='#L8'>8</a>
 74 | <a name='L9'></a><a href='#L9'>9</a>
 75 | <a name='L10'></a><a href='#L10'>10</a>
 76 | <a name='L11'></a><a href='#L11'>11</a>
 77 | <a name='L12'></a><a href='#L12'>12</a>
 78 | <a name='L13'></a><a href='#L13'>13</a>
 79 | <a name='L14'></a><a href='#L14'>14</a>
 80 | <a name='L15'></a><a href='#L15'>15</a>
 81 | <a name='L16'></a><a href='#L16'>16</a>
 82 | <a name='L17'></a><a href='#L17'>17</a>
 83 | <a name='L18'></a><a href='#L18'>18</a>
 84 | <a name='L19'></a><a href='#L19'>19</a>
 85 | <a name='L20'></a><a href='#L20'>20</a>
 86 | <a name='L21'></a><a href='#L21'>21</a>
 87 | <a name='L22'></a><a href='#L22'>22</a>
 88 | <a name='L23'></a><a href='#L23'>23</a>
 89 | <a name='L24'></a><a href='#L24'>24</a>
 90 | <a name='L25'></a><a href='#L25'>25</a>
 91 | <a name='L26'></a><a href='#L26'>26</a>
 92 | <a name='L27'></a><a href='#L27'>27</a>
 93 | <a name='L28'></a><a href='#L28'>28</a>
 94 | <a name='L29'></a><a href='#L29'>29</a>
 95 | <a name='L30'></a><a href='#L30'>30</a>
 96 | <a name='L31'></a><a href='#L31'>31</a>
 97 | <a name='L32'></a><a href='#L32'>32</a>
 98 | <a name='L33'></a><a href='#L33'>33</a>
 99 | <a name='L34'></a><a href='#L34'>34</a>
100 | <a name='L35'></a><a href='#L35'>35</a>
101 | <a name='L36'></a><a href='#L36'>36</a>
102 | <a name='L37'></a><a href='#L37'>37</a>
103 | <a name='L38'></a><a href='#L38'>38</a>
104 | <a name='L39'></a><a href='#L39'>39</a>
105 | <a name='L40'></a><a href='#L40'>40</a>
106 | <a name='L41'></a><a href='#L41'>41</a>
107 | <a name='L42'></a><a href='#L42'>42</a>
108 | <a name='L43'></a><a href='#L43'>43</a>
109 | <a name='L44'></a><a href='#L44'>44</a>
110 | <a name='L45'></a><a href='#L45'>45</a></td><td class="line-coverage quiet"><span class="cline-any cline-neutral">&nbsp;</span>
111 | <span class="cline-any cline-no">&nbsp;</span>
112 | <span class="cline-any cline-neutral">&nbsp;</span>
113 | <span class="cline-any cline-neutral">&nbsp;</span>
114 | <span class="cline-any cline-neutral">&nbsp;</span>
115 | <span class="cline-any cline-neutral">&nbsp;</span>
116 | <span class="cline-any cline-no">&nbsp;</span>
117 | <span class="cline-any cline-no">&nbsp;</span>
118 | <span class="cline-any cline-no">&nbsp;</span>
119 | <span class="cline-any cline-no">&nbsp;</span>
120 | <span class="cline-any cline-no">&nbsp;</span>
121 | <span class="cline-any cline-no">&nbsp;</span>
122 | <span class="cline-any cline-neutral">&nbsp;</span>
123 | <span class="cline-any cline-no">&nbsp;</span>
124 | <span class="cline-any cline-neutral">&nbsp;</span>
125 | <span class="cline-any cline-neutral">&nbsp;</span>
126 | <span class="cline-any cline-neutral">&nbsp;</span>
127 | <span class="cline-any cline-no">&nbsp;</span>
128 | <span class="cline-any cline-no">&nbsp;</span>
129 | <span class="cline-any cline-no">&nbsp;</span>
130 | <span class="cline-any cline-no">&nbsp;</span>
131 | <span class="cline-any cline-no">&nbsp;</span>
132 | <span class="cline-any cline-no">&nbsp;</span>
133 | <span class="cline-any cline-no">&nbsp;</span>
134 | <span class="cline-any cline-no">&nbsp;</span>
135 | <span class="cline-any cline-no">&nbsp;</span>
136 | <span class="cline-any cline-no">&nbsp;</span>
137 | <span class="cline-any cline-no">&nbsp;</span>
138 | <span class="cline-any cline-no">&nbsp;</span>
139 | <span class="cline-any cline-neutral">&nbsp;</span>
140 | <span class="cline-any cline-neutral">&nbsp;</span>
141 | <span class="cline-any cline-no">&nbsp;</span>
142 | <span class="cline-any cline-no">&nbsp;</span>
143 | <span class="cline-any cline-neutral">&nbsp;</span>
144 | <span class="cline-any cline-neutral">&nbsp;</span>
145 | <span class="cline-any cline-no">&nbsp;</span>
146 | <span class="cline-any cline-no">&nbsp;</span>
147 | <span class="cline-any cline-neutral">&nbsp;</span>
148 | <span class="cline-any cline-neutral">&nbsp;</span>
149 | <span class="cline-any cline-no">&nbsp;</span>
150 | <span class="cline-any cline-no">&nbsp;</span>
151 | <span class="cline-any cline-no">&nbsp;</span>
152 | <span class="cline-any cline-neutral">&nbsp;</span>
153 | <span class="cline-any cline-neutral">&nbsp;</span>
154 | <span class="cline-any cline-neutral">&nbsp;</span></td><td class="text"><pre class="prettyprint lang-js">// Utility function for showing feedback messages
155 | export const <span class="cstat-no" title="statement not covered" >showFeedback = <span class="cstat-no" title="statement not covered" ><span class="fstat-no" title="function not covered" >(</span></span></span>
156 |   message: string,
157 |   duration = <span class="branch-0 cbranch-no" title="branch not covered" >1500,</span>
158 |   source?: Event | Element
159 | ): void =&gt; {
160 |   const feedback = <span class="cstat-no" title="statement not covered" >document.createElement('div');</span>
161 | <span class="cstat-no" title="statement not covered" >  feedback.className = 'feedback';</span>
162 | <span class="cstat-no" title="statement not covered" >  feedback.textContent = message;</span>
163 |   const container = <span class="cstat-no" title="statement not covered" >document.querySelector('.feedback-container');</span>
164 | <span class="cstat-no" title="statement not covered" >  if (container) {</span>
165 | <span class="cstat-no" title="statement not covered" >    container.appendChild(feedback);</span>
166 |   } else {
167 | <span class="cstat-no" title="statement not covered" >    document.body.appendChild(feedback);</span>
168 |   }
169 |   
170 |   // Position feedback based on source (if provided)
171 | <span class="cstat-no" title="statement not covered" >  if (source) {</span>
172 | <span class="cstat-no" title="statement not covered" >    if (source instanceof MouseEvent) {</span>
173 |       const offset = <span class="cstat-no" title="statement not covered" >15;</span>
174 |       const padding = <span class="cstat-no" title="statement not covered" >10;</span>
175 |       let left = <span class="cstat-no" title="statement not covered" >Math.min(Math.max(source.clientX, padding), window.innerWidth - padding);</span>
176 |       let top = <span class="cstat-no" title="statement not covered" >Math.min(Math.max(source.clientY - offset, padding), window.innerHeight - padding);</span>
177 | <span class="cstat-no" title="statement not covered" >      feedback.style.left = `${left}px`;</span>
178 | <span class="cstat-no" title="statement not covered" >      feedback.style.top = `${top}px`;</span>
179 |     } else <span class="cstat-no" title="statement not covered" ><span class="missing-if-branch" title="if path not taken" >I</span>if (source instanceof Element) {</span>
180 |       const rect = <span class="cstat-no" title="statement not covered" >source.getBoundingClientRect();</span>
181 | <span class="cstat-no" title="statement not covered" >      feedback.style.left = `${rect.left + rect.width / 2}px`;</span>
182 | <span class="cstat-no" title="statement not covered" >      feedback.style.top = `${rect.top - 15}px`;</span>
183 |     }
184 |   } else {
185 | <span class="cstat-no" title="statement not covered" >    feedback.style.left = '50%';</span>
186 | <span class="cstat-no" title="statement not covered" >    feedback.style.top = '40%';</span>
187 |   }
188 |   
189 | <span class="cstat-no" title="statement not covered" >  requestAnimationFrame(<span class="fstat-no" title="function not covered" >() =</span>&gt; {</span>
190 | <span class="cstat-no" title="statement not covered" >    feedback.classList.add('show');</span>
191 |   });
192 |   
193 | <span class="cstat-no" title="statement not covered" >  setTimeout(<span class="fstat-no" title="function not covered" >() =</span>&gt; {</span>
194 | <span class="cstat-no" title="statement not covered" >    feedback.classList.remove('show');</span>
195 | <span class="cstat-no" title="statement not covered" >    setTimeout(<span class="fstat-no" title="function not covered" >() =</span>&gt; <span class="cstat-no" title="statement not covered" >feedback.remove(),</span> 150);</span>
196 |   }, duration);
197 | };
198 | &nbsp;</pre></td></tr></table></pre>
199 | 
200 |                 <div class='push'></div><!-- for sticky footer -->
201 |             </div><!-- /wrapper -->
202 |             <div class='footer quiet pad2 space-top1 center small'>
203 |                 Code coverage generated by
204 |                 <a href="https://istanbul.js.org/" target="_blank" rel="noopener noreferrer">istanbul</a>
205 |                 at 2025-02-03T04:50:57.328Z
206 |             </div>
207 |         <script src="prettify.js"></script>
208 |         <script>
209 |             window.onload = function () {
210 |                 prettyPrint();
211 |             };
212 |         </script>
213 |         <script src="sorter.js"></script>
214 |         <script src="block-navigation.js"></script>
215 |     </body>
216 | </html>
217 |     


--------------------------------------------------------------------------------
/coverage/lcov-report/index.html:
--------------------------------------------------------------------------------
  1 | 
  2 | <!doctype html>
  3 | <html lang="en">
  4 | 
  5 | <head>
  6 |     <title>Code coverage report for All files</title>
  7 |     <meta charset="utf-8" />
  8 |     <link rel="stylesheet" href="prettify.css" />
  9 |     <link rel="stylesheet" href="base.css" />
 10 |     <link rel="shortcut icon" type="image/x-icon" href="favicon.png" />
 11 |     <meta name="viewport" content="width=device-width, initial-scale=1" />
 12 |     <style type='text/css'>
 13 |         .coverage-summary .sorter {
 14 |             background-image: url(sort-arrow-sprite.png);
 15 |         }
 16 |     </style>
 17 | </head>
 18 |     
 19 | <body>
 20 | <div class='wrapper'>
 21 |     <div class='pad1'>
 22 |         <h1>All files</h1>
 23 |         <div class='clearfix'>
 24 |             
 25 |             <div class='fl pad1y space-right2'>
 26 |                 <span class="strong">0% </span>
 27 |                 <span class="quiet">Statements</span>
 28 |                 <span class='fraction'>0/33</span>
 29 |             </div>
 30 |         
 31 |             
 32 |             <div class='fl pad1y space-right2'>
 33 |                 <span class="strong">0% </span>
 34 |                 <span class="quiet">Branches</span>
 35 |                 <span class='fraction'>0/8</span>
 36 |             </div>
 37 |         
 38 |             
 39 |             <div class='fl pad1y space-right2'>
 40 |                 <span class="strong">0% </span>
 41 |                 <span class="quiet">Functions</span>
 42 |                 <span class='fraction'>0/5</span>
 43 |             </div>
 44 |         
 45 |             
 46 |             <div class='fl pad1y space-right2'>
 47 |                 <span class="strong">0% </span>
 48 |                 <span class="quiet">Lines</span>
 49 |                 <span class='fraction'>0/31</span>
 50 |             </div>
 51 |         
 52 |             
 53 |         </div>
 54 |         <p class="quiet">
 55 |             Press <em>n</em> or <em>j</em> to go to the next uncovered block, <em>b</em>, <em>p</em> or <em>k</em> for the previous block.
 56 |         </p>
 57 |         <template id="filterTemplate">
 58 |             <div class="quiet">
 59 |                 Filter:
 60 |                 <input type="search" id="fileSearch">
 61 |             </div>
 62 |         </template>
 63 |     </div>
 64 |     <div class='status-line low'></div>
 65 |     <div class="pad1">
 66 | <table class="coverage-summary">
 67 | <thead>
 68 | <tr>
 69 |    <th data-col="file" data-fmt="html" data-html="true" class="file">File</th>
 70 |    <th data-col="pic" data-type="number" data-fmt="html" data-html="true" class="pic"></th>
 71 |    <th data-col="statements" data-type="number" data-fmt="pct" class="pct">Statements</th>
 72 |    <th data-col="statements_raw" data-type="number" data-fmt="html" class="abs"></th>
 73 |    <th data-col="branches" data-type="number" data-fmt="pct" class="pct">Branches</th>
 74 |    <th data-col="branches_raw" data-type="number" data-fmt="html" class="abs"></th>
 75 |    <th data-col="functions" data-type="number" data-fmt="pct" class="pct">Functions</th>
 76 |    <th data-col="functions_raw" data-type="number" data-fmt="html" class="abs"></th>
 77 |    <th data-col="lines" data-type="number" data-fmt="pct" class="pct">Lines</th>
 78 |    <th data-col="lines_raw" data-type="number" data-fmt="html" class="abs"></th>
 79 | </tr>
 80 | </thead>
 81 | <tbody><tr>
 82 | 	<td class="file low" data-value="feedback.ts"><a href="feedback.ts.html">feedback.ts</a></td>
 83 | 	<td data-value="0" class="pic low">
 84 | 	<div class="chart"><div class="cover-fill" style="width: 0%"></div><div class="cover-empty" style="width: 100%"></div></div>
 85 | 	</td>
 86 | 	<td data-value="0" class="pct low">0%</td>
 87 | 	<td data-value="29" class="abs low">0/29</td>
 88 | 	<td data-value="0" class="pct low">0%</td>
 89 | 	<td data-value="8" class="abs low">0/8</td>
 90 | 	<td data-value="0" class="pct low">0%</td>
 91 | 	<td data-value="4" class="abs low">0/4</td>
 92 | 	<td data-value="0" class="pct low">0%</td>
 93 | 	<td data-value="27" class="abs low">0/27</td>
 94 | 	</tr>
 95 | 
 96 | <tr>
 97 | 	<td class="file low" data-value="sanitizer.ts"><a href="sanitizer.ts.html">sanitizer.ts</a></td>
 98 | 	<td data-value="0" class="pic low">
 99 | 	<div class="chart"><div class="cover-fill" style="width: 0%"></div><div class="cover-empty" style="width: 100%"></div></div>
100 | 	</td>
101 | 	<td data-value="0" class="pct low">0%</td>
102 | 	<td data-value="4" class="abs low">0/4</td>
103 | 	<td data-value="100" class="pct high">100%</td>
104 | 	<td data-value="0" class="abs high">0/0</td>
105 | 	<td data-value="0" class="pct low">0%</td>
106 | 	<td data-value="1" class="abs low">0/1</td>
107 | 	<td data-value="0" class="pct low">0%</td>
108 | 	<td data-value="4" class="abs low">0/4</td>
109 | 	</tr>
110 | 
111 | </tbody>
112 | </table>
113 | </div>
114 |                 <div class='push'></div><!-- for sticky footer -->
115 |             </div><!-- /wrapper -->
116 |             <div class='footer quiet pad2 space-top1 center small'>
117 |                 Code coverage generated by
118 |                 <a href="https://istanbul.js.org/" target="_blank" rel="noopener noreferrer">istanbul</a>
119 |                 at 2025-02-03T04:50:57.328Z
120 |             </div>
121 |         <script src="prettify.js"></script>
122 |         <script>
123 |             window.onload = function () {
124 |                 prettyPrint();
125 |             };
126 |         </script>
127 |         <script src="sorter.js"></script>
128 |         <script src="block-navigation.js"></script>
129 |     </body>
130 | </html>
131 |     


--------------------------------------------------------------------------------
/coverage/lcov-report/prettify.css:
--------------------------------------------------------------------------------
1 | .pln{color:#000}@media screen{.str{color:#080}.kwd{color:#008}.com{color:#800}.typ{color:#606}.lit{color:#066}.pun,.opn,.clo{color:#660}.tag{color:#008}.atn{color:#606}.atv{color:#080}.dec,.var{color:#606}.fun{color:red}}@media print,projection{.str{color:#060}.kwd{color:#006;font-weight:bold}.com{color:#600;font-style:italic}.typ{color:#404;font-weight:bold}.lit{color:#044}.pun,.opn,.clo{color:#440}.tag{color:#006;font-weight:bold}.atn{color:#404}.atv{color:#060}}pre.prettyprint{padding:2px;border:1px solid #888}ol.linenums{margin-top:0;margin-bottom:0}li.L0,li.L1,li.L2,li.L3,li.L5,li.L6,li.L7,li.L8{list-style-type:none}li.L1,li.L3,li.L5,li.L7,li.L9{background:#eee}
2 | 


--------------------------------------------------------------------------------
/coverage/lcov-report/prettify.js:
--------------------------------------------------------------------------------
1 | /* eslint-disable */
2 | window.PR_SHOULD_USE_CONTINUATION=true;(function(){var h=["break,continue,do,else,for,if,return,while"];var u=[h,"auto,case,char,const,default,double,enum,extern,float,goto,int,long,register,short,signed,sizeof,static,struct,switch,typedef,union,unsigned,void,volatile"];var p=[u,"catch,class,delete,false,import,new,operator,private,protected,public,this,throw,true,try,typeof"];var l=[p,"alignof,align_union,asm,axiom,bool,concept,concept_map,const_cast,constexpr,decltype,dynamic_cast,explicit,export,friend,inline,late_check,mutable,namespace,nullptr,reinterpret_cast,static_assert,static_cast,template,typeid,typename,using,virtual,where"];var x=[p,"abstract,boolean,byte,extends,final,finally,implements,import,instanceof,null,native,package,strictfp,super,synchronized,throws,transient"];var R=[x,"as,base,by,checked,decimal,delegate,descending,dynamic,event,fixed,foreach,from,group,implicit,in,interface,internal,into,is,lock,object,out,override,orderby,params,partial,readonly,ref,sbyte,sealed,stackalloc,string,select,uint,ulong,unchecked,unsafe,ushort,var"];var r="all,and,by,catch,class,else,extends,false,finally,for,if,in,is,isnt,loop,new,no,not,null,of,off,on,or,return,super,then,true,try,unless,until,when,while,yes";var w=[p,"debugger,eval,export,function,get,null,set,undefined,var,with,Infinity,NaN"];var s="caller,delete,die,do,dump,elsif,eval,exit,foreach,for,goto,if,import,last,local,my,next,no,our,print,package,redo,require,sub,undef,unless,until,use,wantarray,while,BEGIN,END";var I=[h,"and,as,assert,class,def,del,elif,except,exec,finally,from,global,import,in,is,lambda,nonlocal,not,or,pass,print,raise,try,with,yield,False,True,None"];var f=[h,"alias,and,begin,case,class,def,defined,elsif,end,ensure,false,in,module,next,nil,not,or,redo,rescue,retry,self,super,then,true,undef,unless,until,when,yield,BEGIN,END"];var H=[h,"case,done,elif,esac,eval,fi,function,in,local,set,then,until"];var A=[l,R,w,s+I,f,H];var e=/^(DIR|FILE|vector|(de|priority_)?queue|list|stack|(const_)?iterator|(multi)?(set|map)|bitset|u?(int|float)\d*)/;var C="str";var z="kwd";var j="com";var O="typ";var G="lit";var L="pun";var F="pln";var m="tag";var E="dec";var J="src";var P="atn";var n="atv";var N="nocode";var M="(?:^^\\.?|[+-]|\\!|\\!=|\\!==|\\#|\\%|\\%=|&|&&|&&=|&=|\\(|\\*|\\*=|\\+=|\\,|\\-=|\\->|\\/|\\/=|:|::|\\;|<|<<|<<=|<=|=|==|===|>|>=|>>|>>=|>>>|>>>=|\\?|\\@|\\[|\\^|\\^=|\\^\\^|\\^\\^=|\\{|\\||\\|=|\\|\\||\\|\\|=|\\~|break|case|continue|delete|do|else|finally|instanceof|return|throw|try|typeof)\\s*";function k(Z){var ad=0;var S=false;var ac=false;for(var V=0,U=Z.length;V<U;++V){var ae=Z[V];if(ae.ignoreCase){ac=true}else{if(/[a-z]/i.test(ae.source.replace(/\\u[0-9a-f]{4}|\\x[0-9a-f]{2}|\\[^ux]/gi,""))){S=true;ac=false;break}}}var Y={b:8,t:9,n:10,v:11,f:12,r:13};function ab(ah){var ag=ah.charCodeAt(0);if(ag!==92){return ag}var af=ah.charAt(1);ag=Y[af];if(ag){return ag}else{if("0"<=af&&af<="7"){return parseInt(ah.substring(1),8)}else{if(af==="u"||af==="x"){return parseInt(ah.substring(2),16)}else{return ah.charCodeAt(1)}}}}function T(af){if(af<32){return(af<16?"\\x0":"\\x")+af.toString(16)}var ag=String.fromCharCode(af);if(ag==="\\"||ag==="-"||ag==="["||ag==="]"){ag="\\"+ag}return ag}function X(am){var aq=am.substring(1,am.length-1).match(new RegExp("\\\\u[0-9A-Fa-f]{4}|\\\\x[0-9A-Fa-f]{2}|\\\\[0-3][0-7]{0,2}|\\\\[0-7]{1,2}|\\\\[\\s\\S]|-|[^-\\\\]","g"));var ak=[];var af=[];var ao=aq[0]==="^";for(var ar=ao?1:0,aj=aq.length;ar<aj;++ar){var ah=aq[ar];if(/\\[bdsw]/i.test(ah)){ak.push(ah)}else{var ag=ab(ah);var al;if(ar+2<aj&&"-"===aq[ar+1]){al=ab(aq[ar+2]);ar+=2}else{al=ag}af.push([ag,al]);if(!(al<65||ag>122)){if(!(al<65||ag>90)){af.push([Math.max(65,ag)|32,Math.min(al,90)|32])}if(!(al<97||ag>122)){af.push([Math.max(97,ag)&~32,Math.min(al,122)&~32])}}}}af.sort(function(av,au){return(av[0]-au[0])||(au[1]-av[1])});var ai=[];var ap=[NaN,NaN];for(var ar=0;ar<af.length;++ar){var at=af[ar];if(at[0]<=ap[1]+1){ap[1]=Math.max(ap[1],at[1])}else{ai.push(ap=at)}}var an=["["];if(ao){an.push("^")}an.push.apply(an,ak);for(var ar=0;ar<ai.length;++ar){var at=ai[ar];an.push(T(at[0]));if(at[1]>at[0]){if(at[1]+1>at[0]){an.push("-")}an.push(T(at[1]))}}an.push("]");return an.join("")}function W(al){var aj=al.source.match(new RegExp("(?:\\[(?:[^\\x5C\\x5D]|\\\\[\\s\\S])*\\]|\\\\u[A-Fa-f0-9]{4}|\\\\x[A-Fa-f0-9]{2}|\\\\[0-9]+|\\\\[^ux0-9]|\\(\\?[:!=]|[\\(\\)\\^]|[^\\x5B\\x5C\\(\\)\\^]+)","g"));var ah=aj.length;var an=[];for(var ak=0,am=0;ak<ah;++ak){var ag=aj[ak];if(ag==="("){++am}else{if("\\"===ag.charAt(0)){var af=+ag.substring(1);if(af&&af<=am){an[af]=-1}}}}for(var ak=1;ak<an.length;++ak){if(-1===an[ak]){an[ak]=++ad}}for(var ak=0,am=0;ak<ah;++ak){var ag=aj[ak];if(ag==="("){++am;if(an[am]===undefined){aj[ak]="(?:"}}else{if("\\"===ag.charAt(0)){var af=+ag.substring(1);if(af&&af<=am){aj[ak]="\\"+an[am]}}}}for(var ak=0,am=0;ak<ah;++ak){if("^"===aj[ak]&&"^"!==aj[ak+1]){aj[ak]=""}}if(al.ignoreCase&&S){for(var ak=0;ak<ah;++ak){var ag=aj[ak];var ai=ag.charAt(0);if(ag.length>=2&&ai==="["){aj[ak]=X(ag)}else{if(ai!=="\\"){aj[ak]=ag.replace(/[a-zA-Z]/g,function(ao){var ap=ao.charCodeAt(0);return"["+String.fromCharCode(ap&~32,ap|32)+"]"})}}}}return aj.join("")}var aa=[];for(var V=0,U=Z.length;V<U;++V){var ae=Z[V];if(ae.global||ae.multiline){throw new Error(""+ae)}aa.push("(?:"+W(ae)+")")}return new RegExp(aa.join("|"),ac?"gi":"g")}function a(V){var U=/(?:^|\s)nocode(?:\s|$)/;var X=[];var T=0;var Z=[];var W=0;var S;if(V.currentStyle){S=V.currentStyle.whiteSpace}else{if(window.getComputedStyle){S=document.defaultView.getComputedStyle(V,null).getPropertyValue("white-space")}}var Y=S&&"pre"===S.substring(0,3);function aa(ab){switch(ab.nodeType){case 1:if(U.test(ab.className)){return}for(var ae=ab.firstChild;ae;ae=ae.nextSibling){aa(ae)}var ad=ab.nodeName;if("BR"===ad||"LI"===ad){X[W]="\n";Z[W<<1]=T++;Z[(W++<<1)|1]=ab}break;case 3:case 4:var ac=ab.nodeValue;if(ac.length){if(!Y){ac=ac.replace(/[ \t\r\n]+/g," ")}else{ac=ac.replace(/\r\n?/g,"\n")}X[W]=ac;Z[W<<1]=T;T+=ac.length;Z[(W++<<1)|1]=ab}break}}aa(V);return{sourceCode:X.join("").replace(/\n$/,""),spans:Z}}function B(S,U,W,T){if(!U){return}var V={sourceCode:U,basePos:S};W(V);T.push.apply(T,V.decorations)}var v=/\S/;function o(S){var V=undefined;for(var U=S.firstChild;U;U=U.nextSibling){var T=U.nodeType;V=(T===1)?(V?S:U):(T===3)?(v.test(U.nodeValue)?S:V):V}return V===S?undefined:V}function g(U,T){var S={};var V;(function(){var ad=U.concat(T);var ah=[];var ag={};for(var ab=0,Z=ad.length;ab<Z;++ab){var Y=ad[ab];var ac=Y[3];if(ac){for(var ae=ac.length;--ae>=0;){S[ac.charAt(ae)]=Y}}var af=Y[1];var aa=""+af;if(!ag.hasOwnProperty(aa)){ah.push(af);ag[aa]=null}}ah.push(/[\0-\uffff]/);V=k(ah)})();var X=T.length;var W=function(ah){var Z=ah.sourceCode,Y=ah.basePos;var ad=[Y,F];var af=0;var an=Z.match(V)||[];var aj={};for(var ae=0,aq=an.length;ae<aq;++ae){var ag=an[ae];var ap=aj[ag];var ai=void 0;var am;if(typeof ap==="string"){am=false}else{var aa=S[ag.charAt(0)];if(aa){ai=ag.match(aa[1]);ap=aa[0]}else{for(var ao=0;ao<X;++ao){aa=T[ao];ai=ag.match(aa[1]);if(ai){ap=aa[0];break}}if(!ai){ap=F}}am=ap.length>=5&&"lang-"===ap.substring(0,5);if(am&&!(ai&&typeof ai[1]==="string")){am=false;ap=J}if(!am){aj[ag]=ap}}var ab=af;af+=ag.length;if(!am){ad.push(Y+ab,ap)}else{var al=ai[1];var ak=ag.indexOf(al);var ac=ak+al.length;if(ai[2]){ac=ag.length-ai[2].length;ak=ac-al.length}var ar=ap.substring(5);B(Y+ab,ag.substring(0,ak),W,ad);B(Y+ab+ak,al,q(ar,al),ad);B(Y+ab+ac,ag.substring(ac),W,ad)}}ah.decorations=ad};return W}function i(T){var W=[],S=[];if(T.tripleQuotedStrings){W.push([C,/^(?:\'\'\'(?:[^\'\\]|\\[\s\S]|\'{1,2}(?=[^\']))*(?:\'\'\'|$)|\"\"\"(?:[^\"\\]|\\[\s\S]|\"{1,2}(?=[^\"]))*(?:\"\"\"|$)|\'(?:[^\\\']|\\[\s\S])*(?:\'|$)|\"(?:[^\\\"]|\\[\s\S])*(?:\"|$))/,null,"'\""])}else{if(T.multiLineStrings){W.push([C,/^(?:\'(?:[^\\\']|\\[\s\S])*(?:\'|$)|\"(?:[^\\\"]|\\[\s\S])*(?:\"|$)|\`(?:[^\\\`]|\\[\s\S])*(?:\`|$))/,null,"'\"`"])}else{W.push([C,/^(?:\'(?:[^\\\'\r\n]|\\.)*(?:\'|$)|\"(?:[^\\\"\r\n]|\\.)*(?:\"|$))/,null,"\"'"])}}if(T.verbatimStrings){S.push([C,/^@\"(?:[^\"]|\"\")*(?:\"|$)/,null])}var Y=T.hashComments;if(Y){if(T.cStyleComments){if(Y>1){W.push([j,/^#(?:##(?:[^#]|#(?!##))*(?:###|$)|.*)/,null,"#"])}else{W.push([j,/^#(?:(?:define|elif|else|endif|error|ifdef|include|ifndef|line|pragma|undef|warning)\b|[^\r\n]*)/,null,"#"])}S.push([C,/^<(?:(?:(?:\.\.\/)*|\/?)(?:[\w-]+(?:\/[\w-]+)+)?[\w-]+\.h|[a-z]\w*)>/,null])}else{W.push([j,/^#[^\r\n]*/,null,"#"])}}if(T.cStyleComments){S.push([j,/^\/\/[^\r\n]*/,null]);S.push([j,/^\/\*[\s\S]*?(?:\*\/|$)/,null])}if(T.regexLiterals){var X=("/(?=[^/*])(?:[^/\\x5B\\x5C]|\\x5C[\\s\\S]|\\x5B(?:[^\\x5C\\x5D]|\\x5C[\\s\\S])*(?:\\x5D|$))+/");S.push(["lang-regex",new RegExp("^"+M+"("+X+")")])}var V=T.types;if(V){S.push([O,V])}var U=(""+T.keywords).replace(/^ | $/g,"");if(U.length){S.push([z,new RegExp("^(?:"+U.replace(/[\s,]+/g,"|")+")\\b"),null])}W.push([F,/^\s+/,null," \r\n\t\xA0"]);S.push([G,/^@[a-z_$][a-z_$@0-9]*/i,null],[O,/^(?:[@_]?[A-Z]+[a-z][A-Za-z_$@0-9]*|\w+_t\b)/,null],[F,/^[a-z_$][a-z_$@0-9]*/i,null],[G,new RegExp("^(?:0x[a-f0-9]+|(?:\\d(?:_\\d+)*\\d*(?:\\.\\d*)?|\\.\\d\\+)(?:e[+\\-]?\\d+)?)[a-z]*","i"),null,"0123456789"],[F,/^\\[\s\S]?/,null],[L,/^.[^\s\w\.$@\'\"\`\/\#\\]*/,null]);return g(W,S)}var K=i({keywords:A,hashComments:true,cStyleComments:true,multiLineStrings:true,regexLiterals:true});function Q(V,ag){var U=/(?:^|\s)nocode(?:\s|$)/;var ab=/\r\n?|\n/;var ac=V.ownerDocument;var S;if(V.currentStyle){S=V.currentStyle.whiteSpace}else{if(window.getComputedStyle){S=ac.defaultView.getComputedStyle(V,null).getPropertyValue("white-space")}}var Z=S&&"pre"===S.substring(0,3);var af=ac.createElement("LI");while(V.firstChild){af.appendChild(V.firstChild)}var W=[af];function ae(al){switch(al.nodeType){case 1:if(U.test(al.className)){break}if("BR"===al.nodeName){ad(al);if(al.parentNode){al.parentNode.removeChild(al)}}else{for(var an=al.firstChild;an;an=an.nextSibling){ae(an)}}break;case 3:case 4:if(Z){var am=al.nodeValue;var aj=am.match(ab);if(aj){var ai=am.substring(0,aj.index);al.nodeValue=ai;var ah=am.substring(aj.index+aj[0].length);if(ah){var ak=al.parentNode;ak.insertBefore(ac.createTextNode(ah),al.nextSibling)}ad(al);if(!ai){al.parentNode.removeChild(al)}}}break}}function ad(ak){while(!ak.nextSibling){ak=ak.parentNode;if(!ak){return}}function ai(al,ar){var aq=ar?al.cloneNode(false):al;var ao=al.parentNode;if(ao){var ap=ai(ao,1);var an=al.nextSibling;ap.appendChild(aq);for(var am=an;am;am=an){an=am.nextSibling;ap.appendChild(am)}}return aq}var ah=ai(ak.nextSibling,0);for(var aj;(aj=ah.parentNode)&&aj.nodeType===1;){ah=aj}W.push(ah)}for(var Y=0;Y<W.length;++Y){ae(W[Y])}if(ag===(ag|0)){W[0].setAttribute("value",ag)}var aa=ac.createElement("OL");aa.className="linenums";var X=Math.max(0,((ag-1))|0)||0;for(var Y=0,T=W.length;Y<T;++Y){af=W[Y];af.className="L"+((Y+X)%10);if(!af.firstChild){af.appendChild(ac.createTextNode("\xA0"))}aa.appendChild(af)}V.appendChild(aa)}function D(ac){var aj=/\bMSIE\b/.test(navigator.userAgent);var am=/\n/g;var al=ac.sourceCode;var an=al.length;var V=0;var aa=ac.spans;var T=aa.length;var ah=0;var X=ac.decorations;var Y=X.length;var Z=0;X[Y]=an;var ar,aq;for(aq=ar=0;aq<Y;){if(X[aq]!==X[aq+2]){X[ar++]=X[aq++];X[ar++]=X[aq++]}else{aq+=2}}Y=ar;for(aq=ar=0;aq<Y;){var at=X[aq];var ab=X[aq+1];var W=aq+2;while(W+2<=Y&&X[W+1]===ab){W+=2}X[ar++]=at;X[ar++]=ab;aq=W}Y=X.length=ar;var ae=null;while(ah<T){var af=aa[ah];var S=aa[ah+2]||an;var ag=X[Z];var ap=X[Z+2]||an;var W=Math.min(S,ap);var ak=aa[ah+1];var U;if(ak.nodeType!==1&&(U=al.substring(V,W))){if(aj){U=U.replace(am,"\r")}ak.nodeValue=U;var ai=ak.ownerDocument;var ao=ai.createElement("SPAN");ao.className=X[Z+1];var ad=ak.parentNode;ad.replaceChild(ao,ak);ao.appendChild(ak);if(V<S){aa[ah+1]=ak=ai.createTextNode(al.substring(W,S));ad.insertBefore(ak,ao.nextSibling)}}V=W;if(V>=S){ah+=2}if(V>=ap){Z+=2}}}var t={};function c(U,V){for(var S=V.length;--S>=0;){var T=V[S];if(!t.hasOwnProperty(T)){t[T]=U}else{if(window.console){console.warn("cannot override language handler %s",T)}}}}function q(T,S){if(!(T&&t.hasOwnProperty(T))){T=/^\s*</.test(S)?"default-markup":"default-code"}return t[T]}c(K,["default-code"]);c(g([],[[F,/^[^<?]+/],[E,/^<!\w[^>]*(?:>|$)/],[j,/^<\!--[\s\S]*?(?:-\->|$)/],["lang-",/^<\?([\s\S]+?)(?:\?>|$)/],["lang-",/^<%([\s\S]+?)(?:%>|$)/],[L,/^(?:<[%?]|[%?]>)/],["lang-",/^<xmp\b[^>]*>([\s\S]+?)<\/xmp\b[^>]*>/i],["lang-js",/^<script\b[^>]*>([\s\S]*?)(<\/script\b[^>]*>)/i],["lang-css",/^<style\b[^>]*>([\s\S]*?)(<\/style\b[^>]*>)/i],["lang-in.tag",/^(<\/?[a-z][^<>]*>)/i]]),["default-markup","htm","html","mxml","xhtml","xml","xsl"]);c(g([[F,/^[\s]+/,null," \t\r\n"],[n,/^(?:\"[^\"]*\"?|\'[^\']*\'?)/,null,"\"'"]],[[m,/^^<\/?[a-z](?:[\w.:-]*\w)?|\/?>$/i],[P,/^(?!style[\s=]|on)[a-z](?:[\w:-]*\w)?/i],["lang-uq.val",/^=\s*([^>\'\"\s]*(?:[^>\'\"\s\/]|\/(?=\s)))/],[L,/^[=<>\/]+/],["lang-js",/^on\w+\s*=\s*\"([^\"]+)\"/i],["lang-js",/^on\w+\s*=\s*\'([^\']+)\'/i],["lang-js",/^on\w+\s*=\s*([^\"\'>\s]+)/i],["lang-css",/^style\s*=\s*\"([^\"]+)\"/i],["lang-css",/^style\s*=\s*\'([^\']+)\'/i],["lang-css",/^style\s*=\s*([^\"\'>\s]+)/i]]),["in.tag"]);c(g([],[[n,/^[\s\S]+/]]),["uq.val"]);c(i({keywords:l,hashComments:true,cStyleComments:true,types:e}),["c","cc","cpp","cxx","cyc","m"]);c(i({keywords:"null,true,false"}),["json"]);c(i({keywords:R,hashComments:true,cStyleComments:true,verbatimStrings:true,types:e}),["cs"]);c(i({keywords:x,cStyleComments:true}),["java"]);c(i({keywords:H,hashComments:true,multiLineStrings:true}),["bsh","csh","sh"]);c(i({keywords:I,hashComments:true,multiLineStrings:true,tripleQuotedStrings:true}),["cv","py"]);c(i({keywords:s,hashComments:true,multiLineStrings:true,regexLiterals:true}),["perl","pl","pm"]);c(i({keywords:f,hashComments:true,multiLineStrings:true,regexLiterals:true}),["rb"]);c(i({keywords:w,cStyleComments:true,regexLiterals:true}),["js"]);c(i({keywords:r,hashComments:3,cStyleComments:true,multilineStrings:true,tripleQuotedStrings:true,regexLiterals:true}),["coffee"]);c(g([],[[C,/^[\s\S]+/]]),["regex"]);function d(V){var U=V.langExtension;try{var S=a(V.sourceNode);var T=S.sourceCode;V.sourceCode=T;V.spans=S.spans;V.basePos=0;q(U,T)(V);D(V)}catch(W){if("console" in window){console.log(W&&W.stack?W.stack:W)}}}function y(W,V,U){var S=document.createElement("PRE");S.innerHTML=W;if(U){Q(S,U)}var T={langExtension:V,numberLines:U,sourceNode:S};d(T);return S.innerHTML}function b(ad){function Y(af){return document.getElementsByTagName(af)}var ac=[Y("pre"),Y("code"),Y("xmp")];var T=[];for(var aa=0;aa<ac.length;++aa){for(var Z=0,V=ac[aa].length;Z<V;++Z){T.push(ac[aa][Z])}}ac=null;var W=Date;if(!W.now){W={now:function(){return +(new Date)}}}var X=0;var S;var ab=/\blang(?:uage)?-([\w.]+)(?!\S)/;var ae=/\bprettyprint\b/;function U(){var ag=(window.PR_SHOULD_USE_CONTINUATION?W.now()+250:Infinity);for(;X<T.length&&W.now()<ag;X++){var aj=T[X];var ai=aj.className;if(ai.indexOf("prettyprint")>=0){var ah=ai.match(ab);var am;if(!ah&&(am=o(aj))&&"CODE"===am.tagName){ah=am.className.match(ab)}if(ah){ah=ah[1]}var al=false;for(var ak=aj.parentNode;ak;ak=ak.parentNode){if((ak.tagName==="pre"||ak.tagName==="code"||ak.tagName==="xmp")&&ak.className&&ak.className.indexOf("prettyprint")>=0){al=true;break}}if(!al){var af=aj.className.match(/\blinenums\b(?::(\d+))?/);af=af?af[1]&&af[1].length?+af[1]:true:false;if(af){Q(aj,af)}S={langExtension:ah,sourceNode:aj,numberLines:af};d(S)}}}if(X<T.length){setTimeout(U,250)}else{if(ad){ad()}}}U()}window.prettyPrintOne=y;window.prettyPrint=b;window.PR={createSimpleLexer:g,registerLangHandler:c,sourceDecorator:i,PR_ATTRIB_NAME:P,PR_ATTRIB_VALUE:n,PR_COMMENT:j,PR_DECLARATION:E,PR_KEYWORD:z,PR_LITERAL:G,PR_NOCODE:N,PR_PLAIN:F,PR_PUNCTUATION:L,PR_SOURCE:J,PR_STRING:C,PR_TAG:m,PR_TYPE:O}})();PR.registerLangHandler(PR.createSimpleLexer([],[[PR.PR_DECLARATION,/^<!\w[^>]*(?:>|$)/],[PR.PR_COMMENT,/^<\!--[\s\S]*?(?:-\->|$)/],[PR.PR_PUNCTUATION,/^(?:<[%?]|[%?]>)/],["lang-",/^<\?([\s\S]+?)(?:\?>|$)/],["lang-",/^<%([\s\S]+?)(?:%>|$)/],["lang-",/^<xmp\b[^>]*>([\s\S]+?)<\/xmp\b[^>]*>/i],["lang-handlebars",/^<script\b[^>]*type\s*=\s*['"]?text\/x-handlebars-template['"]?\b[^>]*>([\s\S]*?)(<\/script\b[^>]*>)/i],["lang-js",/^<script\b[^>]*>([\s\S]*?)(<\/script\b[^>]*>)/i],["lang-css",/^<style\b[^>]*>([\s\S]*?)(<\/style\b[^>]*>)/i],["lang-in.tag",/^(<\/?[a-z][^<>]*>)/i],[PR.PR_DECLARATION,/^{{[#^>/]?\s*[\w.][^}]*}}/],[PR.PR_DECLARATION,/^{{&?\s*[\w.][^}]*}}/],[PR.PR_DECLARATION,/^{{{>?\s*[\w.][^}]*}}}/],[PR.PR_COMMENT,/^{{![^}]*}}/]]),["handlebars","hbs"]);PR.registerLangHandler(PR.createSimpleLexer([[PR.PR_PLAIN,/^[ \t\r\n\f]+/,null," \t\r\n\f"]],[[PR.PR_STRING,/^\"(?:[^\n\r\f\\\"]|\\(?:\r\n?|\n|\f)|\\[\s\S])*\"/,null],[PR.PR_STRING,/^\'(?:[^\n\r\f\\\']|\\(?:\r\n?|\n|\f)|\\[\s\S])*\'/,null],["lang-css-str",/^url\(([^\)\"\']*)\)/i],[PR.PR_KEYWORD,/^(?:url|rgb|\!important|@import|@page|@media|@charset|inherit)(?=[^\-\w]|$)/i,null],["lang-css-kw",/^(-?(?:[_a-z]|(?:\\[0-9a-f]+ ?))(?:[_a-z0-9\-]|\\(?:\\[0-9a-f]+ ?))*)\s*:/i],[PR.PR_COMMENT,/^\/\*[^*]*\*+(?:[^\/*][^*]*\*+)*\//],[PR.PR_COMMENT,/^(?:<!--|-->)/],[PR.PR_LITERAL,/^(?:\d+|\d*\.\d+)(?:%|[a-z]+)?/i],[PR.PR_LITERAL,/^#(?:[0-9a-f]{3}){1,2}/i],[PR.PR_PLAIN,/^-?(?:[_a-z]|(?:\\[\da-f]+ ?))(?:[_a-z\d\-]|\\(?:\\[\da-f]+ ?))*/i],[PR.PR_PUNCTUATION,/^[^\s\w\'\"]+/]]),["css"]);PR.registerLangHandler(PR.createSimpleLexer([],[[PR.PR_KEYWORD,/^-?(?:[_a-z]|(?:\\[\da-f]+ ?))(?:[_a-z\d\-]|\\(?:\\[\da-f]+ ?))*/i]]),["css-kw"]);PR.registerLangHandler(PR.createSimpleLexer([],[[PR.PR_STRING,/^[^\)\"\']+/]]),["css-str"]);
3 | 


--------------------------------------------------------------------------------
/coverage/lcov-report/sanitizer.ts.html:
--------------------------------------------------------------------------------
  1 | 
  2 | <!doctype html>
  3 | <html lang="en">
  4 | 
  5 | <head>
  6 |     <title>Code coverage report for sanitizer.ts</title>
  7 |     <meta charset="utf-8" />
  8 |     <link rel="stylesheet" href="prettify.css" />
  9 |     <link rel="stylesheet" href="base.css" />
 10 |     <link rel="shortcut icon" type="image/x-icon" href="favicon.png" />
 11 |     <meta name="viewport" content="width=device-width, initial-scale=1" />
 12 |     <style type='text/css'>
 13 |         .coverage-summary .sorter {
 14 |             background-image: url(sort-arrow-sprite.png);
 15 |         }
 16 |     </style>
 17 | </head>
 18 |     
 19 | <body>
 20 | <div class='wrapper'>
 21 |     <div class='pad1'>
 22 |         <h1><a href="index.html">All files</a> sanitizer.ts</h1>
 23 |         <div class='clearfix'>
 24 |             
 25 |             <div class='fl pad1y space-right2'>
 26 |                 <span class="strong">0% </span>
 27 |                 <span class="quiet">Statements</span>
 28 |                 <span class='fraction'>0/4</span>
 29 |             </div>
 30 |         
 31 |             
 32 |             <div class='fl pad1y space-right2'>
 33 |                 <span class="strong">100% </span>
 34 |                 <span class="quiet">Branches</span>
 35 |                 <span class='fraction'>0/0</span>
 36 |             </div>
 37 |         
 38 |             
 39 |             <div class='fl pad1y space-right2'>
 40 |                 <span class="strong">0% </span>
 41 |                 <span class="quiet">Functions</span>
 42 |                 <span class='fraction'>0/1</span>
 43 |             </div>
 44 |         
 45 |             
 46 |             <div class='fl pad1y space-right2'>
 47 |                 <span class="strong">0% </span>
 48 |                 <span class="quiet">Lines</span>
 49 |                 <span class='fraction'>0/4</span>
 50 |             </div>
 51 |         
 52 |             
 53 |         </div>
 54 |         <p class="quiet">
 55 |             Press <em>n</em> or <em>j</em> to go to the next uncovered block, <em>b</em>, <em>p</em> or <em>k</em> for the previous block.
 56 |         </p>
 57 |         <template id="filterTemplate">
 58 |             <div class="quiet">
 59 |                 Filter:
 60 |                 <input type="search" id="fileSearch">
 61 |             </div>
 62 |         </template>
 63 |     </div>
 64 |     <div class='status-line low'></div>
 65 |     <pre><table class="coverage">
 66 | <tr><td class="line-count quiet"><a name='L1'></a><a href='#L1'>1</a>
 67 | <a name='L2'></a><a href='#L2'>2</a>
 68 | <a name='L3'></a><a href='#L3'>3</a>
 69 | <a name='L4'></a><a href='#L4'>4</a>
 70 | <a name='L5'></a><a href='#L5'>5</a>
 71 | <a name='L6'></a><a href='#L6'>6</a>
 72 | <a name='L7'></a><a href='#L7'>7</a>
 73 | <a name='L8'></a><a href='#L8'>8</a>
 74 | <a name='L9'></a><a href='#L9'>9</a>
 75 | <a name='L10'></a><a href='#L10'>10</a>
 76 | <a name='L11'></a><a href='#L11'>11</a>
 77 | <a name='L12'></a><a href='#L12'>12</a>
 78 | <a name='L13'></a><a href='#L13'>13</a></td><td class="line-coverage quiet"><span class="cline-any cline-neutral">&nbsp;</span>
 79 | <span class="cline-any cline-neutral">&nbsp;</span>
 80 | <span class="cline-any cline-neutral">&nbsp;</span>
 81 | <span class="cline-any cline-neutral">&nbsp;</span>
 82 | <span class="cline-any cline-neutral">&nbsp;</span>
 83 | <span class="cline-any cline-neutral">&nbsp;</span>
 84 | <span class="cline-any cline-neutral">&nbsp;</span>
 85 | <span class="cline-any cline-no">&nbsp;</span>
 86 | <span class="cline-any cline-no">&nbsp;</span>
 87 | <span class="cline-any cline-no">&nbsp;</span>
 88 | <span class="cline-any cline-no">&nbsp;</span>
 89 | <span class="cline-any cline-neutral">&nbsp;</span>
 90 | <span class="cline-any cline-neutral">&nbsp;</span></td><td class="text"><pre class="prettyprint lang-js">// src/utils/sanitizer.ts
 91 | &nbsp;
 92 | /**
 93 |  * Sanitizes an input string by escaping HTML.
 94 |  * @param input - The raw string that may contain HTML.
 95 |  * @returns A safe HTML string.
 96 |  */
 97 | <span class="cstat-no" title="statement not covered" >export function <span class="fstat-no" title="function not covered" >s</span>anitize(</span>input: string): string {
 98 |   const element = <span class="cstat-no" title="statement not covered" >document.createElement('div');</span>
 99 | <span class="cstat-no" title="statement not covered" >  element.innerText = input;</span>
100 | <span class="cstat-no" title="statement not covered" >  return element.innerHTML;</span>
101 | }
102 | &nbsp;</pre></td></tr></table></pre>
103 | 
104 |                 <div class='push'></div><!-- for sticky footer -->
105 |             </div><!-- /wrapper -->
106 |             <div class='footer quiet pad2 space-top1 center small'>
107 |                 Code coverage generated by
108 |                 <a href="https://istanbul.js.org/" target="_blank" rel="noopener noreferrer">istanbul</a>
109 |                 at 2025-02-03T04:50:57.328Z
110 |             </div>
111 |         <script src="prettify.js"></script>
112 |         <script>
113 |             window.onload = function () {
114 |                 prettyPrint();
115 |             };
116 |         </script>
117 |         <script src="sorter.js"></script>
118 |         <script src="block-navigation.js"></script>
119 |     </body>
120 | </html>
121 |     


--------------------------------------------------------------------------------
/coverage/lcov-report/sort-arrow-sprite.png:
--------------------------------------------------------------------------------
https://raw.githubusercontent.com/TheSethRose/list-bridge/main/coverage/lcov-report/sort-arrow-sprite.png


--------------------------------------------------------------------------------
/coverage/lcov-report/sorter.js:
--------------------------------------------------------------------------------
  1 | /* eslint-disable */
  2 | var addSorting = (function() {
  3 |     'use strict';
  4 |     var cols,
  5 |         currentSort = {
  6 |             index: 0,
  7 |             desc: false
  8 |         };
  9 | 
 10 |     // returns the summary table element
 11 |     function getTable() {
 12 |         return document.querySelector('.coverage-summary');
 13 |     }
 14 |     // returns the thead element of the summary table
 15 |     function getTableHeader() {
 16 |         return getTable().querySelector('thead tr');
 17 |     }
 18 |     // returns the tbody element of the summary table
 19 |     function getTableBody() {
 20 |         return getTable().querySelector('tbody');
 21 |     }
 22 |     // returns the th element for nth column
 23 |     function getNthColumn(n) {
 24 |         return getTableHeader().querySelectorAll('th')[n];
 25 |     }
 26 | 
 27 |     function onFilterInput() {
 28 |         const searchValue = document.getElementById('fileSearch').value;
 29 |         const rows = document.getElementsByTagName('tbody')[0].children;
 30 |         for (let i = 0; i < rows.length; i++) {
 31 |             const row = rows[i];
 32 |             if (
 33 |                 row.textContent
 34 |                     .toLowerCase()
 35 |                     .includes(searchValue.toLowerCase())
 36 |             ) {
 37 |                 row.style.display = '';
 38 |             } else {
 39 |                 row.style.display = 'none';
 40 |             }
 41 |         }
 42 |     }
 43 | 
 44 |     // loads the search box
 45 |     function addSearchBox() {
 46 |         var template = document.getElementById('filterTemplate');
 47 |         var templateClone = template.content.cloneNode(true);
 48 |         templateClone.getElementById('fileSearch').oninput = onFilterInput;
 49 |         template.parentElement.appendChild(templateClone);
 50 |     }
 51 | 
 52 |     // loads all columns
 53 |     function loadColumns() {
 54 |         var colNodes = getTableHeader().querySelectorAll('th'),
 55 |             colNode,
 56 |             cols = [],
 57 |             col,
 58 |             i;
 59 | 
 60 |         for (i = 0; i < colNodes.length; i += 1) {
 61 |             colNode = colNodes[i];
 62 |             col = {
 63 |                 key: colNode.getAttribute('data-col'),
 64 |                 sortable: !colNode.getAttribute('data-nosort'),
 65 |                 type: colNode.getAttribute('data-type') || 'string'
 66 |             };
 67 |             cols.push(col);
 68 |             if (col.sortable) {
 69 |                 col.defaultDescSort = col.type === 'number';
 70 |                 colNode.innerHTML =
 71 |                     colNode.innerHTML + '<span class="sorter"></span>';
 72 |             }
 73 |         }
 74 |         return cols;
 75 |     }
 76 |     // attaches a data attribute to every tr element with an object
 77 |     // of data values keyed by column name
 78 |     function loadRowData(tableRow) {
 79 |         var tableCols = tableRow.querySelectorAll('td'),
 80 |             colNode,
 81 |             col,
 82 |             data = {},
 83 |             i,
 84 |             val;
 85 |         for (i = 0; i < tableCols.length; i += 1) {
 86 |             colNode = tableCols[i];
 87 |             col = cols[i];
 88 |             val = colNode.getAttribute('data-value');
 89 |             if (col.type === 'number') {
 90 |                 val = Number(val);
 91 |             }
 92 |             data[col.key] = val;
 93 |         }
 94 |         return data;
 95 |     }
 96 |     // loads all row data
 97 |     function loadData() {
 98 |         var rows = getTableBody().querySelectorAll('tr'),
 99 |             i;
100 | 
101 |         for (i = 0; i < rows.length; i += 1) {
102 |             rows[i].data = loadRowData(rows[i]);
103 |         }
104 |     }
105 |     // sorts the table using the data for the ith column
106 |     function sortByIndex(index, desc) {
107 |         var key = cols[index].key,
108 |             sorter = function(a, b) {
109 |                 a = a.data[key];
110 |                 b = b.data[key];
111 |                 return a < b ? -1 : a > b ? 1 : 0;
112 |             },
113 |             finalSorter = sorter,
114 |             tableBody = document.querySelector('.coverage-summary tbody'),
115 |             rowNodes = tableBody.querySelectorAll('tr'),
116 |             rows = [],
117 |             i;
118 | 
119 |         if (desc) {
120 |             finalSorter = function(a, b) {
121 |                 return -1 * sorter(a, b);
122 |             };
123 |         }
124 | 
125 |         for (i = 0; i < rowNodes.length; i += 1) {
126 |             rows.push(rowNodes[i]);
127 |             tableBody.removeChild(rowNodes[i]);
128 |         }
129 | 
130 |         rows.sort(finalSorter);
131 | 
132 |         for (i = 0; i < rows.length; i += 1) {
133 |             tableBody.appendChild(rows[i]);
134 |         }
135 |     }
136 |     // removes sort indicators for current column being sorted
137 |     function removeSortIndicators() {
138 |         var col = getNthColumn(currentSort.index),
139 |             cls = col.className;
140 | 
141 |         cls = cls.replace(/ sorted$/, '').replace(/ sorted-desc$/, '');
142 |         col.className = cls;
143 |     }
144 |     // adds sort indicators for current column being sorted
145 |     function addSortIndicators() {
146 |         getNthColumn(currentSort.index).className += currentSort.desc
147 |             ? ' sorted-desc'
148 |             : ' sorted';
149 |     }
150 |     // adds event listeners for all sorter widgets
151 |     function enableUI() {
152 |         var i,
153 |             el,
154 |             ithSorter = function ithSorter(i) {
155 |                 var col = cols[i];
156 | 
157 |                 return function() {
158 |                     var desc = col.defaultDescSort;
159 | 
160 |                     if (currentSort.index === i) {
161 |                         desc = !currentSort.desc;
162 |                     }
163 |                     sortByIndex(i, desc);
164 |                     removeSortIndicators();
165 |                     currentSort.index = i;
166 |                     currentSort.desc = desc;
167 |                     addSortIndicators();
168 |                 };
169 |             };
170 |         for (i = 0; i < cols.length; i += 1) {
171 |             if (cols[i].sortable) {
172 |                 // add the click event handler on the th so users
173 |                 // dont have to click on those tiny arrows
174 |                 el = getNthColumn(i).querySelector('.sorter').parentElement;
175 |                 if (el.addEventListener) {
176 |                     el.addEventListener('click', ithSorter(i));
177 |                 } else {
178 |                     el.attachEvent('onclick', ithSorter(i));
179 |                 }
180 |             }
181 |         }
182 |     }
183 |     // adds sorting functionality to the UI
184 |     return function() {
185 |         if (!getTable()) {
186 |             return;
187 |         }
188 |         cols = loadColumns();
189 |         loadData();
190 |         addSearchBox();
191 |         addSortIndicators();
192 |         enableUI();
193 |     };
194 | })();
195 | 
196 | window.addEventListener('load', addSorting);
197 | 


--------------------------------------------------------------------------------
/coverage/lcov.info:
--------------------------------------------------------------------------------
 1 | TN:
 2 | SF:src/utils/feedback.ts
 3 | FN:2,(anonymous_0)
 4 | FN:36,(anonymous_1)
 5 | FN:40,(anonymous_2)
 6 | FN:42,(anonymous_3)
 7 | FNF:4
 8 | FNH:0
 9 | FNDA:0,(anonymous_0)
10 | FNDA:0,(anonymous_1)
11 | FNDA:0,(anonymous_2)
12 | FNDA:0,(anonymous_3)
13 | DA:2,0
14 | DA:7,0
15 | DA:8,0
16 | DA:9,0
17 | DA:10,0
18 | DA:11,0
19 | DA:12,0
20 | DA:14,0
21 | DA:18,0
22 | DA:19,0
23 | DA:20,0
24 | DA:21,0
25 | DA:22,0
26 | DA:23,0
27 | DA:24,0
28 | DA:25,0
29 | DA:26,0
30 | DA:27,0
31 | DA:28,0
32 | DA:29,0
33 | DA:32,0
34 | DA:33,0
35 | DA:36,0
36 | DA:37,0
37 | DA:40,0
38 | DA:41,0
39 | DA:42,0
40 | LF:27
41 | LH:0
42 | BRDA:4,0,0,0
43 | BRDA:11,1,0,0
44 | BRDA:11,1,1,0
45 | BRDA:18,2,0,0
46 | BRDA:18,2,1,0
47 | BRDA:19,3,0,0
48 | BRDA:19,3,1,0
49 | BRDA:26,4,0,0
50 | BRF:8
51 | BRH:0
52 | end_of_record
53 | TN:
54 | SF:src/utils/sanitizer.ts
55 | FN:8,sanitize
56 | FNF:1
57 | FNH:0
58 | FNDA:0,sanitize
59 | DA:8,0
60 | DA:9,0
61 | DA:10,0
62 | DA:11,0
63 | LF:4
64 | LH:0
65 | BRF:0
66 | BRH:0
67 | end_of_record
68 | 


--------------------------------------------------------------------------------
/documentation/PRD.md:
--------------------------------------------------------------------------------
 1 | # Product Requirements Document (PRD)
 2 | 
 3 | ## Title
 4 | List Bridge ‚Äì Chrome Extension for Bridging Shopping Lists (Manifest V3)
 5 | 
 6 | ## Overview
 7 | List Bridge is a Chrome extension that enables users to seamlessly view and manage their shopping lists from Amazon Alexa (and other platforms) directly in the browser. The extension features a modern, dark-themed interface, real-time (or auto) refresh functionality, and supports actions such as copying and exporting list data. It also provides settings to configure auto-refresh intervals and the display of completed items.
 8 | 
 9 | ## Target Users
10 | - Users who maintain shopping lists via Amazon Alexa and desire an in‚Äëbrowser, consolidated view.
11 | - Individuals who want quick access to list management features (refresh, copy, export).
12 | - Users who appreciate a modern, responsive UI with customization options.
13 | 
14 | ## User Stories
15 | 1. List Viewing:
16 |    As a user, I want to view my Alexa shopping list items in Chrome so that I can quickly review my pending and completed items.
17 | 
18 | 2. Categorization:
19 |    As a user, I want the items to be categorized (e.g. incomplete vs. complete) so that I can focus on pending tasks.
20 | 
21 | 3. Manual and Auto-Refresh:
22 |    As a user, I want the list to refresh automatically based on a configurable interval, or manually on demand.
23 | 
24 | 4. Copy and Export:
25 |    As a user, I want to copy my list items to the clipboard and export them to a text file for sharing or offline use.
26 | 
27 | 5. Settings Management:
28 |    As a user, I want an options page where I can configure display preferences (for example, whether to show completed items) and set the refresh interval.
29 | 
30 | 6. Error Handling and Authentication:
31 |    As a user, I want clear error messages and redirection to the login page in case my session expires or network issues occur.
32 | 
33 | ## Features
34 | - List Display:
35 |   - Two-column layout separating incomplete and complete items.
36 |   - Dynamic item count display for each category.
37 | 
38 | - Quick Actions:
39 |   - Manual refresh button with visual feedback.
40 |   - Copy button to copy list items to the clipboard.
41 |   - Export button to download the list as a text file.
42 | 
43 | - Settings Management:
44 |   - Options page for configuring auto-refresh intervals and toggling the display of completed items.
45 | 
46 | - Authentication Handling:
47 |   - Detection of authentication failures with automatic redirection to the login page.
48 | 
49 | - Error Handling:
50 |   - Friendly error messages for network or data processing issues.
51 | 
52 | ## Success Criteria
53 | - Functionality:
54 |   - Users can view and interact with their list items immediately upon opening the extension popup
55 |   - All primary actions (refresh, copy, export, update, delete, add) execute without errors
56 |   - Maximum of 5 concurrent API calls with debouncing during rapid interactions
57 | 
58 | - User Satisfaction:
59 |   - A responsive and intuitive UI with smooth transitions and clear feedback
60 |   - Configurations persist securely using `chrome.storage.sync`
61 |   - Strict Content Security Policy implementation
62 |   - Minimal permission requests with clear user consent
63 | 
64 | - Performance:
65 |   - Popup launch time under 500ms
66 |   - First Contentful Paint under 1 second
67 |   - Options page size under 100KB
68 |   - Virtualized lists for optimal performance with large datasets
69 |   - All API calls debounced during rapid interactions
70 | 
71 | - Security & Privacy:
72 |   - Strict Content Security Policy (CSP) implementation
73 |   - Sanitized DOM interactions
74 |   - Secure data storage using `chrome.storage.sync`
75 |   - Minimal permission requirements
76 |   - Clear privacy disclosures
77 | 
78 | - Accessibility:
79 |   - Full keyboard navigation support
80 |   - ARIA roles and labels implementation
81 |   - High contrast color schemes
82 |   - Screen reader compatibility
83 | 
84 | - Chrome Web Store Requirements:
85 |   - Square icons in all required sizes
86 |   - Clear and concise store listing
87 |   - Compliance with Chrome Web Store policies
88 |   - Documentation of all data collection practices
89 | 
90 | ## Future Enhancements
91 | - Allow in‚Äëpopup editing and marking of items as complete/incomplete.
92 | - Enable deletion and reordering of list items.
93 | - Expand support to integrate with other shopping list providers.
94 | - Implement offline mode support.
95 | 


--------------------------------------------------------------------------------
/documentation/README.md:
--------------------------------------------------------------------------------
 1 | # List Bridge
 2 | 
 3 | <img src="public/images/icon.svg" width="128" height="128" alt="List Bridge Logo">
 4 | 
 5 | ## Overview
 6 | List Bridge is a Chrome extension (Manifest V3) that bridges your shopping lists across platforms‚Äîespecially from Amazon Alexa. The extension allows you to view, refresh, copy, and export your shopping list items. With a clean, dark-themed interface and customizable settings, managing your list is simple and efficient.
 7 | 
 8 | ## Features
 9 | - List Display:
10 |   - Two-column layout displaying incomplete and complete items
11 |   - Item counts for each category
12 |   - Virtualized list rendering for optimal performance
13 | - Actions:
14 |   - Auto/Manual Refresh: Update list items (debounced, max 5 concurrent API calls)
15 |   - Copy to Clipboard: Quickly copy list items
16 |   - Export List: Download your list as a text file
17 | - Settings:
18 |   - Configure refresh intervals
19 |   - Toggle visibility of completed items
20 |   - All settings stored securely using `chrome.storage.sync`
21 | - Security & Privacy:
22 |   - Strict Content Security Policy implementation
23 |   - Minimal permission requirements
24 |   - Secure data handling with user consent
25 |   - Sanitized DOM interactions
26 | - Performance:
27 |   - Popup launch time < 500ms
28 |   - First Contentful Paint < 1s
29 |   - Options page < 100KB
30 |   - Optimized for memory usage
31 | 
32 | ## Installation & Setup
33 | 1. Clone the Repository:
34 |    ```bash
35 |    git clone https://github.com/yourusername/shopping-list-extension.git
36 |    cd shopping-list-extension
37 |    ```
38 | 2. Install Dependencies:
39 |    ```bash
40 |    npm install
41 |    ```
42 | 3. Build the Extension:
43 |    ```bash
44 |    npm run build
45 |    ```
46 | 4. Load in Chrome:
47 |    - Open Chrome and navigate to `chrome://extensions`
48 |    - Enable Developer Mode
49 |    - Click Load unpacked and select the `dist` directory
50 | 
51 | ## Development
52 | - Live Build:
53 |   Use the watch script for live development:
54 |   ```bash
55 |   npm run dev
56 |   ```
57 | - Testing:
58 |   Run Jest tests with TypeScript support:
59 |   ```bash
60 |   npm run test
61 |   ```
62 | - Code Quality:
63 |   - ESLint with TypeScript and Chrome extension rules
64 |   - Prettier formatting with TypeScript support
65 |   - Strong TypeScript type checking (`strict: true`)
66 |   - No use of `any` type unless absolutely necessary
67 | - Folder Structure:
68 |   - src/public: Contains HTML files and static assets
69 |   - src/: TypeScript source code
70 |   - src/types/: TypeScript type definitions and interfaces
71 |   - webpack/: Webpack configuration with TypeScript (entry points maintained)
72 |   - __tests__/: Jest test files with `.test.ts` extension
73 | 
74 | ## TypeScript Development Guidelines
75 | - Use strict TypeScript configuration
76 | - Define interfaces for all data structures
77 | - Utilize type guards for runtime type checking
78 | - Leverage TypeScript's built-in utility types
79 | - Maintain type safety across async operations
80 | - Document complex types with TSDoc comments
81 | - Use enums for fixed sets of values
82 | - Avoid type assertions unless necessary
83 | 
84 | ## Accessibility
85 | - Full keyboard navigation support
86 | - ARIA roles and labels
87 | - High contrast color scheme
88 | - Screen reader compatibility
89 | 
90 | ## Chrome Web Store Compliance
91 | - Follows Chrome Web Store program policies
92 | - Clear privacy disclosures
93 | - Minimal permission requests
94 | - Square icons in required sizes
95 | - Comprehensive store listing
96 | 
97 | For more information, refer to [Chrome Web Store Best Practices](https://developer.chrome.com/docs/webstore/best-practices)
98 | 


--------------------------------------------------------------------------------
/documentation/ROADMAP.md:
--------------------------------------------------------------------------------
 1 | # Development Roadmap
 2 | 
 3 | ## Timeline and Milestones
 4 | 
 5 | | Milestone                | Target Date           | Description                                                               |
 6 | |--------------------------|-----------------------|---------------------------------------------------------------------------|
 7 | | Project Kickoff      | Week 1                | Finalize requirements, set up project repository, and establish initial design. |
 8 | | Alpha Release        | End of Week 3         | Implement basic functionality: list fetching, UI display, manual refresh, and basic settings persistence. |
 9 | | Beta Release         | End of Week 6         | Add copy/export features, complete error handling, and refine UI/UX.       |
10 | | Public Release       | End of Week 9         | Finalize full feature set; optimize performance; complete documentation; publish to Chrome Web Store. |
11 | 
12 | ## Feature Development Plan
13 | 
14 | 1. Phase 1: Core Functionality (Manifest V3)
15 |    - Set up Webpack build system with proper entry points
16 |    - Implement strict Content Security Policy (CSP)
17 |    - Configure Chrome Storage sync for secure data persistence
18 |    - Build initial popup UI with performance targets:
19 |      - Launch time < 500ms
20 |      - First Contentful Paint < 1s
21 |    - Implement list virtualization for performance
22 | 
23 | 2. Phase 2: Enhanced Interactions
24 |    - Add quick actions with debounced API calls (max 5 concurrent)
25 |    - Implement robust error handling for all async operations
26 |    - Add accessibility features (ARIA roles, keyboard navigation)
27 |    - Optimize options page size (target < 100KB)
28 | 
29 | 3. Phase 3: Security & Compliance
30 |    - Implement strict CSP headers
31 |    - Add DOM sanitization
32 |    - Configure minimal permissions
33 |    - Prepare Chrome Web Store assets:
34 |      - Square icons in all sizes
35 |      - Privacy policy
36 |      - Data collection documentation
37 | 
38 | ## Dependencies & Technical Requirements
39 | 
40 | - Build System:
41 |   - Webpack with TypeScript configuration
42 |   - TypeScript in strict mode
43 |   - ESLint with TypeScript and Chrome extension rules
44 |   - Prettier with TypeScript support
45 | 
46 | - Testing:
47 |   - Jest with TypeScript support
48 |   - Typed test fixtures and mocks
49 |   - Type-safe test coverage requirements
50 |   - All new features require TypeScript test cases (`.test.ts`)
51 | 
52 | - Code Quality:
53 |   - TypeScript modules and namespaces
54 |   - Comprehensive type definitions in `src/types`
55 |   - No use of `any` type unless absolutely necessary
56 |   - Type guards for runtime type checking
57 |   - TSDoc comments for complex types
58 |   - Strict type safety across async operations
59 |   - Use of TypeScript utility types
60 |   - Enums for fixed sets of values
61 |   - Minimal type assertions
62 |   - No inline event handlers
63 |   - Modular utility functions with proper typing
64 |   - Error handling in all async operations with typed errors
65 | 
66 | ## Release Planning
67 | - Testing Requirements:
68 |   - TypeScript compilation must succeed with no errors
69 |   - Jest tests must pass with type checking
70 |   - Performance metrics validation:
71 |     - Popup launch time
72 |     - First Contentful Paint
73 |     - Options page size
74 |   - Accessibility compliance
75 |   - Security audit
76 | 
77 | - Deployment:
78 |   - Use CI/CD pipeline for:
79 |     - TypeScript compilation
80 |     - Building with Webpack
81 |     - Running Jest tests with type checking
82 |     - ESLint with TypeScript rules
83 |     - Prettier formatting
84 |     - Creating deployment artifacts
85 |   - Chrome Web Store submission checklist
86 | 


--------------------------------------------------------------------------------
/documentation/SRS.md:
--------------------------------------------------------------------------------
  1 | # Software Requirements Specification (SRS)
  2 | 
  3 | ## 1. Introduction
  4 | 
  5 | ### 1.1 Purpose
  6 | This document defines the technical and functional specifications for the List Bridge Chrome extension. It outlines the system architecture, external integrations, and detailed requirements that ensure proper implementation and maintainability.
  7 | 
  8 | ### 1.2 Scope
  9 | The project is a Manifest V3 Chrome extension that fetches shopping list data (primarily from Amazon Alexa) and displays it in a user-friendly popup. The extension includes an options page for configuring settings and uses a build system (webpack) to compile assets and scripts.
 10 | 
 11 | ### 1.3 Intended Audience
 12 | - Developers: For building, maintaining, and extending the extension.
 13 | - Testers: For validating functionality, performance, and error handling.
 14 | - Stakeholders: To understand feature requirements and implementation details.
 15 | 
 16 | ## 2. System Architecture Overview
 17 | 
 18 | - Frontend Components:
 19 |   - Popup UI: Display list items and provide controls (refresh, add, copy, export).
 20 |   - Options Page: Allow users to update settings (refresh interval, toggle completed items).
 21 | 
 22 | - Background/Service Scripts:
 23 |   - Build & Icon Generation: Scripts such as `build.js` and `generate-icons.js` compile assets and generate required images.
 24 |   - API Calls: The popup script (`js/popup.js`) handles fetching data from Amazon endpoints and updating items.
 25 | 
 26 | - Storage:
 27 |   - Chrome Storage (sync): Persists user settings such as refresh interval and display preferences.
 28 | 
 29 | - External Integrations:
 30 |   - Amazon Shopping List API: Endpoints for fetching, updating, deleting, and adding shopping list items.
 31 |   - Login Redirect: Redirects to Amazon‚Äôs login page on authentication failures.
 32 | 
 33 | ## 3. Functional Requirements
 34 | 
 35 | ### 3.1 List Management
 36 | - Fetching Data:
 37 |   - The extension must retrieve list data from a defined API endpoint.
 38 |   - Data is parsed and categorized as ‚Äúincomplete‚Äù or ‚Äúcomplete.‚Äù
 39 | 
 40 | - Display:
 41 |   - Render list items in a two-column layout with item counts.
 42 |   - Provide a clear UI for editing, deleting, or adding new items.
 43 | 
 44 | - Copy & Export:
 45 |   - Provide buttons to copy list items to the clipboard and to export the list to a text file.
 46 | 
 47 | ### 3.2 Settings
 48 | - Options Page:
 49 |   - Users can toggle whether completed items are shown.
 50 |   - Users can select an auto-refresh interval (ranging from ‚ÄúEvery time‚Äù to ‚ÄúManual only‚Äù).
 51 | 
 52 | - Persistence:
 53 |   - Settings are stored using Chrome Storage and applied across sessions.
 54 | 
 55 | ### 3.3 Error and Authentication Handling
 56 | - Error Messaging:
 57 |   - Display errors in the UI when network or data issues occur.
 58 | - Authentication:
 59 |   - On receiving an authentication failure from the API, open the Amazon login page in a new tab.
 60 | 
 61 | ## 4. Non-Functional Requirements
 62 | 
 63 | ### 4.1 Performance
 64 | - Popup Performance:
 65 |   - Launch time must be under 500ms
 66 |   - First Contentful Paint (FCP) must be under 1 second
 67 |   - Maximum of 5 concurrent API calls
 68 |   - API calls must be debounced during rapid interactions
 69 | - Resource Usage:
 70 |   - Options page size must be under 100KB
 71 |   - Implement virtualization for long lists
 72 |   - Keep `popup.js` under 500 lines of code
 73 | 
 74 | ### 4.2 Security
 75 | - Content Security Policy:
 76 |   - Implement strict CSP as defined in manifest
 77 |   - No inline event handlers in HTML
 78 | - Data Protection:
 79 |   - Store sensitive data using `chrome.storage.sync`
 80 |   - Sanitize all DOM interactions
 81 |   - Request only minimal permissions necessary
 82 |   - Validate all stored values before use
 83 | - Privacy:
 84 |   - Clear disclosure of data collection practices
 85 |   - Obtain user consent for data collection
 86 |   - Document privacy practices in store listing
 87 | 
 88 | ### 4.3 Accessibility
 89 | - Keyboard Navigation:
 90 |   - Full support for keyboard interactions
 91 |   - Proper focus management
 92 | - Screen Readers:
 93 |   - Implement ARIA roles and labels
 94 |   - Provide text alternatives for visual elements
 95 | - Visual Design:
 96 |   - High contrast color schemes
 97 |   - Clear visual feedback for interactions
 98 | 
 99 | ### 4.4 Development Standards
100 | - Build System:
101 |   - Use Webpack exclusively as the build system with TypeScript configuration
102 |   - Maintain existing Webpack entry points with `.ts` extensions
103 |   - Follow modular code organization with TypeScript namespaces and modules
104 | - Code Quality:
105 |   - Use TypeScript with strict mode enabled
106 |   - Maintain comprehensive type definitions in `src/types`
107 |   - Apply ESLint with TypeScript and Chrome extension rules
108 |   - Use Prettier with TypeScript-specific configuration
109 |   - Implement IIFE patterns with TypeScript modules
110 |   - No inline event handlers
111 |   - No use of `any` type unless absolutely necessary
112 |   - Utilize TypeScript's built-in utility types
113 |   - Document complex types with TSDoc comments
114 |   - Use type guards for runtime type checking
115 |   - Maintain type safety across async operations
116 |   - Use enums for fixed sets of values
117 |   - Avoid type assertions unless necessary
118 | - Testing:
119 |   - Use Jest with TypeScript support
120 |   - Write test cases in TypeScript (`.test.ts` files)
121 |   - Maintain comprehensive test coverage with type checking
122 |   - Use typed test fixtures and mocks
123 | 
124 | ### 4.5 Chrome Web Store Requirements
125 | - Assets:
126 |   - Square icons in all required sizes
127 |   - Clear and concise store listing
128 |   - Complete documentation
129 | - Compliance:
130 |   - Follow Chrome Web Store policies
131 |   - Document all permissions
132 |   - Provide privacy policy
133 |   - Clear data collection practices
134 | 
135 | ## 5. Technology Stack
136 | - Frontend: HTML, CSS, TypeScript with strict mode
137 | - Type System: TypeScript with comprehensive type definitions
138 | - Build System: Node.js, webpack with TypeScript configuration
139 | - Testing: Jest with TypeScript support
140 | - Image Processing: Sharp (used in `generate-icons.ts`)
141 | 


--------------------------------------------------------------------------------
/documentation/TECHNICAL-DETAILS.md:
--------------------------------------------------------------------------------
  1 | # Technical Documentation
  2 | 
  3 | This document provides a comprehensive technical overview of the List Bridge Chrome extension. It covers the architecture, implementation details, and best practices used throughout the codebase. This documentation is intended for developers who need to understand, maintain, or extend the extension's functionality.
  4 | 
  5 | ## Table of Contents
  6 | 1. [Chrome Extension Architecture](#chrome-extension-architecture)
  7 | 2. [Storage Implementation](#storage-implementation)
  8 | 3. [API Integration](#api-integration)
  9 | 4. [Security Implementation](#security-implementation)
 10 | 5. [Performance Optimizations](#performance-optimizations)
 11 | 6. [Build System](#build-system)
 12 | 7. [Type System](#type-system)
 13 | 8. [Testing Framework](#testing-framework)
 14 | 
 15 | ## Chrome Extension Architecture
 16 | 
 17 | List Bridge is built on Chrome's Manifest V3 architecture, which provides enhanced security, privacy, and performance compared to previous versions. The extension uses a service worker-based background script and follows modern Chrome extension development practices.
 18 | 
 19 | ### Manifest V3 Structure
 20 | The manifest.json file defines the extension's core configuration, permissions, and capabilities. We maintain a minimal permission set to ensure user privacy and security:
 21 | ```json
 22 | {
 23 |   "manifest_version": 3,
 24 |   "name": "List Bridge",
 25 |   "version": "1.0.0",
 26 |   "permissions": [
 27 |     "storage",
 28 |     "clipboardWrite"
 29 |   ],
 30 |   "host_permissions": [
 31 |     "https://*.amazon.com/*"
 32 |   ]
 33 | }
 34 | ```
 35 | 
 36 | ### Component Organization
 37 | - `popup/`: Contains popup UI components
 38 | - `background/`: Service worker scripts
 39 | - `options/`: Settings page implementation
 40 | - `types/`: TypeScript type definitions
 41 | - `utils/`: Shared utility functions
 42 | 
 43 | ## Storage Implementation
 44 | 
 45 | List Bridge uses Chrome's Storage Sync API to persist user settings and cache list data across devices. This implementation ensures that user preferences and cached data are automatically synchronized across all instances of Chrome where the user is signed in.
 46 | 
 47 | ### Chrome Storage Sync
 48 | We implement a strongly-typed storage system using TypeScript to ensure type safety and prevent runtime errors. The storage schema is defined as follows:
 49 | 
 50 | ```typescript
 51 | interface StorageSchema {
 52 |   settings: {
 53 |     refreshInterval: number;
 54 |     showCompleted: boolean;
 55 |     theme: 'light' | 'dark';
 56 |   };
 57 |   cache: {
 58 |     lastRefresh: number;
 59 |     items: ListItem[];
 60 |   };
 61 | }
 62 | 
 63 | // Storage Operations
 64 | const storage = {
 65 |   async get<K extends keyof StorageSchema>(key: K): Promise<StorageSchema[K]> {
 66 |     const result = await chrome.storage.sync.get(key);
 67 |     return result[key];
 68 |   },
 69 | 
 70 |   async set<K extends keyof StorageSchema>(
 71 |     key: K,
 72 |     value: StorageSchema[K]
 73 |   ): Promise<void> {
 74 |     await chrome.storage.sync.set({ [key]: value });
 75 |   }
 76 | };
 77 | ```
 78 | 
 79 | ### Storage Best Practices
 80 | - Use TypeScript interfaces for type-safe storage operations
 81 | - Implement error handling for storage quota limits
 82 | - Cache frequently accessed data
 83 | - Clear outdated cache entries
 84 | - Handle storage change events
 85 | 
 86 | ## API Integration
 87 | 
 88 | The extension integrates with Amazon's List API to fetch, update, and manage shopping list items. Our implementation includes sophisticated rate limiting and error handling to ensure reliable operation even under heavy usage.
 89 | 
 90 | ### Amazon List API
 91 | The API integration is built around a clean TypeScript interface that abstracts the underlying HTTP calls. We implement rate limiting to prevent API abuse and maintain good service citizenship:
 92 | ```typescript
 93 | interface ListAPI {
 94 |   fetchItems(): Promise<ListItem[]>;
 95 |   updateItem(id: string, updates: ItemUpdates): Promise<void>;
 96 |   deleteItem(id: string): Promise<void>;
 97 |   addItem(item: NewItem): Promise<ListItem>;
 98 | }
 99 | 
100 | // API Rate Limiting
101 | const rateLimiter = new RateLimiter({
102 |   maxCalls: 5,
103 |   perWindow: 1000, // milliseconds
104 | });
105 | 
106 | // Debounced API Calls
107 | const debouncedFetch = debounce(async () => {
108 |   await rateLimiter.acquire();
109 |   return api.fetchItems();
110 | }, 300);
111 | ```
112 | 
113 | ### Error Handling
114 | ```typescript
115 | class APIError extends Error {
116 |   constructor(
117 |     message: string,
118 |     public statusCode: number,
119 |     public retryable: boolean
120 |   ) {
121 |     super(message);
122 |   }
123 | }
124 | 
125 | async function handleAPIError(error: unknown): Promise<void> {
126 |   if (error instanceof APIError) {
127 |     if (error.statusCode === 401) {
128 |       await redirectToLogin();
129 |     } else if (error.retryable) {
130 |       await retryWithBackoff(error);
131 |     }
132 |   }
133 |   throw error;
134 | }
135 | ```
136 | 
137 | ## Security Implementation
138 | 
139 | Security is a top priority in List Bridge. We implement multiple layers of protection including Content Security Policy (CSP), input sanitization, and secure storage practices to protect user data and prevent common web vulnerabilities.
140 | 
141 | ### Content Security Policy
142 | Our CSP implementation follows security best practices by restricting resource loading and script execution:
143 | ```json
144 | {
145 |   "content_security_policy": {
146 |     "default-src": ["'self'"],
147 |     "connect-src": ["https://*.amazon.com"],
148 |     "img-src": ["'self'", "data:"],
149 |     "style-src": ["'self'"]
150 |   }
151 | }
152 | ```
153 | 
154 | ### DOM Sanitization
155 | ```typescript
156 | function sanitizeHTML(input: string): string {
157 |   const div = document.createElement('div');
158 |   div.textContent = input;
159 |   return div.innerHTML;
160 | }
161 | 
162 | function createSafeElement(
163 |   tag: string,
164 |   attributes: Record<string, string>,
165 |   content: string
166 | ): HTMLElement {
167 |   const element = document.createElement(tag);
168 |   Object.entries(attributes).forEach(([key, value]) => {
169 |     if (ALLOWED_ATTRIBUTES.includes(key)) {
170 |       element.setAttribute(key, value);
171 |     }
172 |   });
173 |   element.textContent = content;
174 |   return element;
175 | }
176 | ```
177 | 
178 | ## Performance Optimizations
179 | 
180 | List Bridge employs several performance optimization techniques to ensure a smooth user experience, even with large shopping lists. Key optimizations include list virtualization, efficient DOM updates, and strategic data caching.
181 | 
182 | ### List Virtualization
183 | To handle large lists efficiently, we implement a virtual scrolling system that only renders items currently visible in the viewport:
184 | ```typescript
185 | interface VirtualListConfig {
186 |   itemHeight: number;
187 |   containerHeight: number;
188 |   overscan: number;
189 | }
190 | 
191 | class VirtualList {
192 |   private visibleItems: ListItem[] = [];
193 | 
194 |   constructor(private config: VirtualListConfig) {}
195 | 
196 |   updateVisibleItems(
197 |     scrollTop: number,
198 |     items: ListItem[]
199 |   ): void {
200 |     const startIndex = Math.floor(scrollTop / this.config.itemHeight);
201 |     const visibleCount = Math.ceil(this.config.containerHeight / this.config.itemHeight);
202 |     const endIndex = startIndex + visibleCount + this.config.overscan;
203 | 
204 |     this.visibleItems = items.slice(startIndex, endIndex);
205 |   }
206 | }
207 | ```
208 | 
209 | ### Performance Monitoring
210 | ```typescript
211 | interface PerformanceMetrics {
212 |   popupLaunchTime: number;
213 |   firstContentfulPaint: number;
214 |   timeToInteractive: number;
215 | }
216 | 
217 | const performanceMonitor = {
218 |   start(): void {
219 |     performance.mark('popup-start');
220 |   },
221 | 
222 |   end(): PerformanceMetrics {
223 |     performance.mark('popup-end');
224 |     const measure = performance.measure(
225 |       'popup-total',
226 |       'popup-start',
227 |       'popup-end'
228 |     );
229 | 
230 |     return {
231 |       popupLaunchTime: measure.duration,
232 |       firstContentfulPaint: getFCP(),
233 |       timeToInteractive: getTTI()
234 |     };
235 |   }
236 | };
237 | ```
238 | 
239 | ## Build System
240 | 
241 | The build system is configured to optimize bundle size, enable TypeScript compilation, and ensure consistent code quality. We use Webpack as our primary bundler, configured to produce efficient production builds while maintaining a good development experience.
242 | 
243 | ### Webpack Configuration
244 | Our Webpack configuration is optimized for Chrome extension development:
245 | ```typescript
246 | // webpack.config.ts
247 | import { Configuration } from 'webpack';
248 | 
249 | const config: Configuration = {
250 |   entry: {
251 |     popup: './src/popup/index.tsx',
252 |     background: './src/background/index.ts',
253 |     options: './src/options/index.tsx'
254 |   },
255 |   module: {
256 |     rules: [
257 |       {
258 |         test: /\.tsx?$/,
259 |         use: 'ts-loader',
260 |         exclude: /node_modules/
261 |       }
262 |     ]
263 |   },
264 |   optimization: {
265 |     splitChunks: {
266 |       chunks: 'all',
267 |       maxSize: 100000 // 100KB limit
268 |     }
269 |   }
270 | };
271 | ```
272 | 
273 | ## Type System
274 | 
275 | List Bridge leverages TypeScript's type system extensively to ensure code reliability and maintainability. We use a combination of interfaces, type guards, and utility types to create a robust type-safe codebase.
276 | 
277 | ### Core Types
278 | The core domain types define the shape of our data structures and ensure consistency across the application:
279 | ```typescript
280 | interface ListItem {
281 |   id: string;
282 |   name: string;
283 |   completed: boolean;
284 |   createdAt: string;
285 |   updatedAt: string;
286 | }
287 | 
288 | type ItemUpdates = Partial<Pick<ListItem, 'name' | 'completed'>>;
289 | 
290 | interface NewItem {
291 |   name: string;
292 |   completed?: boolean;
293 | }
294 | 
295 | // Type Guards
296 | function isListItem(item: unknown): item is ListItem {
297 |   return (
298 |     typeof item === 'object' &&
299 |     item !== null &&
300 |     'id' in item &&
301 |     'name' in item &&
302 |     'completed' in item
303 |   );
304 | }
305 | ```
306 | 
307 | ### Utility Types
308 | ```typescript
309 | type AsyncFunction<T> = () => Promise<T>;
310 | 
311 | type DeepReadonly<T> = {
312 |   readonly [P in keyof T]: T[P] extends object
313 |     ? DeepReadonly<T[P]>
314 |     : T[P];
315 | };
316 | 
317 | type StorageKey = keyof StorageSchema;
318 | ```
319 | 
320 | ## Testing Framework
321 | 
322 | We maintain a comprehensive test suite using Jest and React Testing Library. Our testing strategy includes unit tests, integration tests, and end-to-end tests to ensure reliability and catch regressions early in the development cycle.
323 | 
324 | ### Jest Configuration
325 | Our Jest setup is configured to handle TypeScript, DOM testing, and Chrome extension APIs:
326 | ```typescript
327 | // jest.config.ts
328 | import type { Config } from '@jest/types';
329 | 
330 | const config: Config.InitialOptions = {
331 |   preset: 'ts-jest',
332 |   testEnvironment: 'jsdom',
333 |   setupFilesAfterEnv: ['<rootDir>/src/test/setup.ts'],
334 |   moduleNameMapper: {
335 |     '^@/(.*)$': '<rootDir>/src/$1'
336 |   },
337 |   collectCoverageFrom: [
338 |     'src/**/*.{ts,tsx}',
339 |     '!src/test/**/*'
340 |   ]
341 | };
342 | 
343 | export default config;
344 | ```
345 | 
346 | ### Test Utilities
347 | ```typescript
348 | // test/utils.ts
349 | export function createMockStorage(): typeof chrome.storage.sync {
350 |   const store = new Map<string, any>();
351 | 
352 |   return {
353 |     get: jest.fn((key) => Promise.resolve({ [key]: store.get(key) })),
354 |     set: jest.fn((items) => {
355 |       Object.entries(items).forEach(([key, value]) => {
356 |         store.set(key, value);
357 |       });
358 |       return Promise.resolve();
359 |     }),
360 |     remove: jest.fn((key) => {
361 |       store.delete(key);
362 |       return Promise.resolve();
363 |     }),
364 |     clear: jest.fn(() => {
365 |       store.clear();
366 |       return Promise.resolve();
367 |     })
368 |   };
369 | }
370 | 
371 | export function createMockAPI(): ListAPI {
372 |   return {
373 |     fetchItems: jest.fn(),
374 |     updateItem: jest.fn(),
375 |     deleteItem: jest.fn(),
376 |     addItem: jest.fn()
377 |   };
378 | }
379 | ```
380 | 
381 | ### Example Test Suite
382 | ```typescript
383 | describe('ListManager', () => {
384 |   let storage: ReturnType<typeof createMockStorage>;
385 |   let api: ReturnType<typeof createMockAPI>;
386 |   let manager: ListManager;
387 | 
388 |   beforeEach(() => {
389 |     storage = createMockStorage();
390 |     api = createMockAPI();
391 |     manager = new ListManager(storage, api);
392 |   });
393 | 
394 |   it('should fetch and cache items', async () => {
395 |     const items: ListItem[] = [
396 |       {
397 |         id: '1',
398 |         name: 'Test Item',
399 |         completed: false,
400 |         createdAt: new Date().toISOString(),
401 |         updatedAt: new Date().toISOString()
402 |       }
403 |     ];
404 | 
405 |     api.fetchItems.mockResolvedValueOnce(items);
406 | 
407 |     await manager.refresh();
408 | 
409 |     expect(storage.set).toHaveBeenCalledWith('cache', {
410 |       lastRefresh: expect.any(Number),
411 |       items
412 |     });
413 |   });
414 | });
415 | ```
416 | 


--------------------------------------------------------------------------------
/global.d.ts:
--------------------------------------------------------------------------------
 1 | // global.d.ts
 2 | 
 3 | // Chrome Extension Types
 4 | declare namespace Chrome {
 5 |   interface StorageChange {
 6 |     newValue?: any;
 7 |     oldValue?: any;
 8 |   }
 9 | 
10 |   interface StorageChanges {
11 |     [key: string]: StorageChange;
12 |   }
13 | }
14 | 
15 | // Window Interface Extensions
16 | interface Window {
17 |   refreshInterval?: number;
18 |   isExtensionPopup?: boolean;
19 |   __REDUX_DEVTOOLS_EXTENSION__?: any;
20 | }
21 | 
22 | // Custom Event Types
23 | interface CustomEvents {
24 |   'list:refresh': CustomEvent<void>;
25 |   'list:updated': CustomEvent<{ items: Array<any> }>;
26 |   'settings:changed': CustomEvent<{ key: string; value: any }>;
27 | }
28 | 
29 | // Extend DOM interfaces
30 | declare global {
31 |   interface Document {
32 |     addEventListener<K extends keyof CustomEvents>(
33 |       type: K,
34 |       listener: (ev: CustomEvents[K]) => void
35 |     ): void;
36 |     removeEventListener<K extends keyof CustomEvents>(
37 |       type: K,
38 |       listener: (ev: CustomEvents[K]) => void
39 |     ): void;
40 |   }
41 | 
42 |   interface HTMLElement {
43 |     addEventListener<K extends keyof CustomEvents>(
44 |       type: K,
45 |       listener: (ev: CustomEvents[K]) => void
46 |     ): void;
47 |     removeEventListener<K extends keyof CustomEvents>(
48 |       type: K,
49 |       listener: (ev: CustomEvents[K]) => void
50 |     ): void;
51 |   }
52 | }
53 | 
54 | // Utility Types
55 | type DeepPartial<T> = {
56 |   [P in keyof T]?: T[P] extends object ? DeepPartial<T[P]> : T[P];
57 | };
58 | 
59 | type AsyncReturnType<T extends (...args: any) => Promise<any>> =
60 |   T extends (...args: any) => Promise<infer R> ? R : any;
61 | 
62 | // Prevent TypeScript from complaining about module exports
63 | export {};
64 | 


--------------------------------------------------------------------------------
/jest.config.ts:
--------------------------------------------------------------------------------
 1 | // jest.config.ts
 2 | import type { Config } from '@jest/types';
 3 | 
 4 | const config: Config.InitialOptions = {
 5 |   preset: 'ts-jest',
 6 |   testEnvironment: 'jsdom',
 7 |   setupFilesAfterEnv: ['<rootDir>/jest.setup.ts'],
 8 |   
 9 |   // Look for tests inside the "src" directory
10 |   roots: ['<rootDir>/src'],
11 | 
12 |   // Transform TypeScript files using ts-jest
13 |   transform: {
14 |     '^.+\\.tsx?$': ['ts-jest', {
15 |       tsconfig: 'tsconfig.test.json',
16 |       diagnostics: false
17 |     }]
18 |   },
19 | 
20 |   // Use this regex pattern to locate test files
21 |   testRegex: '(/__tests__/.*|(\\.|/)(test|spec))\\.tsx?$',
22 | 
23 |   // Recognize these file extensions
24 |   moduleFileExtensions: ['ts', 'tsx', 'js', 'jsx', 'json', 'node'],
25 | 
26 |   // Mock static assets
27 |   moduleNameMapper: {
28 |     '\\.(css|less|sass|scss)$': '<rootDir>/__mocks__/styleMock.js',
29 |     '\\.(gif|ttf|eot|svg)$': '<rootDir>/__mocks__/fileMock.js',
30 |     '^@/(.*)$': '<rootDir>/src/$1'
31 |   },
32 | 
33 |   // Test environment variables
34 |   testEnvironmentOptions: {
35 |     url: 'http://localhost'
36 |   },
37 | 
38 |   // Automatically clear mock calls and instances between every test
39 |   clearMocks: true,
40 | 
41 |   // Disable coverage for now to focus on getting tests working
42 |   collectCoverage: false
43 | };
44 | 
45 | export default config;
46 | 


--------------------------------------------------------------------------------
/jest.setup.ts:
--------------------------------------------------------------------------------
 1 | // jest.setup.ts
 2 | import '@testing-library/jest-dom';
 3 | import { chrome } from 'jest-chrome';
 4 | 
 5 | // Setup fetch mock as a global
 6 | const globalAny: any = global;
 7 | globalAny.fetch = jest.fn(() =>
 8 |   Promise.resolve({
 9 |     json: () => Promise.resolve({}),
10 |     ok: true,
11 |     status: 200,
12 |     statusText: 'OK',
13 |     headers: new Headers(),
14 |   } as Response)
15 | ) as jest.Mock;
16 | 
17 | // Setup chrome API mock
18 | Object.assign(global, { chrome });
19 | 
20 | // Mock chrome.storage.sync
21 | chrome.storage = {
22 |   ...chrome.storage,
23 |   sync: {
24 |     get: jest.fn((keys: string | string[] | object | null, callback?: (items: { [key: string]: any }) => void) => {
25 |       if (callback) callback({});
26 |       return Promise.resolve({});
27 |     }),
28 |     set: jest.fn((items: object, callback?: () => void) => {
29 |       if (callback) callback();
30 |       return Promise.resolve();
31 |     }),
32 |     remove: jest.fn(),
33 |     clear: jest.fn(),
34 |   },
35 | } as any;
36 | 
37 | // Mock chrome.runtime
38 | chrome.runtime = {
39 |   ...chrome.runtime,
40 |   getURL: jest.fn((path: string) => `chrome-extension://fake-id/${path}`),
41 |   sendMessage: jest.fn(),
42 |   onMessage: {
43 |     addListener: jest.fn(),
44 |     removeListener: jest.fn(),
45 |   },
46 | } as any;
47 | 
48 | // Setup performance mock if not available
49 | if (!globalAny.performance) {
50 |   Object.defineProperty(globalAny, 'performance', {
51 |     value: {
52 |       now: jest.fn(() => Date.now()),
53 |       mark: jest.fn(),
54 |       measure: jest.fn(),
55 |     },
56 |     writable: true,
57 |     configurable: true,
58 |   });
59 | }
60 | 
61 | // Mock console methods
62 | globalAny.console.error = jest.fn();
63 | globalAny.console.warn = jest.fn();
64 | 
65 | // Use fake timers for testing asynchronous behavior
66 | jest.useFakeTimers();
67 | 
68 | // Mock the clipboard API with proper types
69 | Object.defineProperty(navigator, 'clipboard', {
70 |   value: {
71 |     writeText: jest.fn((text: string) => Promise.resolve()),
72 |     readText: jest.fn(() => Promise.resolve('')),
73 |   },
74 |   configurable: true,
75 | });
76 | 
77 | // Add custom matchers if needed
78 | expect.extend({
79 |   // Add your custom matchers here
80 | });
81 | 


--------------------------------------------------------------------------------
/package.json:
--------------------------------------------------------------------------------
 1 | {
 2 |   "name": "list-bridge",
 3 |   "version": "1.0.0",
 4 |   "description": "",
 5 |   "type": "module",
 6 |   "scripts": {
 7 |     "build": "node --loader ts-node/esm build.ts",
 8 |     "dev": "node --loader ts-node/esm build.ts dev",
 9 |     "format": "prettier --write \"src/**/*.{ts,tsx}\"",
10 |     "lint": "eslint \"src/**/*.{ts,tsx}\"",
11 |     "lint:fix": "eslint \"src/**/*.{ts,tsx}\" --fix",
12 |     "test": "jest --config jest.config.ts",
13 |     "test:watch": "jest --watch --config jest.config.ts",
14 |     "type-check": "tsc --noEmit",
15 |     "type-check:watch": "tsc --noEmit --watch",
16 |     "generate-icons": "node --loader ts-node/esm scripts/generate-icons.ts",
17 |     "generate-tree": "node --loader ts-node/esm scripts/generate-tree.ts",
18 |     "clean": "node --loader ts-node/esm build.ts clean"
19 |   },
20 |   "author": "",
21 |   "license": "MIT",
22 |   "dependencies": {
23 |     "@tailwindcss/cli": "^4.0.3",
24 |     "@types/react": "^19.0.8",
25 |     "@types/react-dom": "^19.0.3",
26 |     "chalk": "^5.4.1",
27 |     "chrome-types": "^0.1.246",
28 |     "dompurify": "^3.2.4",
29 |     "html-webpack-plugin": "^5.6.3",
30 |     "ignore": "^7.0.3",
31 |     "react": "^19.0.0",
32 |     "react-dom": "^19.0.0",
33 |     "require": "^2.4.20"
34 |   },
35 |   "devDependencies": {
36 |     "@babel/preset-env": "^7.26.7",
37 |     "@babel/preset-typescript": "^7.26.0",
38 |     "@eslint/js": "^9.19.0",
39 |     "@tailwindcss/vite": "^4.0.3",
40 |     "@testing-library/dom": "^10.4.0",
41 |     "@testing-library/jest-dom": "^6.6.3",
42 |     "@testing-library/react": "^16.2.0",
43 |     "@testing-library/user-event": "^14.6.1",
44 |     "@types/chrome": "^0.0.254",
45 |     "@types/fs-extra": "^11.0.4",
46 |     "@types/glob": "^8.1.0",
47 |     "@types/jest": "^29.5.14",
48 |     "@types/tailwindcss": "^3.0.11",
49 |     "@types/testing-library__jest-dom": "^5.14.9",
50 |     "@types/webpack": "^5.28.5",
51 |     "@typescript-eslint/eslint-plugin": "^6.21.0",
52 |     "@typescript-eslint/parser": "^6.21.0",
53 |     "autoprefixer": "^10.4.20",
54 |     "babel-jest": "^29.7.0",
55 |     "copy-webpack-plugin": "^11.0.0",
56 |     "css-loader": "^6.11.0",
57 |     "eslint": "^8.57.1",
58 |     "eslint-config-prettier": "^9.1.0",
59 |     "eslint-plugin-prettier": "^5.0.1",
60 |     "eslint-plugin-react": "^7.37.4",
61 |     "eslint-plugin-react-hooks": "^5.1.0",
62 |     "fs-extra": "^11.2.0",
63 |     "jest": "^29.7.0",
64 |     "jest-chrome": "^0.8.0",
65 |     "jest-environment-jsdom": "^29.7.0",
66 |     "mini-css-extract-plugin": "^2.9.2",
67 |     "postcss": "^8.5.1",
68 |     "postcss-import": "^16.1.0",
69 |     "postcss-loader": "^8.1.1",
70 |     "prettier": "^3.1.1",
71 |     "rimraf": "^6.0.1",
72 |     "sharp": "^0.33.1",
73 |     "style-loader": "^3.3.4",
74 |     "tailwindcss": "^4.0.3",
75 |     "ts-jest": "^29.2.5",
76 |     "ts-loader": "^9.5.1",
77 |     "ts-node": "^10.9.2",
78 |     "typescript": "^5.7.3",
79 |     "webpack": "^5.89.0",
80 |     "webpack-cli": "^5.1.4",
81 |     "webpack-merge": "^5.10.0"
82 |   }
83 | }
84 | 


--------------------------------------------------------------------------------
/postcss.config.ts:
--------------------------------------------------------------------------------
1 | export default {
2 |   plugins: {
3 |     tailwindcss: {},
4 |     autoprefixer: {},
5 |   },
6 | };
7 | 


--------------------------------------------------------------------------------
/prettier.config.ts:
--------------------------------------------------------------------------------
 1 | // prettier.config.ts
 2 | import type { Config } from 'prettier';
 3 | 
 4 | const config: Config = {
 5 |   semi: true,
 6 |   trailingComma: 'es5',
 7 |   singleQuote: true,
 8 |   printWidth: 80,
 9 |   tabWidth: 2,
10 |   useTabs: false,
11 |   endOfLine: 'lf',
12 |   arrowParens: 'avoid',
13 |   bracketSpacing: true,
14 |   // TypeScript-specific settings
15 |   parser: 'typescript',
16 |   importOrder: ['^@/(.*)$', '^[./]'],
17 |   importOrderSeparation: true,
18 |   importOrderSortSpecifiers: true
19 | };
20 | 
21 | export default config;
22 | 


--------------------------------------------------------------------------------
/scripts/generate-icons.ts:
--------------------------------------------------------------------------------
 1 | // generate-icons.ts
 2 | import sharp from 'sharp';
 3 | import fs from 'fs';
 4 | import path from 'path';
 5 | import { fileURLToPath } from 'url';
 6 | 
 7 | // Get the current file path and project root directory
 8 | const currentFilePath = fileURLToPath(import.meta.url);
 9 | const currentDir = path.dirname(currentFilePath);
10 | const projectRoot = path.resolve(currentDir, '..');
11 | 
12 | const sizes = [16, 32, 48, 128];
13 | const inputSvg = path.join(projectRoot, 'src', 'public', 'images', 'icon.svg');
14 | // You may adjust the output directory if needed.
15 | const outputDir = path.join(projectRoot, 'src', 'public', 'images');
16 | 
17 | async function generateIcons(): Promise<void> {
18 |   // Ensure the output directory exists.
19 |   if (!fs.existsSync(outputDir)) {
20 |     fs.mkdirSync(outputDir, { recursive: true });
21 |   }
22 | 
23 |   // Generate PNG files for each size.
24 |   for (const size of sizes) {
25 |     const outputFile = path.join(outputDir, `icon-${size}.png`);
26 |     await sharp(inputSvg)
27 |       .resize(size, size, {
28 |         fit: 'contain',
29 |         background: { r: 255, g: 255, b: 255, alpha: 1 },
30 |       })
31 |       .png()
32 |       .toFile(outputFile);
33 |     console.log(`Generated ${outputFile}`);
34 |   }
35 | }
36 | 
37 | generateIcons().catch((error) => {
38 |   console.error('Error generating icons:', error);
39 | });
40 | 


--------------------------------------------------------------------------------
/scripts/generate-tree.js:
--------------------------------------------------------------------------------
  1 | #!/usr/bin/env node
  2 | // @ts-check
  3 | /**
  4 |  * This script walks the project directory (starting from the current directory),
  5 |  * ignores any files/directories matching the patterns in .gitignore, and builds
  6 |  * a tree representation of all files and directories. For each file that is determined
  7 |  * to be a text file, it outputs the file's contents with line numbers.
  8 |  * The entire output is written to "output.txt".
  9 |  */
 10 | import * as fs from 'fs';
 11 | import { createRequire } from 'module';
 12 | import path from 'path';
 13 | const require = createRequire(import.meta.url);
 14 | const ignore = require('ignore');
 15 | import { fileURLToPath } from 'url';
 16 | // Get the current file path and project root directory
 17 | const currentFilePath = fileURLToPath(import.meta.url);
 18 | const currentDir = path.dirname(currentFilePath);
 19 | const projectRoot = path.resolve(currentDir, '..');
 20 | // Load .gitignore and compile ignore rules
 21 | const ig = ignore();
 22 | const gitignorePath = path.join(projectRoot, '.gitignore');
 23 | if (fs.existsSync(gitignorePath)) {
 24 |     const gitignoreContent = fs.readFileSync(gitignorePath, 'utf8');
 25 |     ig.add(gitignoreContent.split(/\r?\n/));
 26 | }
 27 | // Also ignore this script and its output file
 28 | const scriptFile = path.basename(currentFilePath);
 29 | ig.add([scriptFile, 'output.txt']);
 30 | /**
 31 |  * Check whether a given relative file/directory path should be ignored
 32 |  * according to the .gitignore rules (and our extra ignores).
 33 |  */
 34 | function isIgnored(relPath) {
 35 |     return ig.ignores(relPath);
 36 | }
 37 | /**
 38 |  * Heuristically determine if a file is text.
 39 |  * Reads the first 512 bytes and returns false if any null byte is found.
 40 |  */
 41 | function isTextFile(filePath) {
 42 |     try {
 43 |         const fd = fs.openSync(filePath, 'r');
 44 |         const buffer = Buffer.alloc(512);
 45 |         const bytesRead = fs.readSync(fd, buffer, 0, 512, 0);
 46 |         fs.closeSync(fd);
 47 |         for (let i = 0; i < bytesRead; i++) {
 48 |             if (buffer[i] === 0)
 49 |                 return false;
 50 |         }
 51 |         return true;
 52 |     }
 53 |     catch (err) {
 54 |         return false;
 55 |     }
 56 | }
 57 | const treeLines = [];
 58 | const textFiles = [];
 59 | /**
 60 |  * Recursively traverse the directory tree, building the tree diagram and recording
 61 |  * text file paths.
 62 |  */
 63 | function generateTree(currentDir, prefix = '') {
 64 |     let entries;
 65 |     try {
 66 |         entries = fs.readdirSync(currentDir).sort();
 67 |     }
 68 |     catch (err) {
 69 |         return;
 70 |     }
 71 |     // Filter out entries ignored by .gitignore (and our manual ignores) using the path relative to the project root.
 72 |     entries = entries.filter(entry => {
 73 |         const relEntryPath = path.relative(projectRoot, path.join(currentDir, entry));
 74 |         return !isIgnored(relEntryPath);
 75 |     });
 76 |     const entriesCount = entries.length;
 77 |     entries.forEach((entry, index) => {
 78 |         const fullPath = path.join(currentDir, entry);
 79 |         const relPath = path.relative(projectRoot, fullPath);
 80 |         const connector = (index === entriesCount - 1) ? '‚îî‚îÄ‚îÄ ' : '‚îú‚îÄ‚îÄ ';
 81 |         treeLines.push(prefix + connector + entry);
 82 |         // Process directories recursively
 83 |         if (fs.statSync(fullPath).isDirectory()) {
 84 |             const extension = (index === entriesCount - 1) ? '    ' : '‚îÇ   ';
 85 |             generateTree(fullPath, prefix + extension);
 86 |         }
 87 |         else {
 88 |             // Record the file if it can be read as text.
 89 |             if (isTextFile(fullPath)) {
 90 |                 textFiles.push(relPath);
 91 |             }
 92 |         }
 93 |     });
 94 | }
 95 | function main() {
 96 |     // Start building the tree from the project root
 97 |     generateTree(projectRoot);
 98 |     // Define the output file path
 99 |     const outputFile = path.join(projectRoot, 'output.txt');
100 |     let output = 'Project Directory Tree:\n';
101 |     output += treeLines.join('\n') + '\n\n';
102 |     // Append file contents for each text file with line numbers
103 |     textFiles.forEach(filePath => {
104 |         output += filePath + ':\n';
105 |         output += '-'.repeat(80) + '\n';
106 |         try {
107 |             const content = fs.readFileSync(path.join(projectRoot, filePath), 'utf8');
108 |             const lines = content.split(/\r?\n/);
109 |             lines.forEach((line, idx) => {
110 |                 // Line numbers are right aligned in a width of 3 characters.
111 |                 output += `${(idx + 1).toString().padStart(3, ' ')} | ${line}\n`;
112 |             });
113 |         }
114 |         catch (err) {
115 |             if (err instanceof Error) {
116 |                 output += `Error reading file: ${err.message}\n`;
117 |             }
118 |             else {
119 |                 output += `Error reading file: Unknown error\n`;
120 |             }
121 |         }
122 |         output += '-'.repeat(80) + '\n\n';
123 |     });
124 |     // Write the output to the file
125 |     fs.writeFileSync(outputFile, output, 'utf8');
126 |     console.log(`Directory tree and file contents have been written to '${outputFile}'.`);
127 | }
128 | main();
129 | 


--------------------------------------------------------------------------------
/scripts/generate-tree.ts:
--------------------------------------------------------------------------------
  1 | #!/usr/bin/env node
  2 | // @ts-check
  3 | /**
  4 |  * This script walks the project directory (starting from the current directory),
  5 |  * ignores any files/directories matching the patterns in .gitignore, and builds
  6 |  * a tree representation of all files and directories. For each file that is determined
  7 |  * to be a text file, it outputs the file's contents with line numbers.
  8 |  * The entire output is written to "output.txt".
  9 |  */
 10 | 
 11 | import * as fs from 'fs';
 12 | import { createRequire } from 'module';
 13 | import path from 'path';
 14 | const require = createRequire(import.meta.url);
 15 | const ignore = require('ignore');
 16 | import { fileURLToPath } from 'url';
 17 | 
 18 | // Get the current file path and project root directory
 19 | const currentFilePath = fileURLToPath(import.meta.url);
 20 | const currentDir = path.dirname(currentFilePath);
 21 | const projectRoot = path.resolve(currentDir, '..');
 22 | 
 23 | // Load .gitignore and compile ignore rules
 24 | const ig = ignore();
 25 | const gitignorePath = path.join(projectRoot, '.gitignore');
 26 | if (fs.existsSync(gitignorePath)) {
 27 |   const gitignoreContent = fs.readFileSync(gitignorePath, 'utf8');
 28 |   ig.add(gitignoreContent.split(/\r?\n/));
 29 | }
 30 | 
 31 | // Also ignore this script and its output file
 32 | const scriptFile = path.basename(currentFilePath);
 33 | ig.add([scriptFile, 'output.txt']);
 34 | 
 35 | /**
 36 |  * Check whether a given relative file/directory path should be ignored
 37 |  * according to the .gitignore rules (and our extra ignores).
 38 |  */
 39 | function isIgnored(relPath: string): boolean {
 40 |   return ig.ignores(relPath);
 41 | }
 42 | 
 43 | /**
 44 |  * Heuristically determine if a file is text.
 45 |  * Reads the first 512 bytes and returns false if any null byte is found.
 46 |  */
 47 | function isTextFile(filePath: string): boolean {
 48 |   try {
 49 |     const fd = fs.openSync(filePath, 'r');
 50 |     const buffer = Buffer.alloc(512);
 51 |     const bytesRead = fs.readSync(fd, buffer, 0, 512, 0);
 52 |     fs.closeSync(fd);
 53 |     for (let i = 0; i < bytesRead; i++) {
 54 |       if (buffer[i] === 0) return false;
 55 |     }
 56 |     return true;
 57 |   } catch (err) {
 58 |     return false;
 59 |   }
 60 | }
 61 | 
 62 | const treeLines: string[] = [];
 63 | const textFiles: string[] = [];
 64 | 
 65 | /**
 66 |  * Recursively traverse the directory tree, building the tree diagram and recording
 67 |  * text file paths.
 68 |  */
 69 | function generateTree(currentDir: string, prefix = ''): void {
 70 |   let entries: string[];
 71 |   try {
 72 |     entries = fs.readdirSync(currentDir).sort();
 73 |   } catch (err) {
 74 |     return;
 75 |   }
 76 | 
 77 |   // Filter out entries ignored by .gitignore (and our manual ignores) using the path relative to the project root.
 78 |   entries = entries.filter(entry => {
 79 |     const relEntryPath = path.relative(projectRoot, path.join(currentDir, entry));
 80 |     return !isIgnored(relEntryPath);
 81 |   });
 82 | 
 83 |   const entriesCount = entries.length;
 84 |   entries.forEach((entry, index) => {
 85 |     const fullPath = path.join(currentDir, entry);
 86 |     const relPath = path.relative(projectRoot, fullPath);
 87 |     const connector = (index === entriesCount - 1) ? '‚îî‚îÄ‚îÄ ' : '‚îú‚îÄ‚îÄ ';
 88 |     treeLines.push(prefix + connector + entry);
 89 | 
 90 |     // Process directories recursively
 91 |     if (fs.statSync(fullPath).isDirectory()) {
 92 |       const extension = (index === entriesCount - 1) ? '    ' : '‚îÇ   ';
 93 |       generateTree(fullPath, prefix + extension);
 94 |     } else {
 95 |       // Record the file if it can be read as text.
 96 |       if (isTextFile(fullPath)) {
 97 |         textFiles.push(relPath);
 98 |       }
 99 |     }
100 |   });
101 | }
102 | 
103 | function main(): void {
104 |   // Start building the tree from the project root
105 |   generateTree(projectRoot);
106 | 
107 |   // Define the output file path
108 |   const outputFile = path.join(projectRoot, 'output.txt');
109 |   let output = 'Project Directory Tree:\n';
110 |   output += treeLines.join('\n') + '\n\n';
111 | 
112 |   // Append file contents for each text file with line numbers
113 |   textFiles.forEach(filePath => {
114 |     output += filePath + ':\n';
115 |     output += '-'.repeat(80) + '\n';
116 |     try {
117 |       const content = fs.readFileSync(path.join(projectRoot, filePath), 'utf8');
118 |       const lines = content.split(/\r?\n/);
119 |       lines.forEach((line, idx) => {
120 |         // Line numbers are right aligned in a width of 3 characters.
121 |         output += `${(idx + 1).toString().padStart(3, ' ')} | ${line}\n`;
122 |       });
123 |     } catch (err) {
124 |       if (err instanceof Error) {
125 |         output += `Error reading file: ${err.message}\n`;
126 |       } else {
127 |         output += `Error reading file: Unknown error\n`;
128 |       }
129 |     }
130 |     output += '-'.repeat(80) + '\n\n';
131 |   });
132 | 
133 |   // Write the output to the file
134 |   fs.writeFileSync(outputFile, output, 'utf8');
135 |   console.log(`Directory tree and file contents have been written to '${outputFile}'.`);
136 | }
137 | 
138 | main();
139 | 


--------------------------------------------------------------------------------
/src/__tests__/popup.test.tsx:
--------------------------------------------------------------------------------
  1 | // __tests__/popup.test.tsx
  2 | import React from "react";
  3 | import { render, screen, waitFor, within } from "@testing-library/react";
  4 | import "@testing-library/jest-dom";
  5 | import Popup from "../popup";
  6 | 
  7 | // Mock chrome.storage.sync
  8 | const mockChromeStorage = {
  9 |   get: jest.fn(),
 10 |   set: jest.fn(),
 11 | };
 12 | 
 13 | // Mock fetch
 14 | global.fetch = jest.fn();
 15 | 
 16 | describe("Popup Component", () => {
 17 |   beforeEach(() => {
 18 |     // Reset all mocks before each test
 19 |     jest.clearAllMocks();
 20 | 
 21 |     // Setup chrome storage mock
 22 |     mockChromeStorage.get.mockImplementation(() => {
 23 |       return Promise.resolve({
 24 |         refreshInterval: "5",
 25 |         showCompleted: false,
 26 |       });
 27 |     });
 28 | 
 29 |     // Setup fetch mock
 30 |     (global.fetch as jest.Mock).mockImplementation(() =>
 31 |       Promise.resolve({
 32 |         ok: true,
 33 |         json: () =>
 34 |           Promise.resolve({
 35 |             items: [
 36 |               { id: "1", value: "Test Item 1", completed: false },
 37 |               { id: "2", value: "Test Item 2", completed: true },
 38 |             ],
 39 |           }),
 40 |       }),
 41 |     );
 42 | 
 43 |     // Assign mocks to chrome object
 44 |     (global as any).chrome = {
 45 |       storage: {
 46 |         sync: mockChromeStorage,
 47 |       },
 48 |       runtime: {
 49 |         onMessage: {
 50 |           addListener: jest.fn(),
 51 |           removeListener: jest.fn(),
 52 |         },
 53 |       },
 54 |     };
 55 |   });
 56 | 
 57 |   it("renders without crashing and shows the header text", () => {
 58 |     render(<Popup />);
 59 |     expect(screen.getByText("List Bridge")).toBeInTheDocument();
 60 |   });
 61 | 
 62 |   it("loads settings from chrome storage on mount", async () => {
 63 |     render(<Popup />);
 64 |     await waitFor(() => {
 65 |       expect(mockChromeStorage.get).toHaveBeenCalledWith({
 66 |         refreshInterval: "5",
 67 |         showCompleted: false,
 68 |       });
 69 |     });
 70 |   });
 71 | 
 72 |   it("fetches and displays items on mount", async () => {
 73 |     render(<Popup />);
 74 |     await waitFor(() => {
 75 |       expect(global.fetch).toHaveBeenCalledWith(
 76 |         "https://www.amazon.com/alexashoppinglists/api/getlistitems",
 77 |       );
 78 |     });
 79 | 
 80 |     await waitFor(() => {
 81 |       const incompleteList = screen.getByTestId("incomplete-list");
 82 |       const completeList = screen.getByTestId("complete-list");
 83 | 
 84 |       const incompleteItems = within(incompleteList).getAllByRole("listitem");
 85 |       const completeItems = within(completeList).getAllByRole("listitem");
 86 | 
 87 |       expect(incompleteItems).toHaveLength(1);
 88 |       expect(completeItems).toHaveLength(1);
 89 | 
 90 |       expect(incompleteItems[0]).toHaveTextContent("Test Item 1");
 91 |       expect(completeItems[0]).toHaveTextContent("Test Item 2");
 92 |     });
 93 |   });
 94 | 
 95 |   it("handles fetch errors gracefully", async () => {
 96 |     // Mock fetch to simulate an error
 97 |     (global.fetch as jest.Mock).mockImplementationOnce(() =>
 98 |       Promise.reject(new Error("Failed to fetch")),
 99 |     );
100 | 
101 |     render(<Popup />);
102 |     await waitFor(() => {
103 |       expect(screen.getByText("Error: Failed to fetch")).toBeInTheDocument();
104 |     });
105 |   });
106 | });
107 | 


--------------------------------------------------------------------------------
/src/manifest.json:
--------------------------------------------------------------------------------
 1 | {
 2 |   "manifest_version": 3,
 3 |   "name": "List Bridge",
 4 |   "version": "1.0.0",
 5 |   "description": "Bridge your shopping lists across platforms",
 6 |   "permissions": ["storage"],
 7 |   "action": {
 8 |     "default_popup": "popup.html",
 9 |     "default_title": "Shopping List Items",
10 |     "default_icon": {
11 |       "16": "assets/icon-16.png",
12 |       "32": "assets/icon-32.png",
13 |       "48": "assets/icon-48.png",
14 |       "128": "assets/icon-128.png"
15 |     }
16 |   },
17 |   "icons": {
18 |     "16": "assets/icon-16.png",
19 |     "32": "assets/icon-32.png",
20 |     "48": "assets/icon-48.png",
21 |     "128": "assets/icon-128.png"
22 |   },
23 |   "options_page": "options.html",
24 |   "host_permissions": ["https://www.amazon.com/*"],
25 |   "content_security_policy": {
26 |     "extension_pages": "script-src 'self'; object-src 'self'; style-src 'self' 'unsafe-inline' chrome-extension://*; font-src 'self'"
27 |   }
28 | }
29 | 


--------------------------------------------------------------------------------
/src/options.html:
--------------------------------------------------------------------------------
 1 | <!DOCTYPE html>
 2 | <html>
 3 |   <head>
 4 |     <meta charset="UTF-8">
 5 |     <meta name="viewport" content="width=device-width, initial-scale=1.0">
 6 |     <title>List Bridge Settings</title>
 7 | 
 8 |   </head>
 9 |   <body class="bg-dark-bg-primary">
10 |     <div id="root"></div>
11 |   </body>
12 | </html>
13 | 


--------------------------------------------------------------------------------
/src/options.tsx:
--------------------------------------------------------------------------------
  1 | import React, { useEffect, useState } from "react";
  2 | import { createRoot } from "react-dom/client";
  3 | import "./styles/options.css";
  4 | 
  5 | interface Settings {
  6 |   showCompleted: boolean;
  7 |   refreshInterval: string;
  8 | }
  9 | 
 10 | const DEFAULT_SETTINGS: Settings = {
 11 |   showCompleted: false,
 12 |   refreshInterval: "5",
 13 | };
 14 | 
 15 | const Options: React.FC = () => {
 16 |   const [settings, setSettings] = useState<Settings>(DEFAULT_SETTINGS);
 17 | 
 18 |   useEffect(() => {
 19 |     loadSettings();
 20 |   }, []);
 21 | 
 22 |   const loadSettings = async () => {
 23 |     try {
 24 |       const loadedSettings = (await chrome.storage.sync.get(
 25 |         DEFAULT_SETTINGS,
 26 |       )) as Settings;
 27 |       setSettings(loadedSettings);
 28 |     } catch (error) {
 29 |       showFeedback("Failed to load settings", true);
 30 |       console.error("Error loading settings:", error);
 31 |     }
 32 |   };
 33 | 
 34 |   const saveSettings = async () => {
 35 |     try {
 36 |       await chrome.storage.sync.set(settings);
 37 |       showFeedback("Settings saved");
 38 | 
 39 |       try {
 40 |         await chrome.runtime.sendMessage({
 41 |           type: "SETTINGS_UPDATED",
 42 |           settings,
 43 |         });
 44 |       } catch (error) {
 45 |         const err = error as Error;
 46 |         // Ignore connection errors when popup is closed
 47 |         if (!err?.message?.includes("Receiving end does not exist")) {
 48 |           throw error;
 49 |         }
 50 |       }
 51 |     } catch (error) {
 52 |       showFeedback("Failed to save settings", true);
 53 |       console.error("Error saving settings:", error);
 54 |     }
 55 |   };
 56 | 
 57 |   const showFeedback = (message: string, isError = false) => {
 58 |     const feedback = document.createElement("div");
 59 |     feedback.className = `feedback${isError ? " error" : ""}`;
 60 |     feedback.textContent = message;
 61 |     document.body.appendChild(feedback);
 62 | 
 63 |     setTimeout(() => {
 64 |       feedback.style.opacity = "0";
 65 |       setTimeout(() => feedback.remove(), 200);
 66 |     }, 1500);
 67 |   };
 68 | 
 69 |   const handleChange = (
 70 |     e: React.ChangeEvent<HTMLInputElement | HTMLSelectElement>,
 71 |   ) => {
 72 |     const { id, type, value } = e.target;
 73 |     const newValue =
 74 |       type === "checkbox" ? (e.target as HTMLInputElement).checked : value;
 75 |     setSettings((prev) => ({
 76 |       ...prev,
 77 |       [id === "show-completed" ? "showCompleted" : "refreshInterval"]: newValue,
 78 |     }));
 79 |   };
 80 | 
 81 |   useEffect(() => {
 82 |     const debounceTimer = setTimeout(() => {
 83 |       saveSettings();
 84 |     }, 500);
 85 | 
 86 |     return () => clearTimeout(debounceTimer);
 87 |   }, [settings]);
 88 |   return (
 89 |     <>
 90 |       <h1>List Bridge Settings</h1>
 91 | 
 92 |       <div className="container">
 93 |         <div className="left-column">
 94 |           <h2>About List Bridge</h2>
 95 |           <p>
 96 |             List Bridge is a powerful Chrome extension that helps you manage
 97 |             your shopping lists efficiently. It seamlessly integrates with your
 98 |             existing shopping lists and provides a clean, modern interface for
 99 |             managing your items.
100 |           </p>
101 |           <p>
102 |             With features like auto-refresh and completed items management, List
103 |             Bridge makes it easy to keep your shopping lists synchronized and
104 |             organized across all your devices.
105 |           </p>
106 |         </div>
107 | 
108 |         <div className="right-column">
109 |           <div className="option-group">
110 |             <div className="option-row">
111 |               <div className="option-content">
112 |                 <div className="option-label">Show Completed Items</div>
113 |                 <div className="description">
114 |                   Display the &quot;Complete&quot; tab with completed shopping
115 |                   list items.
116 |                 </div>
117 |               </div>
118 |               <div className="option-control">
119 |                 <label className="switch">
120 |                   <input
121 |                     type="checkbox"
122 |                     id="show-completed"
123 |                     checked={settings.showCompleted}
124 |                     onChange={handleChange}
125 |                   />
126 |                   <span className="slider"></span>
127 |                 </label>
128 |               </div>
129 |             </div>
130 |           </div>
131 | 
132 |           <div className="option-group">
133 |             <h2>Refresh Settings</h2>
134 |             <div className="option-row">
135 |               <div className="option-content">
136 |                 <div className="option-label">Auto-refresh Interval</div>
137 |                 <div className="description">
138 |                   Choose how often the list should automatically refresh. Select
139 |                   &quot;Manual only&quot; to refresh only when you click the
140 |                   refresh button.
141 |                 </div>
142 |               </div>
143 |               <div className="option-control">
144 |                 <select
145 |                   id="refreshInterval"
146 |                   value={settings.refreshInterval}
147 |                   onChange={handleChange}
148 |                 >
149 |                   <option value="0">Every time</option>
150 |                   <option value="1">Every minute</option>
151 |                   <option value="5">Every 5 minutes</option>
152 |                   <option value="15">Every 15 minutes</option>
153 |                   <option value="30">Every 30 minutes</option>
154 |                   <option value="60">Every hour</option>
155 |                   <option value="-1">Manual only</option>
156 |                 </select>
157 |               </div>
158 |             </div>
159 |           </div>
160 |         </div>
161 |       </div>
162 | 
163 |       <div className="footer">
164 |         <a
165 |           href="https://sethrose.dev"
166 |           target="_blank"
167 |           rel="noopener noreferrer"
168 |           className="domain"
169 |         >
170 |           SethRose.dev
171 |         </a>
172 |       </div>
173 |     </>
174 |   );
175 | };
176 | 
177 | const root = createRoot(document.getElementById("root")!);
178 | root.render(<Options />);
179 | 


--------------------------------------------------------------------------------
/src/popup.html:
--------------------------------------------------------------------------------
 1 | <!DOCTYPE html>
 2 | <html class="dark">
 3 |   <head>
 4 |     <meta charset="UTF-8">
 5 |     <meta name="viewport" content="width=device-width, initial-scale=1.0">
 6 |     <title>List Bridge</title>
 7 |   </head>
 8 |   <body class="bg-dark-bg-primary min-h-screen dark:bg-dark-bg-primary dark:text-dark-text-primary">
 9 |     <div id="root"></div>
10 |   </body>
11 | </html>
12 | 


--------------------------------------------------------------------------------
/src/popup.tsx:
--------------------------------------------------------------------------------
  1 | import React, { useEffect, useState } from "react";
  2 | import { createRoot } from "react-dom/client";
  3 | import "./styles/global.css";
  4 | import { ListItem } from "./types";
  5 | import {
  6 |   API_ENDPOINTS,
  7 |   LOGIN_URL,
  8 |   extractItems,
  9 |   simulateButtonClick,
 10 |   sanitizeContent,
 11 | } from "./utils";
 12 | 
 13 | interface Settings {
 14 |   refreshInterval: string;
 15 |   showCompleted: boolean;
 16 | }
 17 | 
 18 | const Popup: React.FC = () => {
 19 |   const [incompleteItems, setIncompleteItems] = useState<ListItem[]>([]);
 20 |   const [completedItems, setCompletedItems] = useState<ListItem[]>([]);
 21 | 
 22 |   const [refreshInterval, setRefreshInterval] = useState<string>("5");
 23 |   const [showCompleted, setShowCompleted] = useState(false);
 24 |   const [error, setError] = useState<string>("");
 25 |   const [isRefreshing, setIsRefreshing] = useState(false);
 26 |   const [lastRefreshTime, setLastRefreshTime] = useState<number>(Date.now());
 27 |   const [activeTab, setActiveTab] = useState<string>("incomplete");
 28 |   const [completedVisible, setCompletedVisible] = useState(false);
 29 |   const [editingItem, setEditingItem] = useState<ListItem | null>(null);
 30 |   const [editingValue, setEditingValue] = useState<string>("");
 31 |   const [deletingItem, setDeletingItem] = useState<ListItem | null>(null);
 32 |   const [isAddingItem, setIsAddingItem] = useState(false);
 33 |   const [feedbackQueue, setFeedbackQueue] = useState<
 34 |     Array<{ id: number; message: string; priority: number }>
 35 |   >([]);
 36 |   const [lastFeedbackId, setLastFeedbackId] = useState(0);
 37 | 
 38 |   useEffect(() => {
 39 |     loadSettings();
 40 |     fetchAndDisplayItems();
 41 | 
 42 |     // Listen for settings updates from options page
 43 |     const handleMessage = (message: any) => {
 44 |       if (message.type === "SETTINGS_UPDATED") {
 45 |         setRefreshInterval(message.settings.refreshInterval);
 46 |         setShowCompleted(message.settings.showCompleted);
 47 |       }
 48 |     };
 49 |     chrome.runtime.onMessage.addListener(handleMessage);
 50 | 
 51 |     return () => {
 52 |       chrome.runtime.onMessage.removeListener(handleMessage);
 53 |     };
 54 |   }, []);
 55 | 
 56 |   // Handle auto-refresh based on interval and last refresh time
 57 |   useEffect(() => {
 58 |     const shouldRefresh = () => {
 59 |       const intervalMs = parseInt(refreshInterval) * 60 * 1000;
 60 |       if (intervalMs <= 0) return false; // Manual refresh only
 61 |       if (intervalMs === 0) return true; // Refresh every time
 62 |       return Date.now() - lastRefreshTime >= intervalMs;
 63 |     };
 64 | 
 65 |     if (shouldRefresh()) {
 66 |       fetchAndDisplayItems();
 67 |     }
 68 | 
 69 |     const timer = setInterval(() => {
 70 |       if (shouldRefresh()) {
 71 |         fetchAndDisplayItems();
 72 |       }
 73 |     }, 1000); // Check every second
 74 | 
 75 |     return () => clearInterval(timer);
 76 |   }, [refreshInterval, lastRefreshTime]);
 77 | 
 78 |   const loadSettings = async () => {
 79 |     const settings = (await chrome.storage.sync.get({
 80 |       refreshInterval: "5",
 81 |       showCompleted: false,
 82 |     })) as Settings;
 83 |     setRefreshInterval(settings.refreshInterval);
 84 |     setShowCompleted(settings.showCompleted);
 85 |   };
 86 | 
 87 |   const showFeedback = (message: string, duration = 2000, priority = 1) => {
 88 |     // Increment feedback ID
 89 |     const newId = lastFeedbackId + 1;
 90 |     setLastFeedbackId(newId);
 91 | 
 92 |     // Add new feedback to queue
 93 |     setFeedbackQueue((currentQueue) => {
 94 |       // Remove duplicate messages
 95 |       const filteredQueue = currentQueue.filter(
 96 |         (item) => item.message !== message,
 97 |       );
 98 | 
 99 |       // Only keep the last 2 messages
100 |       const newQueue = [
101 |         ...filteredQueue,
102 |         { id: newId, message, priority },
103 |       ].slice(-2);
104 | 
105 |       // Sort by priority (higher number = higher priority)
106 |       return newQueue.sort((a, b) => b.priority - a.priority);
107 |     });
108 | 
109 |     // Remove feedback after duration
110 |     setTimeout(() => {
111 |       setFeedbackQueue((currentQueue) =>
112 |         currentQueue.filter((item) => item.id !== newId),
113 |       );
114 |     }, duration);
115 |   };
116 | 
117 |   const fetchAndDisplayItems = async () => {
118 |     setIsRefreshing(true);
119 |     setError("");
120 | 
121 |     try {
122 |       const response = await fetch(API_ENDPOINTS.GET_ITEMS);
123 |       if (!response.ok) {
124 |         throw new Error(`Network response was not ok: ${response.statusText}`);
125 |       }
126 |       const data = await response.json();
127 | 
128 |       if (data === "AuthenticationFailure") {
129 |         chrome.tabs.create({ url: LOGIN_URL });
130 |         setError("Authentication Failure. Redirecting to login.");
131 |         return;
132 |       }
133 | 
134 |       const { incompleteItems: incomplete, completedItems: completed } =
135 |         extractItems(data);
136 |       setIncompleteItems(incomplete);
137 |       setCompletedItems(completed);
138 |       setLastRefreshTime(Date.now());
139 |     } catch (error) {
140 |       console.error("Error occurred:", error);
141 |       setError(
142 |         `Error: ${error instanceof Error ? error.message : "Unknown error"}`,
143 |       );
144 |     } finally {
145 |       setIsRefreshing(false);
146 |     }
147 |   };
148 | 
149 |   const handleAddItem = async (value: string) => {
150 |     try {
151 |       const response = await fetch(API_ENDPOINTS.ADD_ITEM, {
152 |         method: "POST",
153 |         credentials: "include",
154 |         headers: {
155 |           accept: "application/json",
156 |           "content-type": "application/json",
157 |         },
158 |         body: JSON.stringify({
159 |           value: sanitizeContent(value),
160 |           listItemMetadata: [],
161 |         }),
162 |       });
163 | 
164 |       if (!response.ok) {
165 |         throw new Error(`Failed to add item: ${response.status}`);
166 |       }
167 | 
168 |       await fetchAndDisplayItems();
169 |       showFeedback("Item added successfully!", 1500, 2);
170 |     } catch (error) {
171 |       console.error("Error adding item:", error);
172 |       setError("Failed to add item. Please try again.");
173 |     }
174 |   };
175 | 
176 |   const updateItem = async (item: ListItem) => {
177 |     try {
178 |       const response = await fetch(API_ENDPOINTS.UPDATE_ITEM, {
179 |         method: "PUT",
180 |         headers: {
181 |           "Content-Type": "application/json",
182 |         },
183 |         body: JSON.stringify(item),
184 |       });
185 | 
186 |       if (!response.ok) {
187 |         if (response.status === 401) {
188 |           window.open(LOGIN_URL, "_blank");
189 |           throw new Error("Authentication required");
190 |         }
191 |         throw new Error("Failed to update item");
192 |       }
193 | 
194 |       await fetchAndDisplayItems();
195 |       showFeedback("Item updated successfully", 1500, 2);
196 |     } catch (error) {
197 |       setError(
198 |         error instanceof Error ? error.message : "Failed to update item",
199 |       );
200 |     }
201 |   };
202 | 
203 |   const deleteItem = async (item: ListItem) => {
204 |     try {
205 |       const response = await fetch(API_ENDPOINTS.DELETE_ITEM, {
206 |         method: "DELETE",
207 |         credentials: "include",
208 |         headers: {
209 |           "Content-Type": "application/json",
210 |         },
211 |         body: JSON.stringify(item),
212 |       });
213 | 
214 |       if (!response.ok) {
215 |         if (response.status === 401) {
216 |           window.open(LOGIN_URL, "_blank");
217 |           throw new Error("Authentication required - please log in to Amazon");
218 |         }
219 |         throw new Error(`Failed to delete item: ${response.statusText}`);
220 |       }
221 | 
222 |       await fetchAndDisplayItems();
223 |       showFeedback("Item deleted successfully", 1500, 2);
224 |     } catch (error) {
225 |       setError(
226 |         error instanceof Error ? error.message : "Failed to delete item",
227 |       );
228 |     }
229 |   };
230 | 
231 |   const copyList = async () => {
232 |     try {
233 |       const items = incompleteItems.map((item) => item.value).filter(Boolean);
234 | 
235 |       if (items.length === 0) {
236 |         showFeedback("No items to copy", 2000, 1);
237 |         return;
238 |       }
239 | 
240 |       await navigator.clipboard.writeText(items.join("\n"));
241 |       showFeedback("List copied to clipboard!", 1500, 2);
242 |       const copyBtn = document.getElementById("copy-btn");
243 |       if (copyBtn) simulateButtonClick(copyBtn);
244 |     } catch (error) {
245 |       setError("Failed to copy list to clipboard");
246 |     }
247 |   };
248 | 
249 |   const exportList = () => {
250 |     try {
251 |       const items = incompleteItems.map((item) => item.value).filter(Boolean);
252 | 
253 |       if (items.length === 0) {
254 |         showFeedback("No items to export", 2000, 1);
255 |         return;
256 |       }
257 | 
258 |       const csvContent = "data:text/csv;charset=utf-8," + items.join("\n");
259 |       const encodedUri = encodeURI(csvContent);
260 |       const link = document.createElement("a");
261 |       link.setAttribute("href", encodedUri);
262 |       link.setAttribute("download", "shopping_list.csv");
263 |       document.body.appendChild(link);
264 |       link.click();
265 |       document.body.removeChild(link);
266 | 
267 |       showFeedback("List exported!", 1500, 2);
268 |     } catch (error) {
269 |       console.error("Error exporting list:", error);
270 |       showFeedback("Failed to export list");
271 |     }
272 |   };
273 | 
274 |   const openSettings = () => {
275 |     chrome.tabs.create({
276 |       url: chrome.runtime.getURL("html/options.html"),
277 |       active: true,
278 |     });
279 |   };
280 | 
281 |   return (
282 |     <div className="container">
283 |       <div className="main-content">
284 |         <div className="header">
285 |           <div className="header-left">
286 |             <img
287 |               src="../assets/icon-48.png"
288 |               alt="List Bridge"
289 |               className="logo"
290 |             />
291 |             <h1>List Bridge</h1>
292 |           </div>
293 |           <div className="header-actions">
294 |             <button
295 |               id="addBtn"
296 |               className="icon-btn"
297 |               data-tooltip="Add new item"
298 |               onClick={() => setIsAddingItem(!isAddingItem)}
299 |             >
300 |               <svg viewBox="0 0 24 24" fill="none">
301 |                 <path
302 |                   d="M12 4V20M20 12L4 12"
303 |                   stroke="currentColor"
304 |                   strokeWidth="2"
305 |                   strokeLinecap="round"
306 |                 />
307 |               </svg>
308 |             </button>
309 |             <button
310 |               id="copy-btn"
311 |               className="icon-btn"
312 |               data-tooltip="Copy list"
313 |               onClick={copyList}
314 |             >
315 |               <svg viewBox="0 0 256 256" fill="none">
316 |                 <path
317 |                   d="M48.186 92.137c0-8.392 6.49-14.89 16.264-14.89s29.827-.225 29.827-.225-.306-6.99-.306-15.88c0-8.888 7.954-14.96 17.49-14.96 9.538 0 56.786.401 61.422.401 4.636 0 8.397 1.719 13.594 5.67 5.196 3.953 13.052 10.56 16.942 14.962 3.89 4.402 5.532 6.972 5.532 10.604 0 3.633 0 76.856-.06 85.34-.059 8.485-7.877 14.757-17.134 14.881-9.257.124-29.135.124-29.135.124s.466 6.275.466 15.15-8.106 15.811-17.317 16.056c-9.21.245-71.944-.49-80.884-.245-8.94.245-16.975-6.794-16.975-15.422s.274-93.175.274-101.566zm16.734 3.946l-1.152 92.853a3.96 3.96 0 0 0 3.958 4.012l73.913.22a3.865 3.865 0 0 0 3.91-3.978l-.218-8.892a1.988 1.988 0 0 0-2.046-1.953s-21.866.64-31.767.293c-9.902-.348-16.672-6.807-16.675-15.516-.003-8.709.003-69.142.003-69.142a1.989 1.989 0 0 0-2.007-1.993l-23.871.082a4.077 4.077 0 0 0-4.048 4.014zm106.508-35.258c-1.666-1.45-3.016-.84-3.016 1.372v17.255c0 1.106.894 2.007 1.997 2.013l20.868.101c2.204.011 2.641-1.156.976-2.606l-20.825-18.135zm-57.606.847a2.002 2.002 0 0 0-2.02 1.988l-.626 96.291a2.968 2.968 0 0 0 2.978 2.997l75.2-.186a2.054 2.054 0 0 0 2.044-2.012l1.268-62.421a1.951 1.951 0 0 0-1.96-2.004s-26.172.042-30.783.042c-4.611 0-7.535-2.222-7.535-6.482S152.3 63.92 152.3 63.92a2.033 2.033 0 0 0-2.015-2.018l-36.464-.23z"
318 |                   stroke="currentColor"
319 |                   strokeWidth="1.5"
320 |                 />
321 |               </svg>
322 |             </button>
323 |             <button
324 |               id="refresh-btn"
325 |               className={`icon-btn refresh-btn ${isRefreshing ? "spinning" : ""}`}
326 |               data-tooltip="Refresh list"
327 |               onClick={fetchAndDisplayItems}
328 |               disabled={isRefreshing}
329 |             >
330 |               <svg viewBox="0 0 24 24" fill="none">
331 |                 <path
332 |                   d="M4.06189 13C4.02104 12.6724 4 12.3387 4 12C4 7.58172 7.58172 4 12 4C14.5006 4 16.7332 5.14727 18.2002 6.94416M19.9381 11C19.979 11.3276 20 11.6613 20 12C20 16.4183 16.4183 20 12 20C9.61061 20 7.46589 18.9525 6 17.2916M9 17H6V17.2916M18.2002 4V6.94416M18.2002 6.94416V6.99993L15.2002 7"
333 |                   stroke="currentColor"
334 |                   strokeWidth="2"
335 |                   strokeLinecap="round"
336 |                   strokeLinejoin="round"
337 |                 />
338 |               </svg>
339 |             </button>
340 |             <button
341 |               id="export-btn"
342 |               className="icon-btn"
343 |               data-tooltip="Export list"
344 |               onClick={exportList}
345 |             >
346 |               <svg viewBox="0 0 24 24" fill="none">
347 |                 <path
348 |                   d="M4 16V17C4 18.6569 5.34315 20 7 20H17C18.6569 20 20 18.6569 20 17V16M12 4V16M12 16L8 12M12 16L16 12"
349 |                   stroke="currentColor"
350 |                   strokeWidth="2"
351 |                   strokeLinecap="round"
352 |                   strokeLinejoin="round"
353 |                 />
354 |               </svg>
355 |             </button>
356 |             <button
357 |               id="settings-btn"
358 |               className="icon-btn"
359 |               data-tooltip="Settings"
360 |               onClick={openSettings}
361 |             >
362 |               <svg viewBox="0 0 24 24" fill="none">
363 |                 <circle
364 |                   cx="12"
365 |                   cy="12"
366 |                   r="3"
367 |                   stroke="currentColor"
368 |                   strokeWidth="1.5"
369 |                 />
370 |                 <path
371 |                   d="M13.7654 2.15224C13.3978 2 12.9319 2 12 2C11.0681 2 10.6022 2 10.2346 2.15224C9.74457 2.35523 9.35522 2.74458 9.15223 3.23463C9.05957 3.45834 9.0233 3.7185 9.00911 4.09799C8.98826 4.65568 8.70226 5.17189 8.21894 5.45093C7.73564 5.72996 7.14559 5.71954 6.65219 5.45876C6.31645 5.2813 6.07301 5.18262 5.83294 5.15102C5.30704 5.08178 4.77518 5.22429 4.35436 5.5472C4.03874 5.78938 3.80577 6.1929 3.33983 6.99993C2.87389 7.80697 2.64092 8.21048 2.58899 8.60491C2.51976 9.1308 2.66227 9.66266 2.98518 10.0835C3.13256 10.2756 3.3397 10.437 3.66119 10.639C4.1338 10.936 4.43789 11.4419 4.43786 12C4.43783 12.5581 4.13375 13.0639 3.66118 13.3608C3.33965 13.5629 3.13248 13.7244 2.98508 13.9165C2.66217 14.3373 2.51966 14.8691 2.5889 15.395C2.64082 15.7894 2.87379 16.193 3.33973 17C3.80568 17.807 4.03865 18.2106 4.35426 18.4527C4.77508 18.7756 5.30694 18.9181 5.83284 18.8489C6.07289 18.8173 6.31632 18.7186 6.65204 18.5412C7.14547 18.2804 7.73556 18.27 8.2189 18.549C8.70224 18.8281 8.98826 19.3443 9.00911 19.9021C9.02331 20.2815 9.05957 20.5417 9.15223 20.7654C9.35522 21.2554 9.74457 21.6448 10.2346 21.8478C10.6022 22 11.0681 22 12 22C12.9319 22 13.3978 22 13.7654 21.8478C14.2554 21.6448 14.6448 21.2554 14.8477 20.7654C14.9404 20.5417 14.9767 20.2815 14.9909 19.902C15.0117 19.3443 15.2977 18.8281 15.781 18.549C16.2643 18.2699 16.8544 18.2804 17.3479 18.5412C17.6836 18.7186 17.927 18.8172 18.167 18.8488C18.6929 18.9181 19.2248 18.7756 19.6456 18.4527C19.9612 18.2105 20.1942 17.807 20.6601 16.9999C21.1261 16.1929 21.3591 15.7894 21.411 15.395C21.4802 14.8691 21.3377 14.3372 21.0148 13.9164C20.8674 13.7243 20.6602 13.5628 20.3387 13.3608C19.8662 13.0639 19.5621 12.558 19.5621 11.9999C19.5621 11.4418 19.8662 10.9361 20.3387 10.6392C20.6603 10.4371 20.8675 10.2757 21.0149 10.0835C21.3378 9.66273 21.4803 9.13087 21.4111 8.60497C21.3592 8.21055 21.1262 7.80703 20.6602 7C20.1943 6.19297 19.9613 5.78945 19.6457 5.54727C19.2249 5.22436 18.693 5.08185 18.1671 5.15109C17.9271 5.18269 17.6837 5.28136 17.3479 5.4588C16.8545 5.71959 16.2644 5.73002 15.7811 5.45096C15.2977 5.17191 15.0117 4.65566 14.9909 4.09794C14.9767 3.71848 14.9404 3.45833 14.8477 3.23463C14.6448 2.74458 14.2554 2.35523 13.7654 2.15224Z"
372 |                   stroke="currentColor"
373 |                   strokeWidth="1.5"
374 |                 />
375 |               </svg>
376 |             </button>
377 |           </div>
378 |         </div>
379 | 
380 |         {error && <div className="error">{error}</div>}
381 | 
382 |         <div className="tab-container">
383 |           <button
384 |             className={`tab ${activeTab === "incomplete" ? "active" : ""}`}
385 |             onClick={() => {
386 |               setActiveTab("incomplete");
387 |               setCompletedVisible(false);
388 |             }}
389 |           >
390 |             Incomplete ({incompleteItems.length})
391 |           </button>
392 |           {showCompleted && (
393 |             <button
394 |               className={`tab ${activeTab === "completed" ? "active" : ""}`}
395 |               onClick={() => {
396 |                 setActiveTab("completed");
397 |                 setCompletedVisible(true);
398 |               }}
399 |             >
400 |               Completed
401 |             </button>
402 |           )}
403 |         </div>
404 | 
405 |         <div
406 |           id="incomplete-tab"
407 |           className={`tab-content ${!completedVisible ? "active" : ""}`}
408 |         >
409 |           <ul
410 |             id="incomplete-list"
411 |             className="list"
412 |             data-testid="incomplete-list"
413 |           >
414 |             {isAddingItem && (
415 |               <li className="list-item new-item">
416 |                 <input
417 |                   type="text"
418 |                   className="item-text"
419 |                   placeholder="Enter new item..."
420 |                   autoFocus
421 |                   onKeyDown={(e) => {
422 |                     if (e.key === "Enter") {
423 |                       const value = e.currentTarget.value.trim();
424 |                       if (value) {
425 |                         handleAddItem(value);
426 |                         setIsAddingItem(false);
427 |                       }
428 |                     } else if (e.key === "Escape") {
429 |                       setIsAddingItem(false);
430 |                     }
431 |                   }}
432 |                   onBlur={() => setIsAddingItem(false)}
433 |                 />
434 |               </li>
435 |             )}
436 |             {incompleteItems.map((item) => (
437 |               <li
438 |                 key={item.id}
439 |                 className={`list-item ${editingItem?.id === item.id ? "editing" : ""}`}
440 |                 role="listitem"
441 |               >
442 |                 {editingItem?.id === item.id ? (
443 |                   <input
444 |                     type="text"
445 |                     className="item-text"
446 |                     value={editingValue}
447 |                     onChange={(e) => setEditingValue(e.target.value)}
448 |                     autoFocus
449 |                     onKeyDown={(e) => {
450 |                       if (e.key === "Enter") {
451 |                         const value = editingValue.trim();
452 |                         if (value && value !== item.value) {
453 |                           updateItem({ ...item, value });
454 |                         }
455 |                         setEditingItem(null);
456 |                         setEditingValue("");
457 |                       } else if (e.key === "Escape") {
458 |                         setEditingItem(null);
459 |                         setEditingValue("");
460 |                       }
461 |                     }}
462 |                     onBlur={() => {
463 |                       setEditingItem(null);
464 |                       setEditingValue("");
465 |                     }}
466 |                   />
467 |                 ) : (
468 |                   <span
469 |                     className="item-text"
470 |                     onDoubleClick={() => {
471 |                       setEditingValue(item.value);
472 |                       setEditingItem(item);
473 |                     }}
474 |                     onClick={(e) => {
475 |                       // Prevent double click from triggering on completed items
476 |                       if (!item.completed) {
477 |                         e.currentTarget.focus();
478 |                       }
479 |                     }}
480 |                     onKeyDown={(e) => {
481 |                       if (e.key === "Enter" || e.key === "F2") {
482 |                         setEditingValue(item.value);
483 |                         setEditingItem(item);
484 |                       }
485 |                     }}
486 |                     tabIndex={item.completed ? -1 : 0}
487 |                     role="textbox"
488 |                     aria-label={`${item.value}. Double-click or press Enter to edit`}
489 |                   >
490 |                     {item.value}
491 |                   </span>
492 |                 )}
493 |                 <div className="item-actions">
494 |                   <button
495 |                     className="control-btn"
496 |                     onClick={() => updateItem({ ...item, completed: true })}
497 |                     data-tooltip="Mark as complete"
498 |                   >
499 |                     <svg viewBox="0 0 24 24" fill="none">
500 |                       <path
501 |                         d="M9 12.75L11.25 15 15 9.75M21 12a9 9 0 11-18 0 9 9 0 0118 0z"
502 |                         stroke="currentColor"
503 |                         strokeWidth="2"
504 |                         strokeLinecap="round"
505 |                         strokeLinejoin="round"
506 |                       />
507 |                     </svg>
508 |                   </button>
509 |                   <button
510 |                     className={`control-btn delete-btn ${deletingItem?.id === item.id ? "confirm-state" : ""}`}
511 |                     onClick={() => {
512 |                       if (deletingItem?.id === item.id) {
513 |                         deleteItem(item);
514 |                         setDeletingItem(null);
515 |                       } else {
516 |                         setDeletingItem(item);
517 |                       }
518 |                     }}
519 |                     data-tooltip={
520 |                       deletingItem?.id === item.id
521 |                         ? "Click to confirm"
522 |                         : "Delete item"
523 |                     }
524 |                   >
525 |                     {deletingItem?.id === item.id ? (
526 |                       <svg viewBox="0 0 24 24" fill="none">
527 |                         <path
528 |                           d="M4 12.6111L8.92308 17.5L20 6.5"
529 |                           stroke="#00f01c"
530 |                           strokeWidth="2"
531 |                           strokeLinecap="round"
532 |                           strokeLinejoin="round"
533 |                         />
534 |                       </svg>
535 |                     ) : (
536 |                       <svg viewBox="0 0 24 24" fill="none">
537 |                         <path
538 |                           d="M14.74 9l-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 01-2.244 2.077H8.084a2.25 2.25 0 01-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 00-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 013.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 00-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 00-7.5 0"
539 |                           stroke="currentColor"
540 |                           strokeWidth="2"
541 |                           strokeLinecap="round"
542 |                           strokeLinejoin="round"
543 |                         />
544 |                       </svg>
545 |                     )}
546 |                   </button>
547 |                 </div>
548 |               </li>
549 |             ))}
550 |           </ul>
551 |         </div>
552 | 
553 |         <div
554 |           id="complete-tab"
555 |           className={`tab-content ${completedVisible ? "active" : ""}`}
556 |         >
557 |           <ul id="complete-list" className="list" data-testid="complete-list">
558 |             {completedItems.map((item) => (
559 |               <li key={item.id} className="list-item" role="listitem">
560 |                 <span
561 |                   className="item-text"
562 |                   onDoubleClick={() => {
563 |                     if (!item.completed) {
564 |                       setEditingValue(item.value);
565 |                       setEditingItem(item);
566 |                     }
567 |                   }}
568 |                   onClick={(e) => e.currentTarget.focus()}
569 |                   onKeyDown={(e) => {
570 |                     if (e.key === "Enter" || e.key === "F2") {
571 |                       setEditingValue(item.value);
572 |                       setEditingItem(item);
573 |                     }
574 |                   }}
575 |                   tabIndex={0}
576 |                   role="textbox"
577 |                   aria-label={`${item.value}. Double-click or press Enter to edit`}
578 |                 >
579 |                   {item.value}
580 |                 </span>
581 |                 <div className="item-actions">
582 |                   <button
583 |                     className="control-btn"
584 |                     onClick={() => updateItem({ ...item, completed: false })}
585 |                     data-tooltip="Move to incomplete"
586 |                   >
587 |                     <svg viewBox="0 0 24 24" fill="none">
588 |                       <path
589 |                         d="M12 20.75C10.078 20.7474 8.23546 19.9827 6.8764 18.6236C5.51733 17.2645 4.75265 15.422 4.75 13.5C4.75 13.3011 4.82902 13.1103 4.96967 12.9697C5.11032 12.829 5.30109 12.75 5.5 12.75C5.69891 12.75 5.88968 12.829 6.03033 12.9697C6.17098 13.1103 6.25 13.3011 6.25 13.5C6.25 14.6372 6.58723 15.7489 7.21905 16.6945C7.85087 17.6401 8.74889 18.3771 9.79957 18.8123C10.8502 19.2475 12.0064 19.3614 13.1218 19.1395C14.2372 18.9177 15.2617 18.37 16.0659 17.5659C16.87 16.7617 17.4177 15.7372 17.6395 14.6218C17.8614 13.5064 17.7475 12.3502 17.3123 11.2996C16.8771 10.2489 16.1401 9.35087 15.1945 8.71905C14.2489 8.08723 13.1372 7.75 12 7.75H9.5C9.30109 7.75 9.11032 7.67098 8.96967 7.53033C8.82902 7.38968 8.75 7.19891 8.75 7C8.75 6.80109 8.82902 6.61032 8.96967 6.46967C9.11032 6.32902 9.30109 6.25 9.5 6.25H12C13.9228 6.25 15.7669 7.01384 17.1265 8.37348C18.4862 9.73311 19.25 11.5772 19.25 13.5C19.25 15.4228 18.4862 17.2669 17.1265 18.6265C15.7669 19.9862 13.9228 20.75 12 20.75Z"
590 |                         fill="currentColor"
591 |                       />
592 |                       <path
593 |                         d="M12 10.75C11.9015 10.7505 11.8038 10.7313 11.7128 10.6935C11.6218 10.6557 11.5393 10.6001 11.47 10.53L8.47001 7.53003C8.32956 7.38941 8.25067 7.19878 8.25067 7.00003C8.25067 6.80128 8.32956 6.61066 8.47001 6.47003L11.47 3.47003C11.5387 3.39634 11.6215 3.33724 11.7135 3.29625C11.8055 3.25526 11.9048 3.23322 12.0055 3.23144C12.1062 3.22966 12.2062 3.24819 12.2996 3.28591C12.393 3.32363 12.4778 3.37977 12.549 3.45099C12.6203 3.52221 12.6764 3.60705 12.7141 3.70043C12.7519 3.79382 12.7704 3.89385 12.7686 3.99455C12.7668 4.09526 12.7448 4.19457 12.7038 4.28657C12.6628 4.37857 12.6037 4.46137 12.53 4.53003L10.06 7.00003L12.53 9.47003C12.6705 9.61066 12.7494 9.80128 12.7494 10C12.7494 10.1988 12.6705 10.3894 12.53 10.53C12.4608 10.6001 12.3782 10.6557 12.2872 10.6935C12.1962 10.7313 12.0986 10.7505 12 10.75Z"
594 |                         fill="currentColor"
595 |                       />
596 |                     </svg>
597 |                   </button>
598 |                   <button
599 |                     className={`control-btn delete-btn ${deletingItem?.id === item.id ? "confirm-state" : ""}`}
600 |                     onClick={() => {
601 |                       if (deletingItem?.id === item.id) {
602 |                         deleteItem(item);
603 |                         setDeletingItem(null);
604 |                       } else {
605 |                         setDeletingItem(item);
606 |                       }
607 |                     }}
608 |                     data-tooltip={
609 |                       deletingItem?.id === item.id
610 |                         ? "Click to confirm"
611 |                         : "Delete item"
612 |                     }
613 |                   >
614 |                     {deletingItem?.id === item.id ? (
615 |                       <svg viewBox="0 0 24 24" fill="none">
616 |                         <path
617 |                           d="M4 12.6111L8.92308 17.5L20 6.5"
618 |                           stroke="#00f01c"
619 |                           strokeWidth="2"
620 |                           strokeLinecap="round"
621 |                           strokeLinejoin="round"
622 |                         />
623 |                       </svg>
624 |                     ) : (
625 |                       <svg viewBox="0 0 24 24" fill="none">
626 |                         <path
627 |                           d="M14.74 9l-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 01-2.244 2.077H8.084a2.25 2.25 0 01-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 00-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 013.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 00-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 00-7.5 0"
628 |                           stroke="currentColor"
629 |                           strokeWidth="2"
630 |                           strokeLinecap="round"
631 |                           strokeLinejoin="round"
632 |                         />
633 |                       </svg>
634 |                     )}
635 |                   </button>
636 |                 </div>
637 |               </li>
638 |             ))}
639 |           </ul>
640 |         </div>
641 |       </div>
642 |       <div className="footer">
643 |         <a
644 |           href="https://sethrose.dev"
645 |           target="_blank"
646 |           rel="noopener noreferrer"
647 |           className="domain"
648 |         >
649 |           SethRose.dev
650 |         </a>
651 |         <a
652 |           href="https://github.com/sponsors/sethvm"
653 |           target="_blank"
654 |           rel="noopener noreferrer"
655 |           className="donate-badge"
656 |           data-tooltip="Support development"
657 |         >
658 |           <svg viewBox="0 0 24 24" fill="none">
659 |             <path
660 |               d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"
661 |               fill="currentColor"
662 |             />
663 |           </svg>
664 |           Donate
665 |         </a>
666 |       </div>
667 | 
668 |       <div className="feedback-container">
669 |         {feedbackQueue.map(({ id, message }) => (
670 |           <div key={id} className="feedback show">
671 |             {message}
672 |           </div>
673 |         ))}
674 |       </div>
675 |     </div>
676 |   );
677 | };
678 | 
679 | export default Popup;
680 | 
681 | // Only render in non-test environments
682 | if (process.env.NODE_ENV !== "test") {
683 |   const root = createRoot(document.getElementById("root")!);
684 |   root.render(<Popup />);
685 | }
686 | 


--------------------------------------------------------------------------------
/src/public/images/icon-128.png:
--------------------------------------------------------------------------------
https://raw.githubusercontent.com/TheSethRose/list-bridge/main/src/public/images/icon-128.png


--------------------------------------------------------------------------------
/src/public/images/icon-16.png:
--------------------------------------------------------------------------------
https://raw.githubusercontent.com/TheSethRose/list-bridge/main/src/public/images/icon-16.png


--------------------------------------------------------------------------------
/src/public/images/icon-32.png:
--------------------------------------------------------------------------------
https://raw.githubusercontent.com/TheSethRose/list-bridge/main/src/public/images/icon-32.png


--------------------------------------------------------------------------------
/src/public/images/icon-48.png:
--------------------------------------------------------------------------------
https://raw.githubusercontent.com/TheSethRose/list-bridge/main/src/public/images/icon-48.png


--------------------------------------------------------------------------------
/src/public/images/icon.svg:
--------------------------------------------------------------------------------
 1 | <?xml version="1.0" encoding="UTF-8"?>
 2 | <svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 508.1 508.1" xml:space="preserve">
 3 |   <g>
 4 |     <path style="fill:#F2F2F2;" d="M460.55,212.2c-20.4,0-38.5-13-45-32.4l-10.1-30.1c10.3,30.7-12.6,62.5-45,62.5h-6.6 c-24.2,0-44.5-18.2-47.1-42.2l-1.2-10.5c3.1,28.1-18.9,52.7-47.1,52.7h-8.9c-28.3,0-50.3-24.6-47.1-52.7l-1.2,10.5 c-2.7,24-23,42.2-47.1,42.2h-6.6c-32.4,0-55.3-31.8-45-62.5l-10.1,30.1c-6.5,19.3-24.6,32.4-45,32.4c-3.8,0-7.3-0.5-10.8-1.3v276 c0,11.7,9.5,21.2,21.2,21.2h392.2c11.7,0,21.2-9.5,21.2-21.2v-276C467.85,211.7,464.25,212.2,460.55,212.2z"></path>
 5 |     <path style="fill:#84DBFF;" d="M450.15,0H57.95c-11.7,0-21.2,9.5-21.2,21.2v65.5h434.5V21.2C471.35,9.5,461.85,0,450.15,0z"></path>
 6 |     <rect x="84.45" y="308.1" style="fill:#40596B;" width="152.9" height="199.8"></rect>
 7 |     <rect x="280.25" y="358.6" style="fill:#FFFFFF;" width="148.2" height="98.9"></rect>
 8 |     <rect x="291.45" y="369.9" style="fill:#84DBFF;" width="125.6" height="76.3"></rect>
 9 |     <g>
10 |       <path style="fill:#FFFFFF;" d="M102.65,149.7c-10.3,30.7,12.6,62.5,45,62.5h6.6c24.2,0,44.5-18.2,47.1-42.2l9.3-83.3h-86.9 L102.65,149.7z"></path>
11 |       <path style="fill:#FFFFFF;" d="M405.45,149.7l-21.1-63h-86.9l9.3,83.3c2.7,24,23,42.2,47.1,42.2h6.6 C392.95,212.2,415.75,180.4,405.45,149.7z"></path>
12 |     </g>
13 |     <g>
14 |       <path style="fill:#FF7058;" d="M6.15,141.6c-17.6,31.6,5.2,70.5,41.4,70.5c20.4,0,38.5-13,45-32.4l31.1-93.1h-86.9L6.15,141.6z"></path>
15 |       <path style="fill:#FF7058;" d="M297.55,86.7h-86.9l-8.1,72.8c-3.1,28.1,18.9,52.7,47.1,52.7h8.9c28.3,0,50.3-24.6,47.1-52.7 L297.55,86.7z"></path>
16 |       <path style="fill:#FF7058;" d="M501.95,141.6l-30.6-54.9h-86.9l31.1,93.1c6.5,19.3,24.6,32.4,45,32.4 C496.75,212.2,519.55,173.3,501.95,141.6z"></path>
17 |       <circle style="fill:#FF7058;" cx="217.45" cy="408.1" r="10.9"></circle>
18 |     </g>
19 |     <g>
20 |       <path style="fill:#CDD6E0;" d="M102.65,149.6l-10.1,30.2c-6.6,19.4-24.7,32.4-45,32.4c-3.8,0-7.3-0.5-10.8-1.3v11.4 c3.4,0.8,7.1,1.3,10.8,1.3c20.3,0,38.5-13.1,45-32.5l7.7-23.1C99.95,162,100.55,155.8,102.65,149.6z"></path>
21 |       <path style="fill:#CDD6E0;" d="M460.55,212.2c-20.4,0-38.5-13-45-32.4l-9.7-29.2c1.8,5.9,2.4,11.8,2.1,17.5l7.7,23 c6.5,19.4,24.6,32.5,45,32.5c3.7,0,7.3-0.4,10.7-1.3V211C467.85,211.7,464.25,212.2,460.55,212.2z"></path>
22 |       <path style="fill:#CDD6E0;" d="M360.55,212.2h-6.7c-24.1,0-44.4-18.2-47.1-42.2l-1.2-10.4c3.1,28-18.8,52.6-47.1,52.6h-8.9 c-28.3,0-50.3-24.7-47.2-52.7l-1.2,10.5c-2.6,24-23,42.2-47.1,42.2h-6.6c-25,0-44.3-18.9-47-41.7c-3.3,27.4,18,53.1,47,53.1h6.6 c24.1,0,44.5-18.2,47.2-42.2l1.1-10.6c-3.1,28.2,18.9,52.8,47.2,52.8h8.9c28.3,0,50.2-24.7,47.1-52.8l1.2,10.6 c2.6,24,23,42.2,47.2,42.2h6.5c29.1,0,50.5-25.6,47.2-53C404.85,193.3,385.55,212.2,360.55,212.2z"></path>
23 |     </g>
24 |   </g>
25 | </svg>
26 | 


--------------------------------------------------------------------------------
/src/styles/global.css:
--------------------------------------------------------------------------------
  1 | @import "tailwindcss";
  2 | 
  3 | .container {
  4 |   width: 360px;
  5 |   min-height: 230px;
  6 |   max-height: 638px;
  7 |   background-color: #1a1a1a;
  8 |   color: #ffffff;
  9 |   display: flex;
 10 |   flex-direction: column;
 11 |   position: relative;
 12 | }
 13 | 
 14 | .main-content {
 15 |   flex: 1;
 16 |   display: flex;
 17 |   flex-direction: column;
 18 |   min-height: 0;
 19 |   max-height: 538px;
 20 |   overflow: hidden;
 21 | }
 22 | 
 23 | .header {
 24 |   padding: 12px;
 25 |   display: flex;
 26 |   justify-content: space-between;
 27 |   align-items: center;
 28 |   background-color: #2a2a2a;
 29 |   border-bottom: 1px solid #404040;
 30 | }
 31 | 
 32 | .header-left {
 33 |   display: flex;
 34 |   align-items: center;
 35 |   gap: 8px;
 36 | }
 37 | 
 38 | .header-left h1 {
 39 |   font-size: 20px;
 40 |   font-weight: 600;
 41 | }
 42 | 
 43 | .logo {
 44 |   width: 24px;
 45 |   height: 24px;
 46 | }
 47 | 
 48 | .header-actions {
 49 |   display: flex;
 50 |   gap: 8px;
 51 | }
 52 | 
 53 | .icon-btn {
 54 |   padding: 6px;
 55 |   border-radius: 4px;
 56 |   background: transparent;
 57 |   @apply text-white;
 58 |   transition: background-color 0.2s;
 59 |   display: flex;
 60 |   align-items: center;
 61 |   justify-content: center;
 62 | }
 63 | 
 64 | .icon-btn:hover {
 65 |   background-color: #404040;
 66 | }
 67 | 
 68 | .icon-btn svg {
 69 |   width: 18px;
 70 |   height: 18px;
 71 | }
 72 | 
 73 | .tab-container {
 74 |   display: flex;
 75 |   width: 100%;
 76 |   border-bottom: 1px solid #404040;
 77 | }
 78 | 
 79 | .tab {
 80 |   flex: 1;
 81 |   padding: 12px;
 82 |   background: transparent;
 83 |   color: #a0a0a0;
 84 |   transition: all 0.2s;
 85 |   border-bottom: 2px solid transparent;
 86 | }
 87 | 
 88 | .tab:hover {
 89 |   color: #ffffff;
 90 |   background-color: #2a2a2a;
 91 | }
 92 | 
 93 | .tab.active {
 94 |   color: #ffffff;
 95 |   border-bottom-color: #4caf50;
 96 | }
 97 | 
 98 | .tab-content {
 99 |   display: none;
100 |   flex: 1;
101 |   overflow-y: auto;
102 |   padding: 8px 12px;
103 |   min-height: 0;
104 | }
105 | 
106 | .tab-content.active {
107 |   display: block;
108 | }
109 | 
110 | .list {
111 |   display: flex;
112 |   flex-direction: column;
113 |   gap: 8px;
114 | }
115 | 
116 | .list-item {
117 |   display: flex;
118 |   justify-content: space-between;
119 |   align-items: center;
120 |   padding: 8px 12px;
121 |   background-color: #2a2a2a;
122 |   border-radius: 4px;
123 |   border: 1px solid #404040;
124 |   transition: border-color 0.2s;
125 | }
126 | 
127 | .list-item:hover {
128 |   border-color: #505050;
129 | }
130 | 
131 | .item-text {
132 |   flex: 1;
133 |   min-width: 0;
134 |   white-space: nowrap;
135 |   overflow: hidden;
136 |   text-overflow: ellipsis;
137 |   cursor: text;
138 |   padding: 2px 4px;
139 |   margin: -2px -4px;
140 |   border-radius: 4px;
141 |   transition: background-color 0.2s;
142 | }
143 | 
144 | .item-text:hover {
145 |   background: rgba(255, 255, 255, 0.05);
146 | }
147 | 
148 | .item-actions {
149 |   display: flex;
150 |   gap: 4px;
151 |   margin-left: 8px;
152 | }
153 | 
154 | .control-btn {
155 |   padding: 4px;
156 |   border-radius: 4px;
157 |   background: transparent;
158 |   color: #a0a0a0;
159 |   transition: all 0.2s;
160 | }
161 | 
162 | .control-btn:hover {
163 |   background-color: #404040;
164 |   color: #ffffff;
165 | }
166 | 
167 | .control-btn svg {
168 |   width: 20px;
169 |   height: 20px;
170 | }
171 | 
172 | .footer {
173 |   padding: 12px;
174 |   display: flex;
175 |   justify-content: space-between;
176 |   align-items: center;
177 |   background-color: #2a2a2a;
178 |   border-top: 1px solid #404040;
179 |   flex-shrink: 0;
180 | }
181 | 
182 | .domain {
183 |   color: #a0a0a0;
184 |   text-decoration: none;
185 |   transition: color 0.2s;
186 | }
187 | 
188 | .domain:hover {
189 |   color: #ffffff;
190 | }
191 | 
192 | .donate-badge {
193 |   display: flex;
194 |   align-items: center;
195 |   gap: 4px;
196 |   padding: 4px 8px;
197 |   border-radius: 4px;
198 |   background-color: #404040;
199 |   color: #ffffff;
200 |   text-decoration: none;
201 |   transition: background-color 0.2s;
202 | }
203 | 
204 | [data-tooltip] {
205 |   position: relative;
206 | }
207 | 
208 | [data-tooltip]:before {
209 |   content: attr(data-tooltip);
210 |   position: absolute;
211 |   bottom: 120%;
212 |   left: 50%;
213 |   transform: translateX(-50%);
214 |   padding: 4px 8px;
215 |   background-color: rgba(0, 0, 0, 0.8);
216 |   color: white;
217 |   font-size: 12px;
218 |   white-space: nowrap;
219 |   border-radius: 4px;
220 |   opacity: 0;
221 |   visibility: hidden;
222 |   transition: opacity 0.2s;
223 |   pointer-events: none;
224 |   z-index: 1000;
225 | }
226 | 
227 | [data-tooltip]:hover:before {
228 |   opacity: 1;
229 |   visibility: visible;
230 | }
231 | 
232 | .donate-badge:hover {
233 |   background-color: #505050;
234 | }
235 | 
236 | .donate-badge svg {
237 |   width: 16px;
238 |   height: 16px;
239 | }
240 | 
241 | /* Tooltip styles */
242 | [data-tooltip] {
243 |   position: relative;
244 | }
245 | 
246 | /* Tooltip positioning */
247 | .tab-container [data-tooltip]:before,
248 | .list-item:first-child [data-tooltip]:before {
249 |   top: 100%;
250 |   bottom: auto;
251 |   margin-top: 8px;
252 | }
253 | 
254 | [data-tooltip]:before {
255 |   content: attr(data-tooltip);
256 |   position: absolute;
257 |   bottom: 100%;
258 |   left: 50%;
259 |   transform: translateX(-50%);
260 |   padding: 4px 8px;
261 |   background-color: rgba(0, 0, 0, 0.8);
262 |   color: white;
263 |   font-size: 12px;
264 |   white-space: nowrap;
265 |   border-radius: 4px;
266 |   pointer-events: none;
267 |   opacity: 0;
268 |   transition: opacity 0.2s;
269 |   transition-delay: 0.5s;
270 |   z-index: 9999;
271 | }
272 | 
273 | [data-tooltip]:hover:before {
274 |   opacity: 1;
275 | }
276 | 
277 | .feedback-container {
278 |   position: fixed;
279 |   bottom: 16px;
280 |   left: 50%;
281 |   transform: translateX(-50%);
282 |   display: flex;
283 |   flex-direction: column;
284 |   gap: 6px;
285 |   pointer-events: none;
286 |   z-index: 9999;
287 |   max-width: 300px;
288 |   align-items: center;
289 | }
290 | 
291 | .feedback {
292 |   padding: 8px 16px;
293 |   border-radius: 6px;
294 |   background-color: #404040;
295 |   color: #ffffff;
296 |   opacity: 0;
297 |   transform: translateY(10px);
298 |   transition: all 0.2s ease-out;
299 |   pointer-events: none;
300 |   font-size: 13px;
301 |   line-height: 1.4;
302 |   box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
303 |   word-wrap: break-word;
304 |   max-width: 100%;
305 |   border: 1px solid #505050;
306 |   text-align: center;
307 | }
308 | 
309 | .feedback.show {
310 |   opacity: 1;
311 |   transform: translateY(0);
312 | }
313 | 
314 | .error {
315 |   padding: 8px 12px;
316 |   margin: 8px 12px;
317 |   background-color: #ff4444;
318 |   color: #ffffff;
319 |   border-radius: 4px;
320 | }
321 | 
322 | .refresh-btn.spinning svg {
323 |   animation: spin 1s linear infinite;
324 | }
325 | 
326 | @keyframes spin {
327 |   from {
328 |     transform: rotate(0deg);
329 |   }
330 |   to {
331 |     transform: rotate(360deg);
332 |   }
333 | }
334 | 
335 | @layer base {
336 |   /* Custom scrollbar styles */
337 |   * {
338 |     scrollbar-width: thin;
339 |     scrollbar-color: #404040 #1a1a1a;
340 |   }
341 |   *::-webkit-scrollbar {
342 |     width: 8px;
343 |   }
344 |   *::-webkit-scrollbar-track {
345 |     background: #1a1a1a;
346 |     border-radius: 4px;
347 |   }
348 |   *::-webkit-scrollbar-thumb {
349 |     background-color: #404040;
350 |     border-radius: 4px;
351 |     border: 2px solid #1a1a1a;
352 |   }
353 |   *::-webkit-scrollbar-thumb:hover {
354 |     background-color: #505050;
355 |   }
356 | }
357 | 


--------------------------------------------------------------------------------
/src/styles/options.css:
--------------------------------------------------------------------------------
  1 | :root {
  2 |   --bg-primary: #1a1a1a;
  3 |   --bg-secondary: #2a2a2a;
  4 |   --bg-hover: #333333;
  5 |   --border-color: #404040;
  6 |   --text-primary: #e0e0e0;
  7 |   --text-secondary: #a0a0a0;
  8 |   --accent-color: #4caf50;
  9 | }
 10 | 
 11 | body {
 12 |   font-family: 'Inter', sans-serif;
 13 |   margin: 0;
 14 |   padding: 20px;
 15 |   background-color: var(--bg-primary);
 16 |   color: var(--text-primary);
 17 |   min-width: 800px;
 18 | }
 19 | 
 20 | .container {
 21 |   display: flex;
 22 |   gap: 40px;
 23 | }
 24 | 
 25 | .left-column {
 26 |   flex: 1;
 27 |   padding-right: 20px;
 28 |   border-right: 1px solid var(--border-color);
 29 | }
 30 | 
 31 | .right-column {
 32 |   flex: 2;
 33 | }
 34 | 
 35 | h1 {
 36 |   font-size: 20px;
 37 |   font-weight: 600;
 38 |   margin: 0 0 20px 0;
 39 |   padding-bottom: 16px;
 40 |   border-bottom: 1px solid var(--border-color);
 41 | }
 42 | 
 43 | h2 {
 44 |   font-size: 16px;
 45 |   font-weight: 600;
 46 |   margin: 0 0 16px 0;
 47 |   color: var(--text-primary);
 48 | }
 49 | 
 50 | p {
 51 |   font-size: 14px;
 52 |   line-height: 1.5;
 53 |   color: var(--text-secondary);
 54 |   margin: 0 0 16px 0;
 55 | }
 56 | 
 57 | .option-group {
 58 |   margin-bottom: 24px;
 59 |   padding: 20px;
 60 |   border-radius: 8px;
 61 |   background: var(--bg-secondary);
 62 | }
 63 | 
 64 | .option-row {
 65 |   display: flex;
 66 |   align-items: center;
 67 |   justify-content: space-between;
 68 |   gap: 16px;
 69 | }
 70 | 
 71 | .option-row:last-child {
 72 |   margin-bottom: 0;
 73 | }
 74 | 
 75 | .option-content {
 76 |   flex: 1;
 77 |   min-width: 0;
 78 | }
 79 | 
 80 | .option-label {
 81 |   font-weight: 500;
 82 |   margin-bottom: 4px;
 83 | }
 84 | 
 85 | .option-control {
 86 |   flex-shrink: 0;
 87 |   width: auto;
 88 | }
 89 | 
 90 | .description {
 91 |   font-size: 13px;
 92 |   color: var(--text-secondary);
 93 |   margin-top: 4px;
 94 |   line-height: 1.4;
 95 | }
 96 | 
 97 | /* Toggle Switch */
 98 | .switch {
 99 |   position: relative;
100 |   display: inline-block;
101 |   width: 46px;
102 |   height: 24px;
103 |   flex-shrink: 0;
104 | }
105 | 
106 | .switch input {
107 |   opacity: 0;
108 |   width: 0;
109 |   height: 0;
110 | }
111 | 
112 | .slider {
113 |   position: absolute;
114 |   cursor: pointer;
115 |   top: 0;
116 |   left: 0;
117 |   right: 0;
118 |   bottom: 0;
119 |   background-color: var(--border-color);
120 |   transition: 0.4s;
121 |   border-radius: 24px;
122 | }
123 | 
124 | .slider:before {
125 |   position: absolute;
126 |   content: '';
127 |   height: 16px;
128 |   width: 16px;
129 |   left: 4px;
130 |   bottom: 4px;
131 |   background-color: white;
132 |   transition: 0.4s;
133 |   border-radius: 50%;
134 | }
135 | 
136 | input:checked + .slider {
137 |   background-color: var(--accent-color);
138 | }
139 | 
140 | input:checked + .slider:before {
141 |   transform: translateX(26px);
142 | }
143 | 
144 | select {
145 |   padding: 8px 12px;
146 |   border-radius: 4px;
147 |   border: 1px solid var(--border-color);
148 |   font-size: 14px;
149 |   background-color: var(--bg-secondary);
150 |   color: var(--text-primary);
151 |   width: 140px;
152 | }
153 | 
154 | .footer {
155 |   margin-top: 24px;
156 |   padding-top: 16px;
157 |   border-top: 1px solid var(--border-color);
158 |   font-size: 12px;
159 |   color: var(--text-secondary);
160 | }
161 | 
162 | .footer a {
163 |   color: var(--text-primary);
164 |   text-decoration: none;
165 |   transition: color 0.2s ease;
166 | }
167 | 
168 | .footer a.domain {
169 |   text-decoration: underline;
170 |   text-underline-offset: 2px;
171 | }
172 | 
173 | .footer a:hover {
174 |   color: #fff;
175 | }
176 | 
177 | .feedback {
178 |   position: fixed;
179 |   bottom: 20px;
180 |   right: 20px;
181 |   background: var(--accent-color);
182 |   color: white;
183 |   padding: 8px 16px;
184 |   border-radius: 4px;
185 |   font-size: 14px;
186 |   box-shadow: 0 2px 4px rgba(0,0,0,0.2);
187 |   opacity: 1;
188 |   transition: opacity 0.2s;
189 | }
190 | 
191 | .feedback.error {
192 |   background: #dc3545;
193 | }
194 | 


--------------------------------------------------------------------------------
/src/types/global.d.ts:
--------------------------------------------------------------------------------
1 | declare global {
2 |   interface Window {
3 |     refreshInterval?: ReturnType<typeof setInterval>;
4 |   }
5 | }
6 | 
7 | export {};
8 | 


--------------------------------------------------------------------------------
/src/types/index.ts:
--------------------------------------------------------------------------------
 1 | export interface ListItem {
 2 |   id: string;
 3 |   value: string;
 4 |   listId: string;
 5 |   encryptedValue?: string;
 6 |   updatedDateTime: string;
 7 |   createdDateTime: string;
 8 |   categoryValue?: string;
 9 |   customerId: string;
10 |   version: number;
11 |   completed: boolean;
12 |   itemType: string;
13 |   listItemMetadata: any[];
14 |   mergedListId?: string;
15 | }
16 | 
17 | export interface ListData {
18 |   listItems: ListItem[];
19 | }
20 | 
21 | export interface ApiResponse {
22 |   items?: ListItem[];
23 |   [key: string]: ListData | ListItem[] | undefined;
24 | }
25 | 
26 | export interface FeedbackProps {
27 |   message: string;
28 |   duration?: number;
29 | }
30 | 


--------------------------------------------------------------------------------
/src/utils/feedback.ts:
--------------------------------------------------------------------------------
 1 | // Utility function for showing feedback messages
 2 | export const showFeedback = (
 3 |   message: string,
 4 |   duration = 1500,
 5 |   source?: Event | Element,
 6 | ): void => {
 7 |   const feedback = document.createElement("div");
 8 |   feedback.className = "feedback";
 9 |   feedback.textContent = message;
10 |   const container = document.querySelector(".feedback-container");
11 |   if (container) {
12 |     container.appendChild(feedback);
13 |   } else {
14 |     document.body.appendChild(feedback);
15 |   }
16 | 
17 |   // Position feedback based on source (if provided)
18 |   if (source) {
19 |     if (source instanceof MouseEvent) {
20 |       const offset = 15;
21 |       const padding = 10;
22 |       const left = Math.min(
23 |         Math.max(source.clientX, padding),
24 |         window.innerWidth - padding,
25 |       );
26 |       const top = Math.min(
27 |         Math.max(source.clientY - offset, padding),
28 |         window.innerHeight - padding,
29 |       );
30 |       feedback.style.left = `${left}px`;
31 |       feedback.style.top = `${top}px`;
32 |     } else if (source instanceof Element) {
33 |       const rect = source.getBoundingClientRect();
34 |       feedback.style.left = `${rect.left + rect.width / 2}px`;
35 |       feedback.style.top = `${rect.top - 15}px`;
36 |     }
37 |   } else {
38 |     feedback.style.left = "50%";
39 |     feedback.style.top = "40%";
40 |   }
41 | 
42 |   requestAnimationFrame(() => {
43 |     feedback.classList.add("show");
44 |   });
45 | 
46 |   setTimeout(() => {
47 |     feedback.classList.remove("show");
48 |     setTimeout(() => feedback.remove(), 150);
49 |   }, duration);
50 | };
51 | 


--------------------------------------------------------------------------------
/src/utils/index.ts:
--------------------------------------------------------------------------------
 1 | import { ListItem, ApiResponse } from "../types";
 2 | 
 3 | // API endpoints
 4 | export const API_ENDPOINTS = {
 5 |   GET_ITEMS: "https://www.amazon.com/alexashoppinglists/api/getlistitems",
 6 |   UPDATE_ITEM: "https://www.amazon.com/alexashoppinglists/api/updatelistitem",
 7 |   DELETE_ITEM: "https://www.amazon.com/alexashoppinglists/api/deletelistitem",
 8 |   ADD_ITEM:
 9 |     "https://www.amazon.com/alexashoppinglists/api/addlistitem/YW16bjEuYWNjb3VudC5BSERXNEkyVE00U1I0UVQ2VUpINzNWUVpaQU5BLVNIT1BQSU5HX0lURU0=",
10 | };
11 | 
12 | export const LOGIN_URL = "https://www.amazon.com/gp/alexa-shopping-list";
13 | 
14 | export const extractItems = (data: ApiResponse) => {
15 |   const incompleteItems: ListItem[] = [];
16 |   const completedItems: ListItem[] = [];
17 | 
18 |   // Handle test data format
19 |   if (Array.isArray(data.items)) {
20 |     data.items.forEach((item) => {
21 |       if (item.value) {
22 |         if (!item.completed) {
23 |           incompleteItems.push(item);
24 |         } else {
25 |           completedItems.push(item);
26 |         }
27 |       }
28 |     });
29 |     return { incompleteItems, completedItems };
30 |   }
31 | 
32 |   // Handle production data format
33 |   for (const key in data) {
34 |     const value = data[key];
35 |     if (value && "listItems" in value && Array.isArray(value.listItems)) {
36 |       value.listItems.forEach((item: ListItem) => {
37 |         if (item.value) {
38 |           if (!item.completed) {
39 |             incompleteItems.push(item);
40 |           } else {
41 |             completedItems.push(item);
42 |           }
43 |         }
44 |       });
45 |     }
46 |   }
47 | 
48 |   return { incompleteItems, completedItems };
49 | };
50 | 
51 | export const simulateButtonClick = (button: HTMLElement) => {
52 |   button.classList.add("clicked");
53 |   setTimeout(() => {
54 |     button.classList.remove("clicked");
55 |   }, 150);
56 | };
57 | 
58 | export const debounce = <T extends (...args: any[]) => any>(
59 |   fn: T,
60 |   delay: number,
61 | ): ((...args: Parameters<T>) => void) => {
62 |   let timeoutId: NodeJS.Timeout;
63 |   return (...args: Parameters<T>) => {
64 |     clearTimeout(timeoutId);
65 |     timeoutId = setTimeout(() => fn(...args), delay);
66 |   };
67 | };
68 | 
69 | export const sanitizeContent = (content: string): string => {
70 |   // Remove any potentially harmful HTML/script content
71 |   return content
72 |     .replace(/<[^>]*>/g, "")
73 |     .replace(/javascript:/gi, "")
74 |     .replace(/on\w+=/gi, "")
75 |     .trim();
76 | };
77 | 


--------------------------------------------------------------------------------
/src/utils/sanitizer.ts:
--------------------------------------------------------------------------------
 1 | // src/utils/sanitizer.ts
 2 | 
 3 | /**
 4 |  * Sanitizes an input string by escaping HTML.
 5 |  * @param input - The raw string that may contain HTML.
 6 |  * @returns A safe HTML string.
 7 |  */
 8 | export function sanitize(input: string): string {
 9 |   const element = document.createElement("div");
10 |   element.innerText = input;
11 |   return element.innerHTML;
12 | }
13 | 


--------------------------------------------------------------------------------
/tailwind.config.ts:
--------------------------------------------------------------------------------
 1 | import type { Config } from 'tailwindcss';
 2 | 
 3 | export default {
 4 |   content: [
 5 |     "./src/**/*.{js,jsx,ts,tsx}",
 6 |     "./src/**/*.html"
 7 |   ],
 8 |   darkMode: 'class',
 9 |   theme: {
10 |     extend: {
11 |       colors: {
12 |         dark: {
13 |           'bg-primary': '#1a1a1a',
14 |           'bg-secondary': '#2a2a2a',
15 |           'bg-hover': '#333333',
16 |           'border': '#404040',
17 |           'text-primary': '#e0e0e0',
18 |           'text-secondary': '#a0a0a0',
19 |         }
20 |       },
21 |       fontFamily: {
22 |         'inter': ['Inter', 'sans-serif'],
23 |       },
24 |     },
25 |   },
26 |   plugins: [],
27 | } satisfies Config;
28 | 


--------------------------------------------------------------------------------
/tsconfig.build.json:
--------------------------------------------------------------------------------
 1 | {
 2 |   "extends": "./tsconfig.json",
 3 |   "compilerOptions": {
 4 |     "noEmit": false,
 5 |     "outDir": "./dist",
 6 |     "rootDir": ".",
 7 |     "baseUrl": ".",
 8 |     "paths": {
 9 |       "@/*": ["src/*"]
10 |     },
11 |     "jsx": "react-jsx",
12 |     "module": "ESNext",
13 |     "moduleResolution": "node",
14 |     "esModuleInterop": true,
15 |     "allowSyntheticDefaultImports": true,
16 |     "sourceMap": true,
17 |     "declaration": true
18 |   },
19 |   "include": [
20 |     "webpack/**/*",
21 |     "src/**/*"
22 |   ],
23 |   "exclude": [
24 |     "node_modules",
25 |     "dist",
26 |     "**/*.test.ts",
27 |     "**/*.spec.ts"
28 |   ]
29 | }
30 | 


--------------------------------------------------------------------------------
/tsconfig.json:
--------------------------------------------------------------------------------
 1 | {
 2 |   "compilerOptions": {
 3 |     "target": "ES2018",
 4 |     "module": "ESNext",
 5 |     "lib": ["dom", "dom.iterable", "esnext"],
 6 |     "allowJs": true,
 7 |     "skipLibCheck": true,
 8 |     "esModuleInterop": true,
 9 |     "allowSyntheticDefaultImports": true,
10 |     "strict": true,
11 |     "forceConsistentCasingInFileNames": true,
12 |     "noFallthroughCasesInSwitch": true,
13 |     "moduleResolution": "node",
14 |     "resolveJsonModule": true,
15 |     "isolatedModules": true,
16 |     "jsx": "react-jsx",
17 |     "outDir": "./dist",
18 |     "baseUrl": ".",
19 |     "paths": {
20 |       "@/*": ["src/*"]
21 |     },
22 |     "rootDir": ".",
23 |     "sourceMap": true,
24 |     "declaration": true,
25 |     "noEmit": false,
26 |     "emitDeclarationOnly": true,
27 |     "allowImportingTsExtensions": true,
28 |     "noEmitOnError": true,
29 |     "types": ["node", "jest", "chrome"]
30 |   },
31 |   "include": [
32 |     "src/**/*",
33 |     "webpack/**/*",
34 |     "scripts/**/*",
35 |     "build.ts",
36 |     "jest.setup.ts",
37 |     "__mocks__/**/*"
38 |   ],
39 |   "exclude": [
40 |     "node_modules",
41 |     "dist",
42 |     "**/*.test.ts",
43 |     "**/*.spec.ts"
44 |   ]
45 | }
46 | 


--------------------------------------------------------------------------------
/tsconfig.test.json:
--------------------------------------------------------------------------------
 1 | {
 2 |   "extends": "./tsconfig.json",
 3 |   "compilerOptions": {
 4 |     "module": "commonjs",
 5 |     "outDir": "./dist/test",
 6 |     "noEmit": false,
 7 |     "allowImportingTsExtensions": false,
 8 |     "types": ["node", "jest", "chrome", "@testing-library/jest-dom"]
 9 |   },
10 |   "include": [
11 |     "src/**/*",
12 |     "jest.setup.ts",
13 |     "__mocks__/**/*"
14 |   ],
15 |   "exclude": [
16 |     "node_modules",
17 |     "dist"
18 |   ]
19 | }
20 | 


--------------------------------------------------------------------------------
/webpack/webpack.common.ts:
--------------------------------------------------------------------------------
  1 | import type { Configuration } from 'webpack';
  2 | import path from 'path';
  3 | import { fileURLToPath } from 'url';
  4 | import CopyPlugin from 'copy-webpack-plugin';
  5 | import HtmlWebpackPlugin from 'html-webpack-plugin';
  6 | import MiniCssExtractPlugin from 'mini-css-extract-plugin';
  7 | 
  8 | 
  9 | 
 10 | const __filename = fileURLToPath(import.meta.url);
 11 | const __dirname = path.dirname(__filename);
 12 | 
 13 | const srcDir = path.join(__dirname, '..', 'src');
 14 | const distDir = path.join(__dirname, '..', 'dist');
 15 | 
 16 | const config: Configuration = {
 17 |   entry: {
 18 |     popup: path.join(srcDir, 'popup.tsx'),
 19 |     options: path.join(srcDir, 'options.tsx')
 20 |   },
 21 |   output: {
 22 |     path: distDir,
 23 |     filename: 'js/[name].js',
 24 |     clean: true,
 25 |     assetModuleFilename: 'assets/[name][ext]'
 26 |   },
 27 |   module: {
 28 |     rules: [
 29 |       {
 30 |         test: /\.tsx?$/,
 31 |         use: {
 32 |           loader: 'ts-loader',
 33 |           options: {
 34 |             configFile: 'tsconfig.build.json',
 35 |             transpileOnly: true
 36 |           }
 37 |         },
 38 |         exclude: /node_modules/
 39 |       },
 40 |       {
 41 |         test: /\.css$/,
 42 |         use: [
 43 |           {
 44 |             loader: MiniCssExtractPlugin.loader,
 45 |             options: {
 46 |               publicPath: '../'
 47 |             }
 48 |           },
 49 |           'css-loader'
 50 |         ]
 51 |       }
 52 |     ]
 53 |   },
 54 |   resolve: {
 55 |     extensions: ['.ts', '.tsx', '.js', '.jsx'],
 56 |     alias: {
 57 |       '@': srcDir
 58 |     }
 59 |   },
 60 |   plugins: [
 61 |     new HtmlWebpackPlugin({
 62 |       template: path.join(srcDir, 'popup.html'),
 63 |       filename: 'html/popup.html',
 64 |       chunks: ['popup'],
 65 |       inject: 'body',
 66 |       publicPath: '../',
 67 |       minify: {
 68 |         removeComments: true,
 69 |         collapseWhitespace: true,
 70 |         removeRedundantAttributes: true,
 71 |         removeScriptTypeAttributes: true,
 72 |         removeStyleLinkTypeAttributes: true,
 73 |         removeAttributeQuotes: true
 74 |       }
 75 |     }),
 76 |     new HtmlWebpackPlugin({
 77 |       template: path.join(srcDir, 'options.html'),
 78 |       filename: 'html/options.html',
 79 |       chunks: ['options'],
 80 |       inject: 'body',
 81 |       publicPath: '../',
 82 |       minify: {
 83 |         removeComments: true,
 84 |         collapseWhitespace: true,
 85 |         removeRedundantAttributes: true,
 86 |         removeScriptTypeAttributes: true,
 87 |         removeStyleLinkTypeAttributes: true,
 88 |         removeAttributeQuotes: true
 89 |       }
 90 |     }),
 91 | 
 92 | 
 93 |     new MiniCssExtractPlugin({
 94 |       filename: 'styles/[name].css',
 95 |       chunkFilename: 'styles/[id].css'
 96 |     }),
 97 | 
 98 |     new CopyPlugin({
 99 |       patterns: [
100 |         { 
101 |           from: path.join(srcDir, 'manifest.json'),
102 |           to: path.join(distDir, 'manifest.json'),
103 |           transform(content) {
104 |             const manifest = JSON.parse(content.toString());
105 |             // Update paths in manifest
106 |             manifest.action.default_popup = 'html/popup.html';
107 |             manifest.options_page = 'html/options.html';
108 |             manifest.action.default_icon = {
109 |               '16': 'assets/icon-16.png',
110 |               '32': 'assets/icon-32.png',
111 |               '48': 'assets/icon-48.png',
112 |               '128': 'assets/icon-128.png'
113 |             };
114 |             manifest.icons = {
115 |               '16': 'assets/icon-16.png',
116 |               '32': 'assets/icon-32.png',
117 |               '48': 'assets/icon-48.png',
118 |               '128': 'assets/icon-128.png'
119 |             };
120 |             return JSON.stringify(manifest, null, 2);
121 |           }
122 |         },
123 |         { 
124 |           from: path.join(srcDir, 'public', 'images'),
125 |           to: path.join(distDir, 'assets')
126 |         }
127 |       ]
128 |     })
129 |   ]
130 | } as Configuration;
131 | 
132 | export default config;
133 | 


--------------------------------------------------------------------------------
/webpack/webpack.dev.ts:
--------------------------------------------------------------------------------
 1 | import { merge } from 'webpack-merge';
 2 | import type { Configuration } from 'webpack';
 3 | import commonConfig from './webpack.common.ts';
 4 | 
 5 | const devConfig: Configuration = {
 6 |   mode: 'development',
 7 |   devtool: 'inline-source-map'
 8 | };
 9 | 
10 | export default merge(commonConfig, devConfig);
11 | 


--------------------------------------------------------------------------------
/webpack/webpack.prod.ts:
--------------------------------------------------------------------------------
 1 | import { merge } from 'webpack-merge';
 2 | import type { Configuration } from 'webpack';
 3 | import commonConfig from './webpack.common.ts';
 4 | 
 5 | const prodConfig: Configuration = {
 6 |   mode: 'production',
 7 |   devtool: 'source-map'
 8 | };
 9 | 
10 | export default merge(commonConfig, prodConfig);
11 | 


--------------------------------------------------------------------------------
